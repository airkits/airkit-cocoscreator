window.airkit={},function(t){class e{constructor(){let i=this.constructor;if(i){if(-1!=e.classKeys.indexOf(i))throw new Error(this+" 只允许实例化一次！");e.classKeys.push(i),e.classValues.push(this)}else t.Log.warning("浏览器不支持读取构造函数")}}e.classKeys=[],e.classValues=[],t.Singleton=e}(airkit||(airkit={})),function(t){class e extends t.Singleton{constructor(){super(),this._isStopGame=!1,this._mainloopHandle=null,t.Timer.Start()}static get Instance(){return this.instance||(this.instance=new e),this.instance}setup(e,i,s=t.LogLevel.INFO,r=750,n=1334,a="",l=1){this.printDeviceInfo(),this._lastTimeMS=t.DateUtils.getNowMS(),this._isStopGame=!1,this._mainloopHandle=i,cc.view.setResizeCallback(()=>{t.EventCenter.dispatchEvent(t.EventID.RESIZE)}),t.Log.LEVEL=s,cc.director.getScheduler().scheduleUpdate(this,0,!1),t.LayerManager.setup(e),t.TimerManager.Instance.setup(),t.UIManager.Instance.setup(),t.ResourceManager.Instance.setup(),t.DataProvider.Instance.setup(),t.LangManager.Instance.init(),t.SceneManager.Instance.setup(),t.Mediator.Instance.setup(),t.LoaderManager.Instance.setup()}destroy(){t.Mediator.Instance.destroy(),t.LoaderManager.Instance.destroy(),t.TimerManager.Instance.destroy(),t.UIManager.Instance.destroy(),t.SceneManager.Instance.destroy(),t.ResourceManager.Instance.destroy(),t.DataProvider.Instance.destroy(),t.LayerManager.destroy(),t.LangManager.Instance.destory()}update(e){if(!this._isStopGame){let e=t.DateUtils.getNowMS(),i=e-this._lastTimeMS;this._lastTimeMS=e,this.preTick(i),this.tick(i),this.endTick(i)}}preTick(e){t.TimerManager.Instance.update(e),t.UIManager.Instance.update(e),t.ResourceManager.Instance.update(e),t.Mediator.Instance.update(e),t.SceneManager.Instance.update(e)}tick(t){this._mainloopHandle&&this._mainloopHandle.runWith([t])}endTick(t){}pauseGame(){this._isStopGame=!0,t.EventCenter.dispatchEvent(t.EventID.STOP_GAME,!0)}resumeGame(){this._isStopGame=!1,t.EventCenter.dispatchEvent(t.EventID.STOP_GAME,!1)}get isStopGame(){return this._isStopGame}printDeviceInfo(){if(navigator){let e=navigator.userAgent,i=e.indexOf("("),s=e.indexOf(")");if(i<0||s<0||s<i)return;let r,n,a,l=e.substring(i+1,s);t.Log.info(l);let h=l.split(";");if(3==h.length){r=h[2];let t=h[1].split(" ");t.length>=2&&(n=t[1],a=t[2])}else 2==h.length?(n=h[0],r=h[0],a=h[1]):(n=navigator.platform,r=navigator.platform,a=l);t.Log.info("{0},{1},{2}",n,r,a)}}}e.instance=null,t.Framework=e}(airkit||(airkit={})),function(t){class e{constructor(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}set(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}static add(t,i){return new e(t.r+i.r,t.g+i.g,t.b+i.b,t.a+i.a)}add(t){return this.set(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a),this}static sub(t,i){return new e(t.r-i.r,t.g-i.g,t.b-i.b,t.a-i.a)}sub(t){return this.set(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a),this}static mul(t,i){return new e(t.r*i,t.g*i,t.b*i,t.a*i)}mul(t){return this.set(this.r*t,this.g*t,this.b*t,this.a*t),this}static div(t,i){return new e(t.r/i,t.g/i,t.b/i,t.a/i)}div(t){return this.set(this.r/t,this.g/t,this.b/t,this.a/t),this}equals(t){return this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a}static lerp(i,s,r){return r=t.MathUtils.clamp(r,0,1),new e(i.r+(s.r-i.r)*r,i.g+(s.g-i.g)*r,i.b+(s.b-i.b)*r+(s.a-i.a)*r)}static get zero(){return new e(0,0,0,0)}static get one(){return new e(1,1,1,1)}static get red(){return new e(1,0,0,1)}static get green(){return new e(0,1,0,1)}static get blue(){return new e(0,0,1,1)}static get white(){return new e(1,1,1,1)}static get black(){return new e(0,0,0,1)}static get yellow(){return new e(1,.9215686,.01568628,1)}static get cyan(){return new e(0,1,1,1)}static get magenta(){return new e(1,0,1,1)}static get gray(){return new e(.5,.5,.5,1)}static get grey(){return new e(.5,.5,.5,1)}static get clear(){return new e(0,0,0,0)}toString(){return t.StringUtils.format("({0}, {1}, {2}, {3})",this.r,this.g,this.b,this.a)}}t.Color=e}(airkit||(airkit={})),function(t){t.NDictionary=class{constructor(){this._dic={}}add(e,i){return this.containsKey(e)?(t.Log.warning("NDictionary already containsKey ",e.toString()),!1):(this._dic[e]=i,!0)}remove(t){delete this._dic[t]}set(t,e){this._dic[t]=e}containsKey(t){return null!=this._dic[t]}getValue(t){return this.containsKey(t)?this._dic[t]:null}clear(){for(let t in this._dic)delete this._dic[t]}getkeys(){let e=[];for(let i in this._dic)e.push(t.StringUtils.toNumber(i));return e}getValues(){let t=[];for(let e in this._dic)t.push(this._dic[e]);return t}foreach(t){for(let e in this._dic)if(!t.call(null,e,this._dic[e]))break}get length(){return t.DicUtils.getLength(this._dic)}};t.SDictionary=class{constructor(){this._dic={}}add(t,e){return!this.containsKey(t)&&(this._dic[t]=e,!0)}set(t,e){this._dic[t]=e}remove(t){delete this._dic[t]}containsKey(t){return null!=this._dic[t]}getValue(t){return this.containsKey(t)?this._dic[t]:null}getkeys(){let t=[];for(let e in this._dic)t.push(e);return t}getValues(){let t=[];for(let e in this._dic)t.push(this._dic[e]);return t}clear(){for(let t in this._dic)delete this._dic[t]}foreach(t){for(let e in this._dic)if(!t.call(null,e,this._dic[e]))break}get length(){return t.DicUtils.getLength(this._dic)}}}(airkit||(airkit={})),function(t){t.DoubleArray=class{constructor(t,e,i){if(this._array=[],t>0&&e>0)for(let s=0;s<t;++s)for(let t=0;t<e;++t)this.set(s,t,i)}set(t,e,i){this._array[t]||(this._array[t]=[]),this._array[t][e]=i}get(t,e){return this._array[t]?this._array[t][e]:null}clear(){t.ArrayUtils.clear(this._array)}}}(airkit||(airkit={})),function(t){t.LinkList=class{constructor(){this._linkHead=null,this._size=0,this._linkHead={Data:null,Prev:null,Next:null},this._linkHead.Prev=this._linkHead,this._linkHead.Next=this._linkHead,this._size=0}add(t){this.append(this._size,t)}insert(e,i){if((this._size<1||e>=this._size)&&t.Log.exception("没有可插入的点或者索引溢出了"),0==e)this.append(this._size,i);else{let t=this.getNode(e),s={Data:i,Prev:t.Prev,Next:t};t.Prev.Next=s,t.Prev=s,this._size++}}append(e,i){let s;0==e?s=this._linkHead:((e-=1)<0&&t.Log.exception("位置不存在"),s=this.getNode(e));let r={Data:i,Prev:s,Next:s.Next};s.Next.Prev=r,s.Next=r,this._size++}del(t){let e=this.getNode(t);e.Prev.Next=e.Next,e.Next.Prev=e.Prev,this._size--}delFirst(){this.del(0)}delLast(){this.del(this._size-1)}get(t){return this.getNode(t).Data}getFirst(){return this.getNode(0).Data}getLast(){return this.getNode(this._size-1).Data}getNode(e){if((e<0||e>=this._size)&&t.Log.exception("索引溢出或者链表为空"),e<this._size/2){let t=this._linkHead.Next;for(let i=0;i<e;i++)t=t.Next;return t}let i=this._linkHead.Prev,s=this._size-e-1;for(let t=0;t<s;t++)i=i.Prev;return i}foreach(t){let e=this._linkHead.Next;if(e)do{if(!t.call(null,e.Data))break;e=e.Next}while(e!=this._linkHead)}isEmpty(){return 0==this._size}get length(){return this._size}}}(airkit||(airkit={})),function(t){class e{static get(e){let i=e.objectKey;null==i&&t.Log.error("static objectKey must set in {0} ",e.name);let s=this.poolsMap[i];null==s&&(s=new Array,this.poolsMap[i]=s);let r=s.pop();return null==r&&(r=new e),r&&r.init&&r.init(),r}static recover(t){if(!t)return;if(null!=t.parent&&t.removeFromParent(),t.dispose&&null==t.displayObject)return void t.dispose();let e=Object.getPrototypeOf(t).constructor.objectKey,i=this.poolsMap[e];null!=i&&(null!==t.visible&&!1===t.visible&&(t.visible=!0),i.push(t))}static clearAll(){t.DicUtils.foreach(this.poolsMap,(t,e)=>(this.clear(t),!0))}static clear(e){let i=this.poolsMap[e];for(t.Log.info("max object count {0}",i.length);i.length>0;){let t=i.pop();t&&t.dispose&&(null!=t.parent?t.removeFromParent():null!=t.displayObject.parent&&t.displayObject.removeFromParent(),t.dispose())}}}e.poolsMap={},t.ObjectPools=e}(airkit||(airkit={})),function(t){t.Queue=class{constructor(){this._list=[]}enqueue(t){this._list.push(t)}dequeue(){return this._list.shift()}peek(){return 0==this._list.length?null:this._list[0]}seek(t){return this._list.length<t?null:this._list[t]}toArray(){return this._list.slice(0,this._list.length)}contains(t){return-1!=this._list.indexOf(t,0)}clear(){this._list.length=0}get length(){return this._list.length}foreach(t){for(let e of this._list)if(!t.call(null,e))break}}}(airkit||(airkit={})),function(t){t.Size=class{constructor(t=0,e=0){this._width=t,this._height=e}set(t,e){this._width=t,this._height=e}get width(){return this._width}get height(){return this._height}}}(airkit||(airkit={})),function(t){t.Stack=class{constructor(){this._list=[]}push(t){this._list.push(t)}pop(){return this._list.pop()}peek(){return 0==this._list.length?null:this._list[this._list.length-1]}toArray(){return this._list.slice(0,this._list.length)}contains(t){return-1!=this._list.indexOf(t,0)}clear(){this._list.length=0}get length(){return this._list.length}foreach(t){for(let e of this._list)if(!t.call(null,e))break}}}(airkit||(airkit={})),function(t){let e,i,s,r,n,a,l;t.LOADVIEW_TYPE_NONE=0,function(t){t[t.POPUP=1]="POPUP",t[t.ALERT=2]="ALERT"}(e=t.eUIQueueType||(t.eUIQueueType={})),i=t.ePopupAnim||(t.ePopupAnim={}),function(t){t[t.CLOSE_CENTER=1]="CLOSE_CENTER"}(s=t.eCloseAnim||(t.eCloseAnim={})),function(t){t[t.NONE=0]="NONE",t[t.RIGHT=1]="RIGHT",t[t.RIGHT_BOTTOM=2]="RIGHT_BOTTOM",t[t.BOTTOM=3]="BOTTOM",t[t.LEFT_BOTTOM=4]="LEFT_BOTTOM",t[t.LEFT=5]="LEFT",t[t.LEFT_TOP=6]="LEFT_TOP",t[t.TOP=7]="TOP",t[t.RIGHT_TOP=8]="RIGHT_TOP",t[t.MID=9]="MID"}(r=t.eAligeType||(t.eAligeType={})),function(t){t[t.BG=0]="BG",t[t.MAIN=1]="MAIN",t[t.GUI=2]="GUI",t[t.POPUP=3]="POPUP",t[t.TOOLTIP=4]="TOOLTIP",t[t.SYSTEM=5]="SYSTEM",t[t.LOADING=6]="LOADING",t[t.TOP=7]="TOP",t[t.MAX=8]="MAX"}(n=t.eUILayer||(t.eUILayer={})),function(t){t[t.DEBUG=7]="DEBUG",t[t.INFO=6]="INFO",t[t.WARNING=5]="WARNING",t[t.ERROR=4]="ERROR",t[t.EXCEPTION=3]="EXCEPTION"}(a=t.LogLevel||(t.LogLevel={})),function(t){t[t.Close=0]="Close",t[t.Cancel=1]="Cancel",t[t.Ok=2]="Ok"}(l=t.ePopupButton||(t.ePopupButton={}))}(airkit||(airkit={})),function(t){t.ConfigItem=class{constructor(t,e,i){this.url=t,this.name=e,this.key=i}}}(airkit||(airkit={})),function(t){class e extends t.Singleton{static get Instance(){return this.instance||(this.instance=new e),this.instance}init(i,s=null){null!=s&&(e.zipUrl=s),this._listTables=[];let r=i;for(let e in r)this._listTables.push(new t.ConfigItem(e,e,r[e]))}release(){if(this._listTables){for(let e of this._listTables)t.DataProvider.Instance.unload(e.url);t.ArrayUtils.clear(this._listTables),this._listTables=null}}loadAll(){if(this._listTables.length>0)return t.DataProvider.Instance.enableZip(),t.DataProvider.Instance.loadZip(e.zipUrl,this._listTables)}getList(e,i){let s=t.DataProvider.Instance.getConfig(e);if(null==s)return[];null==i&&(i=[]);let r=[];for(let t in s){let e=s[t],n=!0;for(let t=0;t<i.length;t++){let s=i[t].k,r=i[t].v;if(e[s]!=r){n=!1;break}}n&&r.push(e)}return r}getInfo(e,i){return t.DataProvider.Instance.getInfo(e,i)}get listTables(){return this._listTables}}e.instance=null,e.zipUrl="res/config.zip",t.ConfigManger=e}(airkit||(airkit={})),function(t){class e extends t.Singleton{constructor(){super(...arguments),this._dicTemplate=null,this._dicData=null}static get Instance(){return this.instance||(this.instance=new e),this.instance}enableZip(){this._zip=!0}setup(){this._dicTemplate=new t.SDictionary,this._dicData=new t.SDictionary,this._zip=!1}destroy(){this.unloadAll(),this._dicTemplate&&(this._dicTemplate.clear(),this._dicTemplate=null),this._dicData&&(this._dicData.clear(),this._dicData=null)}loadZip(e,i){return new Promise((s,r)=>{t.ResourceManager.Instance.loadRes(e,cc.BufferAsset).then(n=>{let a=t.ResourceManager.Instance.getRes(e);t.ZipUtils.unzip(a).then(e=>{for(let s=0;s<i.length;s++){let r=i[s];this._dicTemplate.add(i[s].url,r),t.Log.info("Load config {0}",r.url);let n=JSON.parse(e[r.url]);if(t.StringUtils.isNullOrEmpty(r.key))this._dicData.add(r.name,n);else{let e,i,s={},a=0,l=Array.isArray(r.key);for(;n[a];){if(i=n[a],l){e=i[r.key[0]];for(let t=1;t<r.key.length;t++)e+="_"+i[r.key[t]]}else e=i[r.key];t.assertNullOrNil(e,"配置表解析错误:"+r.url),s[e]=i,a++}this._dicData.add(r.name,s)}}s(e)}).catch(e=>{t.Log.error(e),r(e)})})})}load(e){return new Promise((i,s)=>{let r=[];for(let i=0;i<e.length;i++)t.ResourceManager.Instance.getRes(e[i].url)||(r.push({url:e[i].url,type:cc.JsonAsset}),this._dicTemplate.add(e[i].url,e[i]));0!=r.length?t.ResourceManager.Instance.loadArrayRes(r,null,null,null,null,t.ResourceManager.SystemGroup).then(t=>{for(let e=0;e<t.length;e++)this.onLoadComplete(t[e]),i(t)}).catch(t=>{s(t)}):i([])})}unload(e){let i=this._dicTemplate.getValue(e);i&&this._dicData.remove(i.name),this._zip||t.ResourceManager.Instance.clearRes(e),this._dicTemplate.remove(e)}unloadAll(){this._dicTemplate&&(this._dicTemplate.foreach(function(t,e){return this.Unload(t),!0}),this._dicData.clear(),this._dicTemplate.clear())}getConfig(t){return this._dicData.getValue(t)}getInfo(t,e){let i=this._dicData.getValue(t);if(i){let t;if(Array.isArray(e)){t=e[0];for(let i=1;i<e.length;i++)t+="_"+e[i]}else t=e;return i[t]}return null}getRes(e){t.Log.debug("[load]加载配置表:"+e);let i=this._dicTemplate.getValue(e);if(i){let s=t.ResourceManager.Instance.getRes(e);if(t.StringUtils.isNullOrEmpty(i.key))this._dicData.add(i.name,s);else{let e,r,n={},a=0,l=Array.isArray(i.key);for(;s[a];){if(r=s[a],l){e=r[i.key[0]];for(let t=1;t<i.key.length;t++)e+="_"+r[i.key[t]]}else e=r[i.key];t.assertNullOrNil(e,"配置表解析错误:"+i.url),n[e]=r,a++}this._dicData.add(i.name,n)}}}onLoadComplete(t){this.getRes(t)}}e.instance=null,t.DataProvider=e}(airkit||(airkit={})),function(t){function e(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),s=0;s<t.length;++s)i[s]=t.charCodeAt(s);return e}t.base64_encode=function(t){let s=new i,r=e(t);return s.encode(r)},t.stringToArrayBuffer=e;class i{constructor(){this.alphabet=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],this.values={};for(let t=0;t<64;++t)this.values[this.alphabet[t]]=t}encode(t){const e=new Uint8Array(t),i=[];let s,r,n=0;for(;n+2<e.byteLength;)r=(s=e[n]<<16|e[n+1]<<8|e[n+2])>>18&63,i.push(this.alphabet[r]),r=s>>12&63,i.push(this.alphabet[r]),r=s>>6&63,i.push(this.alphabet[r]),r=63&s,i.push(this.alphabet[r]),n+=3;return n+1===e.byteLength?(r=(s=e[n]<<4)>>6&63,i.push(this.alphabet[r]),r=63&s,i.push(this.alphabet[r]),i.push("==")):n+2===e.byteLength&&(r=(s=e[n]<<10|e[n+1]<<2)>>12&63,i.push(this.alphabet[r]),r=s>>6&63,i.push(this.alphabet[r]),r=63&s,i.push(this.alphabet[r]),i.push("=")),i.join("")}decode(t){let e=t.length;if(0===e)return new Uint8Array(new ArrayBuffer(0));if(e%4!=0)throw new Error("Bad length: "+e);if(!t.match(/^[a-zA-Z0-9+\/]+={0,2}$/))throw new Error("Invalid base64 encoded value");let i=e/4*3,s=0;"="===t.charAt(e-1)&&(s++,i--),"="===t.charAt(e-2)&&(s++,i--);const r=new Uint8Array(new ArrayBuffer(i));let n,a=0,l=0;for(s>0&&(e-=4);a<e;){n=0;for(let e=0;e<4;++e)n=n<<6|this.values[t.charAt(a+e)];r[l++]=n>>16&255,r[l++]=n>>8&255,r[l++]=255&n,a+=4}if(s>0){n=0;for(let e=0;e<4-s;++e)n=n<<6|this.values[t.charAt(a+e)];1===s?(n>>=2,r[l++]=n>>8&255,r[l++]=255&n):(n>>=4,r[l++]=255&n)}return r}}t.Base64=i}(airkit||(airkit={})),function(t){t.md5_encrypt=function(t){return(new e).hex_md5(t)};class e{constructor(){this.hexcase=0,this.b64pad=""}hex_md5(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))}b64_md5(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))}any_md5(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)}hex_hmac_md5(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))}b64_hmac_md5(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))}any_hmac_md5(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)}md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()}rstr_md5(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))}rstr_hmac_md5(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var s=Array(16),r=Array(16),n=0;n<16;n++)s[n]=909522486^i[n],r[n]=1549556828^i[n];var a=this.binl_md5(s.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(r.concat(a),640))}rstr2hex(t){try{this.hexcase}catch(t){this.hexcase=0}for(var e,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",s="",r=0;r<t.length;r++)e=t.charCodeAt(r),s+=i.charAt(e>>>4&15)+i.charAt(15&e);return s}rstr2b64(t){try{this.b64pad}catch(t){this.b64pad=""}for(var e="",i=t.length,s=0;s<i;s+=3)for(var r=t.charCodeAt(s)<<16|(s+1<i?t.charCodeAt(s+1)<<8:0)|(s+2<i?t.charCodeAt(s+2):0),n=0;n<4;n++)8*s+6*n>8*t.length?e+=this.b64pad:e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>6*(3-n)&63);return e}rstr2any(t,e){var i,s,r,n,a,l=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var o=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(o);for(s=0;s<o;s++){for(a=Array(),n=0,i=0;i<h.length;i++)n=(n<<16)+h[i],n-=(r=Math.floor(n/l))*l,(a.length>0||r>0)&&(a[a.length]=r);c[s]=n,h=a}var u="";for(i=c.length-1;i>=0;i--)u+=e.charAt(c[i]);return u}str2rstr_utf8(t){for(var e,i,s="",r=-1;++r<t.length;)e=t.charCodeAt(r),i=r+1<t.length?t.charCodeAt(r+1):0,55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e=65536+((1023&e)<<10)+(1023&i),r++),e<=127?s+=String.fromCharCode(e):e<=2047?s+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?s+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(s+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return s}str2rstr_utf16le(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e}str2rstr_utf16be(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e}rstr2binl(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e}binl2rstr(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e}binl_md5(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i=1732584193,s=-271733879,r=-1732584194,n=271733878,a=0;a<t.length;a+=16){var l=i,h=s,o=r,c=n;i=this.md5_ff(i,s,r,n,t[a+0],7,-680876936),n=this.md5_ff(n,i,s,r,t[a+1],12,-389564586),r=this.md5_ff(r,n,i,s,t[a+2],17,606105819),s=this.md5_ff(s,r,n,i,t[a+3],22,-1044525330),i=this.md5_ff(i,s,r,n,t[a+4],7,-176418897),n=this.md5_ff(n,i,s,r,t[a+5],12,1200080426),r=this.md5_ff(r,n,i,s,t[a+6],17,-1473231341),s=this.md5_ff(s,r,n,i,t[a+7],22,-45705983),i=this.md5_ff(i,s,r,n,t[a+8],7,1770035416),n=this.md5_ff(n,i,s,r,t[a+9],12,-1958414417),r=this.md5_ff(r,n,i,s,t[a+10],17,-42063),s=this.md5_ff(s,r,n,i,t[a+11],22,-1990404162),i=this.md5_ff(i,s,r,n,t[a+12],7,1804603682),n=this.md5_ff(n,i,s,r,t[a+13],12,-40341101),r=this.md5_ff(r,n,i,s,t[a+14],17,-1502002290),s=this.md5_ff(s,r,n,i,t[a+15],22,1236535329),i=this.md5_gg(i,s,r,n,t[a+1],5,-165796510),n=this.md5_gg(n,i,s,r,t[a+6],9,-1069501632),r=this.md5_gg(r,n,i,s,t[a+11],14,643717713),s=this.md5_gg(s,r,n,i,t[a+0],20,-373897302),i=this.md5_gg(i,s,r,n,t[a+5],5,-701558691),n=this.md5_gg(n,i,s,r,t[a+10],9,38016083),r=this.md5_gg(r,n,i,s,t[a+15],14,-660478335),s=this.md5_gg(s,r,n,i,t[a+4],20,-405537848),i=this.md5_gg(i,s,r,n,t[a+9],5,568446438),n=this.md5_gg(n,i,s,r,t[a+14],9,-1019803690),r=this.md5_gg(r,n,i,s,t[a+3],14,-187363961),s=this.md5_gg(s,r,n,i,t[a+8],20,1163531501),i=this.md5_gg(i,s,r,n,t[a+13],5,-1444681467),n=this.md5_gg(n,i,s,r,t[a+2],9,-51403784),r=this.md5_gg(r,n,i,s,t[a+7],14,1735328473),s=this.md5_gg(s,r,n,i,t[a+12],20,-1926607734),i=this.md5_hh(i,s,r,n,t[a+5],4,-378558),n=this.md5_hh(n,i,s,r,t[a+8],11,-2022574463),r=this.md5_hh(r,n,i,s,t[a+11],16,1839030562),s=this.md5_hh(s,r,n,i,t[a+14],23,-35309556),i=this.md5_hh(i,s,r,n,t[a+1],4,-1530992060),n=this.md5_hh(n,i,s,r,t[a+4],11,1272893353),r=this.md5_hh(r,n,i,s,t[a+7],16,-155497632),s=this.md5_hh(s,r,n,i,t[a+10],23,-1094730640),i=this.md5_hh(i,s,r,n,t[a+13],4,681279174),n=this.md5_hh(n,i,s,r,t[a+0],11,-358537222),r=this.md5_hh(r,n,i,s,t[a+3],16,-722521979),s=this.md5_hh(s,r,n,i,t[a+6],23,76029189),i=this.md5_hh(i,s,r,n,t[a+9],4,-640364487),n=this.md5_hh(n,i,s,r,t[a+12],11,-421815835),r=this.md5_hh(r,n,i,s,t[a+15],16,530742520),s=this.md5_hh(s,r,n,i,t[a+2],23,-995338651),i=this.md5_ii(i,s,r,n,t[a+0],6,-198630844),n=this.md5_ii(n,i,s,r,t[a+7],10,1126891415),r=this.md5_ii(r,n,i,s,t[a+14],15,-1416354905),s=this.md5_ii(s,r,n,i,t[a+5],21,-57434055),i=this.md5_ii(i,s,r,n,t[a+12],6,1700485571),n=this.md5_ii(n,i,s,r,t[a+3],10,-1894986606),r=this.md5_ii(r,n,i,s,t[a+10],15,-1051523),s=this.md5_ii(s,r,n,i,t[a+1],21,-2054922799),i=this.md5_ii(i,s,r,n,t[a+8],6,1873313359),n=this.md5_ii(n,i,s,r,t[a+15],10,-30611744),r=this.md5_ii(r,n,i,s,t[a+6],15,-1560198380),s=this.md5_ii(s,r,n,i,t[a+13],21,1309151649),i=this.md5_ii(i,s,r,n,t[a+4],6,-145523070),n=this.md5_ii(n,i,s,r,t[a+11],10,-1120210379),r=this.md5_ii(r,n,i,s,t[a+2],15,718787259),s=this.md5_ii(s,r,n,i,t[a+9],21,-343485551),i=this.safe_add(i,l),s=this.safe_add(s,h),r=this.safe_add(r,o),n=this.safe_add(n,c)}return[i,s,r,n]}md5_cmn(t,e,i,s,r,n){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(s,n)),r),i)}md5_ff(t,e,i,s,r,n,a){return this.md5_cmn(e&i|~e&s,t,e,r,n,a)}md5_gg(t,e,i,s,r,n,a){return this.md5_cmn(e&s|i&~s,t,e,r,n,a)}md5_hh(t,e,i,s,r,n,a){return this.md5_cmn(e^i^s,t,e,r,n,a)}md5_ii(t,e,i,s,r,n,a){return this.md5_cmn(i^(e|~s),t,e,r,n,a)}safe_add(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}bit_rol(t,e){return t<<e|t>>>32-e}}t.MD5=e}(airkit||(airkit={})),function(t){t.EventArgs=class{constructor(...e){this._type="",this._data=null,e&&0!=e.length&&(e instanceof Array?this._data=t.ArrayUtils.copy(e[0]):this._data=t.ArrayUtils.copy(e))}init(...e){0!=e.length&&(e instanceof Array?this._data=t.ArrayUtils.copy(e[0]):this._data=t.ArrayUtils.copy(e))}get(t){return this._data&&0!=this._data.length?t<0||t>=this._data.length?null:this._data[t]:null}get type(){return this._type}set type(t){this._type=t}}}(airkit||(airkit={})),function(t){class e extends t.Singleton{constructor(){super(),this._event=null,this._evtArgs=null,this._event=new t.EventDispatcher,this._evtArgs=new t.EventArgs}static get Instance(){return this.instance||(this.instance=new e),this.instance}static on(t,i,s){e.Instance._event.on(t,i,s)}static off(t,i,s){e.Instance._event.off(t,i,s)}static dispatchEvent(t,...i){e.Instance._evtArgs.init(i),e.Instance._event.dispatchEvent(t,e.Instance._evtArgs)}static clear(){e.Instance._event.clear()}}e.instance=null,t.EventCenter=e}(airkit||(airkit={})),function(t){t.EventDispatcher=class{constructor(){this._dicFuns={},this._evtArgs=null,this._evtArgs=new t.EventArgs}on(e,i,s){if(this._dicFuns[e]){let r=this._dicFuns[e];for(let t of r)if(t.caller==i&&t.method==s)return;r.push(t.Handler.create(i,s,null,!1))}else this._dicFuns[e]=[],this._dicFuns[e].push(t.Handler.create(i,s,null,!1))}off(t,e,i){let s=this._dicFuns[t];if(s)for(let t=0;t<s.length;++t){let r=s[t];if(r.caller==e&&r.method==i){r.recover(),s.splice(t,1);break}}}dispatchEvent(t,e){e.type=t;let i=this._dicFuns[t];if(i)for(let t of i)t.runWith(e)}dispatch(t,...e){this._evtArgs.init(e),this.dispatchEvent(t,this._evtArgs)}clear(){t.DicUtils.clearDic(this._dicFuns)}}}(airkit||(airkit={})),function(t){class e{}e.PROGRESS="progress",e.COMPLETE="complete",e.ERROR="error",t.Event=e;class i{}i.BEGIN_GAME="BEGIN_GAME",i.RESTART_GAEM="RESTART_GAME",i.STOP_GAME="STOP_GAME",i.PAUSE_GAME="PAUSE_GAME",i.ON_SHOW="ON_SHOW",i.ON_HIDE="ON_HIDE",i.CHANGE_SCENE="CHANGE_SCENE",i.RESIZE="RESIZE",i.BEGIN_MODULE="BEGIN_MODULE",i.END_MODULE="END_MODULE",i.UI_OPEN="UI_OPEN",i.UI_CLOSE="UI_CLOSE",i.UI_LANG="UI_LANG",t.EventID=i;class s{}s.RESOURCE_LOAD_COMPLATE="RESOURCE_LOAD_COMPLATE",s.RESOURCE_LOAD_PROGRESS="RESOURCE_LOAD_PROGRESS",s.RESOURCE_LOAD_FAILED="RESOURCE_LOAD_FAILED",s.LOADVIEW_OPEN="LOADVIEW_OPEN",s.LOADVIEW_COMPLATE="LOADVIEW_COMPLATE",s.LOADVIEW_PROGRESS="LOADVIEW_PROGRESS",t.LoaderEventID=s}(airkit||(airkit={})),function(t){t.Signal=class{constructor(){}destory(){this._listener&&this._listener.destory(),this._listener=null}dispatch(t){this._listener&&this._listener.execute(t)}has(t){return null!=this._listener&&this._listener.has(t)}on(t,e,...i){this.makeSureListenerManager(),this._listener.on(t,e,i,!1)}once(t,e,...i){this.makeSureListenerManager(),this._listener.on(t,e,i,!0)}off(t,e){this._listener&&this._listener.off(t,e)}makeSureListenerManager(){this._listener||(this._listener=new e)}};class e{constructor(){this.stopped=!1}destory(){this.stopped=!1,this.clear()}has(t){for(let e=0;e<this.handlers.length;e++)if(this.handlers[e].caller==t)return!0;return!1}on(e,i,s,r=!1){this.handlers||(this.handlers=[]);let n=new t.Handler(e,i,s,r);return this.handlers.push(n),n}off(t,e){if(!this.handlers||this.handlers.length<=0)return;let i=[];for(var s=0;s<this.handlers.length;s++){var r=this.handlers[s];if(r.caller===t&&r.method===e){r.recover();break}i.push(r)}for(++s;s<this.handlers.length;++s)i.push(this.handlers[s]);this.handlers=i}offAll(t,e){if(!this.handlers||this.handlers.length<=0)return;let i=[],s=this.handlers,r=s.length;for(var n=0;n<r;++n)t!==s[n].caller||e!==s[n].method?i.push(s[n]):s[n].recover();this.handlers=i}clear(){if(this.handlers&&!(this.handlers.length<=0)){for(var t=0;t<this.handlers.length;t++){this.handlers[t].recover()}this.handlers=null}}stop(){this.stopped=!0}execute(...t){if(!this.handlers||this.handlers.length<=0)return;let e,i=this.handlers,s=i.length,r=[],n=0;for(;n<s&&!this.stopped;++n)(e=i[n]).runWith(t),e.method&&r.push(e);for(;n<s;++n)r.push(i[n]);this.stopped=!1,this.handlers=r,e=null,i=null,r=null}}t.SignalListener=e}(airkit||(airkit={})),function(t){t.L=function(i,...s){let r=e.Instance.getText(e.Instance.curLang,i);return null==r?"unknown key:"+i:t.StringUtils.format(r,...s)};class e extends t.Singleton{static get Instance(){return this.instance||(this.instance=new e),this.instance}init(){this._curLang=null}destory(){}changeLang(e){return new Promise((i,s)=>{if(e==this._curLang)return void i(e);t.ConfigManger.Instance.getList(this._curLang)?t.DataProvider.Instance.getConfig(e)&&(this._curLang=e,t.EventCenter.dispatchEvent(t.EventID.UI_LANG,this._curLang),i(e)):(t.Log.error("no lang package {0} ",e),s("no lang package "+e))})}getText(e,i){let s=t.DataProvider.Instance.getInfo(e,i);return s?s.name:(t.Log.error("cant get lang key",i),"")}get curLang(){return this._curLang}}e.instance=null,t.LangManager=e}(airkit||(airkit={})),function(t){class e extends t.Singleton{static registerLoadingView(e,i,s){this.loaders.add(e,i),t.ClassUtils.regClass(i,s)}static get Instance(){return this.instance||(this.instance=new e),this.instance}setup(){this.registerEvent(),this._dicLoadView=new t.NDictionary}destroy(){if(this.unRegisterEvent(),this._dicLoadView){let t=null;this._dicLoadView.foreach(function(e,i){return(t=i).close(),!0}),this._dicLoadView.clear(),this._dicLoadView=null}}registerEvent(){t.EventCenter.on(t.LoaderEventID.LOADVIEW_OPEN,this,this.onLoadViewEvt),t.EventCenter.on(t.LoaderEventID.LOADVIEW_COMPLATE,this,this.onLoadViewEvt),t.EventCenter.on(t.LoaderEventID.LOADVIEW_PROGRESS,this,this.onLoadViewEvt)}unRegisterEvent(){t.EventCenter.off(t.LoaderEventID.LOADVIEW_OPEN,this,this.onLoadViewEvt),t.EventCenter.off(t.LoaderEventID.LOADVIEW_COMPLATE,this,this.onLoadViewEvt),t.EventCenter.off(t.LoaderEventID.LOADVIEW_PROGRESS,this,this.onLoadViewEvt)}onLoadViewEvt(e){let i=e.type,s=e.get(0);switch(i){case t.LoaderEventID.LOADVIEW_OPEN:{t.Log.debug("显示加载界面");let i=e.get(1),r=e.get(2);this.show(s,i,r)}break;case t.LoaderEventID.LOADVIEW_PROGRESS:{let t=e.get(1),i=e.get(2);this.setProgress(s,t,i)}break;case t.LoaderEventID.LOADVIEW_COMPLATE:t.Log.debug("加载界面关闭"),this.close(s)}}show(i,s,r){if(null==i||i==t.LOADVIEW_TYPE_NONE)return;let n=this._dicLoadView.getValue(i);if(n)this.updateView(n,s,r);else{let a=e.loaders.getValue(i);if(a.length>0){if(null==(n=t.ClassUtils.getInstance(a)))return;n.setup([]);let e=t.ClassUtils.getClass(a);n.loadResource(t.ResourceManager.SystemGroup,e).then(()=>{t.LayerManager.loadingLayer.addChild(n),this._dicLoadView.add(i,n),this.updateView(n,s,r)})}else t.Log.error("Must set loadingview first type= {0}",i)}}updateView(e,i,s){e.parent||t.LayerManager.loadingLayer.addChild(e),e.onOpen(i),e.setTips(s),e.setVisible(!0)}setProgress(t,e,i){let s=this._dicLoadView.getValue(t);s&&s.setProgress(e,i)}close(t){let e=this._dicLoadView.getValue(t);e&&(e.setVisible(!1),e.onClose(),this._dicLoadView.remove(t),e=null)}}e.loaders=new t.NDictionary,e.instance=null,t.LoaderManager=e}(airkit||(airkit={})),function(t){t.FONT_SIZE_4=18,t.FONT_SIZE_5=22,t.FONT_SIZE_6=25,t.FONT_SIZE_7=29;class e extends t.Singleton{constructor(){super(...arguments),this._dicLoaderUrl=null}static get Instance(){return this.instance||(this.instance=new e),this.instance}setup(){this._dicLoaderUrl=new t.SDictionary,this._minLoaderTime=1e3,this._aniAnimDic=new t.SDictionary,this.onAniResUpdateSignal=new t.Signal}static asyncLoad(t,e,i,s,r,n,a){return new Promise((s,r)=>{cc.loader.loadRes(t,i,(t,i,s)=>{e.runWith(t/i)},(e,i)=>{e?r(t):s(t)})})}destroy(){this._dicLoaderUrl&&(this._dicLoaderUrl.clear(),this._dicLoaderUrl=null)}update(t){}getRes(t){return this.refreshResourceTime(t,null,!1),cc.loader.getRes(t)}loadRes(i,s,r=t.LOADVIEW_TYPE_NONE,n=1,a=!0,l="default",h=!1){return this.refreshResourceTime(i,l,!0),null==r&&(r=t.LOADVIEW_TYPE_NONE),r!=t.LOADVIEW_TYPE_NONE&&cc.loader.getRes(i)&&(r=t.LOADVIEW_TYPE_NONE),r!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_OPEN,r,1),new Promise((o,c)=>{e.asyncLoad(i,t.Handler.create(this,this.onLoadProgress,[r,1],!1),s,n,a,l,h).then(t=>{this.onLoadComplete(r,[i]),o(i)}).catch(t=>{c(t)})})}loadArrayRes(i,s=t.LOADVIEW_TYPE_NONE,r=null,n=1,a=!0,l="default",h=!1){let o=!1,c=[],u=[];null==s&&(s=t.LOADVIEW_TYPE_NONE),null==n&&(n=1),null==a&&(a=!0);for(let t of i)c.push({url:t.url,type:t.type}),u.push(t.url),o||cc.loader.getRes(t.url)||(o=!0),this.refreshResourceTime(t.url,l,!0);return o||s==t.LOADVIEW_TYPE_NONE||(s=t.LOADVIEW_TYPE_NONE),s!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_OPEN,s,c.length,r),new Promise((i,o)=>{e.asyncLoad(c,t.Handler.create(this,this.onLoadProgress,[s,c.length,r],!1),void 0,n,a,l,h).then(e=>{s!=t.LOADVIEW_TYPE_NONE?t.TimerManager.Instance.addOnce(this._minLoaderTime,null,t=>{this.onLoadComplete(s,u,r),i(u)}):(this.onLoadComplete(s,u,r),i(u))}).catch(t=>{o(t)})})}onLoadComplete(e,...s){if(s){let e=s[0];for(let s of e){t.Log.debug("[load]加载完成url:"+s);var r=s.lastIndexOf(".bin");if(r>0){let e=s.substr(0,r);fgui.UIPackage.addPackage(e),t.Log.info("add Package :"+e)}let e=this._dicLoaderUrl.getValue(s);e&&e.updateStatus(i.LOADED)}}e!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_COMPLATE,e)}onLoadProgress(e,i,s,r){let n=t.NumberUtils.toInt(Math.floor(r*i));t.Log.debug("[load]进度: current={0} total={1}",n,i),e!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_PROGRESS,e,n,i,s)}refreshResourceTime(t,e,r){if(r){let r=this._dicLoaderUrl.getValue(t);r?r.ctime=Date.now():(r=new s(t,e),this._dicLoaderUrl.add(t,r),r.updateStatus(i.LOADING))}else{let e=this._dicLoaderUrl.getValue(t);e&&(e.utime=Date.now())}}clearRes(e){this._dicLoaderUrl.remove(e),cc.loader.releaseRes(e);var i=e.lastIndexOf(".bin");if(i>0){let s=e.lastIndexOf("/"),r=e.substr(s+1,i-s-1);fgui.UIPackage.removePackage(r),t.Log.info("remove Package :"+r)}t.Log.info("[res]释放资源:"+e)}cleanTexture(e){this._dicLoaderUrl.foreach((i,s)=>(s.group==e&&(t.Log.info("清理texture资源 {0}",i),this.clearRes(i)),!0))}setAniAnim(t,e,i){let s=this._aniAnimDic.getValue(t);null==s?this._aniAnimDic.add(t,[e,1,i]):s[1]+=1}createFuiAnim(t,i,s,r="default"){return new Promise((n,a)=>{let l=s+"_atlas0.png",h=s+".bin";if(null==e.Instance.getRes(l))e.Instance.loadArrayRes([{url:l,type:cc.SpriteFrame},{url:h,type:cc.BufferAsset}],null,null,0,!0,r).then(e=>{let s=fgui.UIPackage.createObject(t,i);n(s.asCom)}).catch(t=>{a(t)});else{let e=fgui.UIPackage.createObject(t,i);n(e.asCom)}})}static imageProxy(i,s,r,n){return new Promise((a,l)=>{if(null!=e.Instance.getRes(s))i.url=s;else{let a=s;null!=n&&(a=n),r&&(i.url=r),t.Log.info("imageProxy start load {0} ",a),e.Instance.loadRes(a).then(e=>{i.url=s,i.alpha=.1,t.TweenUtils.get(i).to({alpha:1},.3),t.Log.info("imageProxy start load done {0} ",a)}).catch(e=>t.Log.error(e))}})}}let i;e.FONT_Yuanti="Yuanti SC Regular",e.Font_Helvetica="Helvetica",e.FONT_DEFAULT="",e.FONT_DEFAULT_SIZE=t.FONT_SIZE_5,e.DefaultGroup="airkit",e.SystemGroup="system",e.instance=null,t.ResourceManager=e,function(t){t[t.READY=0]="READY",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(i||(i={}));class s{constructor(t,e){this.url=t,this.group=e,this.ctime=Date.now(),this.utime=Date.now(),this.status=i.READY}updateStatus(t){this.status=t}}}(airkit||(airkit={})),function(t){class e{static format(e,...i){if(null==e)return"null";if(t.StringUtils.isString(e)){let s=[];for(let e=0;e<i.length;e++){let r=i[e];t.StringUtils.isString(r)?s.push(r):s.push(JSON.stringify(r,null,4))}return t.StringUtils.format(e,...s)}return"object"==typeof e&&e.message?e.message:JSON.stringify(e,null,4)}static debug(e,...i){if(this.LEVEL<t.LogLevel.DEBUG)return;let s=this.format(e,...i);return console.log(t.DateUtils.currentYMDHMS(),"[debug]",s),s}static info(e,...i){if(this.LEVEL<t.LogLevel.INFO)return;let s=this.format(e,...i);return console.log(t.DateUtils.currentYMDHMS(),"[info]",s),s}static warning(e,...i){if(this.LEVEL<t.LogLevel.WARNING)return;let s=this.format(e,...i);return console.warn(t.DateUtils.currentYMDHMS(),"[warn]",s),s}static error(e,...i){if(this.LEVEL<t.LogLevel.ERROR)return;let s=this.format(e,...i);return console.error(t.DateUtils.currentYMDHMS(),"[error]",s),s}static exception(e,...i){if(this.LEVEL<t.LogLevel.EXCEPTION)return;let s=this.format(e,...i);return console.exception(t.DateUtils.currentYMDHMS(),"[exce]",s),s}static dump(e){if(!(this.LEVEL<t.LogLevel.INFO)){if(e instanceof Object)try{e=JSON.stringify(e,null,4)}catch(t){console.error(t)}console.log(t.DateUtils.currentYMDHMS(),"[Dump]",e)}}}e.LEVEL=t.LogLevel.INFO,t.Log=e}(airkit||(airkit={})),function(t){t.BaseModule=class extends cc.Node{constructor(){super()}setup(e){this.emit(t.EventID.BEGIN_MODULE,this.name),this.registerEvent()}start(){}update(t){}registerEvent(){this.registerSignalEvent()}unRegisterEvent(){this.unregisterSignalEvent()}static res(){return null}static loaderTips(){return"资源加载中"}static loaderType(){return t.LOADVIEW_TYPE_NONE}registerSignalEvent(){let t=this.signalMap();if(t)for(let e of t)e[0].on(e[1],e[2],e.slice(3))}unregisterSignalEvent(){let t=this.signalMap();if(t)for(let e of t)e[0].off(e[1],e[2])}signalMap(){return null}dispose(){this.emit(t.EventID.END_MODULE,this.name),this.unRegisterEvent()}}}(airkit||(airkit={})),function(t){class e{static get Instance(){return this.instance||(this.instance=new e),this.instance}setup(){this.registerEvent()}static register(e,i){t.ClassUtils.regClass(e,i)}static call(e,i,...s){return new Promise((r,n)=>{let a=this.modules.getValue(e);if(null==a){a=t.ClassUtils.getInstance(e);let l=t.ClassUtils.getClass(e);null==a&&(t.Log.warning("Cant find module {0}",e),n("Cant find module"+e)),this.modules.add(e,a),a.name=e,this.loadResource(a,l).then(e=>{a.once(t.EventID.BEGIN_MODULE,()=>{if(a.start(),null==i)r(a);else{let t=this.callFunc(a,i,s);r(t)}},null),a.setup(null)}).catch(i=>{t.Log.warning("Load module Resource Failed {0}",e),n("Load module Resource Failed "+e)})}else if(null==i)r(a);else{let t=this.callFunc(a,i,s);r(t)}})}static callFunc(e,i,s){if(null==i)return;var r=e[i];let n=null;return r?n=s?r.apply(e,s):r.apply(e):t.Log.error("cant find funcName {0} from Module:{1}",i,e.name),n}static loadResource(e,i){let s=[],r=i.res();if(r&&r.length>0)for(let e=0;e<r.length;++e){let i=r[e];t.ResourceManager.Instance.getRes(i[0])||s.push({url:i[0],type:i[1]})}return new Promise((e,r)=>{if(s.length>0){let n=i.loaderType(),a=i.loaderTips();t.ResourceManager.Instance.loadArrayRes(s,n,a,1,!0,t.ResourceManager.DefaultGroup).then(t=>{e(t)}).catch(t=>{r(t)})}else e([])})}destroy(){this.unRegisterEvent(),this.clear()}clear(){e.modules&&(e.modules.foreach((t,e)=>(e.dispose(),!0)),e.modules.clear())}update(t){e.modules.foreach((e,i)=>(i.update(t),!0))}registerEvent(){}unRegisterEvent(){}}e.modules=new t.SDictionary,e.instance=null,t.Mediator=e}(airkit||(airkit={})),function(t){let e;!function(t){t[t.TypeText=0]="TypeText",t[t.TypeJson=1]="TypeJson",t[t.TypePB=2]="TypePB"}(e=t.eHttpRequestType||(t.eHttpRequestType={})),t.POST="POST",t.GET="GET",t.CONTENT_TYPE_TEXT="application/x-www-form-urlencoded",t.CONTENT_TYPE_JSON="application/json",t.CONTENT_TYPE_PB="application/octet-stream",t.RESPONSE_TYPE_TEXT="text",t.RESPONSE_TYPE_JSON="json",t.RESPONSE_TYPE_XML="xml",t.RESPONSE_TYPE_BYTE="arraybuffer",t.HTTP_REQUEST_TIMEOUT=1e4;class i{static request(s,r,n,a,l,h){return new Promise((o,c)=>{i.currentRequsts>i.maxRequest&&t.Log.error("reached max request {0}",i.currentRequsts),i.currentRequsts<0&&(i.currentRequsts=0),i.currentRequsts++,null==h&&(h="text"),r!=t.POST&&r!=t.GET&&(i.currentRequsts--,c("method error")),a||(a=[]);let u="Content-Type";switch(n){case e.TypeText:a.push(u,t.CONTENT_TYPE_TEXT);break;case e.TypeJson:a.push(u,t.CONTENT_TYPE_JSON);break;case e.TypePB:a.push(u,t.CONTENT_TYPE_PB);break;default:a.push(u,t.CONTENT_TYPE_TEXT)}var _=new t.HttpRequest;_.http.timeout=t.HTTP_REQUEST_TIMEOUT,_.http.ontimeout=function(){t.Log.error("request timeout {0}",s),_.targetOff(_),i.currentRequsts--,c("timeout")},_.once(t.Event.COMPLETE,this,function(e){let s;switch(h){case t.RESPONSE_TYPE_TEXT:case t.RESPONSE_TYPE_JSON:s=_.data;break;case t.RESPONSE_TYPE_BYTE:var r=new t.Byte(_.data);r.endian=t.Byte.BIG_ENDIAN,s=r.getUint8Array(r.pos,r.length-r.pos);break;default:s=_.data}_.targetOff(_),i.currentRequsts--,o(s)}),_.once(t.Event.ERROR,this,function(e){t.Log.error("req:{0} error:{1}",s,e),_.targetOff(_),i.currentRequsts--,c(e)}),_.on(t.Event.PROGRESS,this,function(t){}),r==t.GET?_.send(s,null,r,h,a):_.send(s,l,r,h,a)})}static get(i,s,r,n){return null==s&&(s=e.TypeText),null==n&&(n=t.RESPONSE_TYPE_TEXT),this.request(i,t.GET,s,r,null,n)}static post(i,s,r,n,a){var l=null;switch(null==r&&(r=e.TypeText),r){case e.TypeText:s&&(l=t.Utils.obj2query(s));break;case e.TypeJson:s&&(l=JSON.stringify(s));break;case e.TypePB:s&&(l=s)}return null==a&&(a=t.RESPONSE_TYPE_TEXT),this.request(i,t.POST,r,n,l,a)}}i.currentRequsts=0,i.maxRequest=6,t.Http=i}(airkit||(airkit={})),function(t){class e extends cc.Node{constructor(){super(...arguments),this._http=new XMLHttpRequest}send(t,e=null,i="get",s="text",r=null){this._responseType=s,this._data=null,this._url=t;var n=this,a=this._http;a.open(i,t,!0);let l=!1;if(r)for(var h=0;h<r.length;h++)a.setRequestHeader(r[h++],r[h]);else window.conch||(e&&"string"!=typeof e?(a.setRequestHeader("Content-Type","application/json"),l=!0):a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));let o="arraybuffer"!==s?"text":"arraybuffer";a.responseType=o,a.dataType&&(a.dataType=o),a.onerror=function(t){n._onError(t)},a.onabort=function(t){n._onAbort(t)},a.onprogress=function(t){n._onProgress(t)},a.onload=function(t){n._onLoad(t)},a.send(l?JSON.stringify(e):e)}_onProgress(e){e&&e.lengthComputable&&this.emit(t.Event.PROGRESS,e.loaded/e.total)}_onAbort(t){this.error("Request was aborted by user")}_onError(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}_onLoad(t){var e=this._http,i=void 0!==e.status?e.status:200;200===i||204===i||0===i?this.complete():this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}error(e){this.clear(),console.warn(this.url,e),this.emit(t.Event.ERROR,e)}complete(){this.clear();var e=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=t.Utils.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(t){e=!1,this.error(t.message)}e&&this.emit(t.Event.COMPLETE,this._data instanceof Array?[this._data]:this._data)}clear(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}get url(){return this._url}get data(){return this._data}get http(){return this._http}}e._urlEncode=encodeURI,t.HttpRequest=e}(airkit||(airkit={})),function(t){t.State=class{constructor(t,e){this._owner=null,this._status=0,this._times=0,this._tick=0,this._entity=t,this._status=e}enter(){t.Log.info("you must overwrite the func state.enter !")}update(e){t.Log.info("you must overwrite the func state.update !")}exit(){t.Log.info("you must overwrite the func state.exit !")}}}(airkit||(airkit={})),function(t){t.StateMachine=class{constructor(){this._currentState=null,this._previousState=null,this._globalState=null}update(t){this._globalState&&this._globalState.update(t),this._currentState&&this._currentState.update(t)}changeState(t){this._previousState=this._currentState,this._currentState=t,this._currentState._owner=this,this._previousState&&this._previousState.exit(),this._currentState.enter()}setCurrentState(t){this._currentState&&this._currentState.exit(),this._currentState=t,this._currentState._owner=this,this._currentState.enter()}setGlobalState(t){this._globalState&&this._globalState.exit(),this._globalState=t,this._globalState._owner=this,this._globalState.enter()}clearAllState(){this._globalState&&(this._globalState.exit(),this._globalState=null),this._currentState&&(this._currentState.exit(),this._currentState=null),this._previousState=null}get currentState(){return this._currentState}get previousState(){return this._previousState}get globalState(){return this._globalState}}}(airkit||(airkit={})),function(t){class e{static getSeq(){return e.REQ_ID++}decode(e,i){let s=t.bytes2String(e,i),r=JSON.parse(s);return r&&r.payload?(this.uid=r.uid,this.cmd=r.cmd,this.msgType=r.msgType,this.ID=r.userdata,this.data=JSON.parse(r.payload),!0):(s=null,!1)}encode(t){this.ID=e.getSeq();let i={uid:this.uid,cmd:this.cmd,msgType:this.msgType,seq:this.ID,userdata:this.ID,payload:JSON.stringify(this.data)};return JSON.stringify(i)}getID(){return this.ID}}e.REQ_ID=1,t.JSONMsg=e;t.PBMsg=class{constructor(){this.receiveByte=new t.Byte,this.receiveByte.endian=t.Byte.LITTLE_ENDIAN}getID(){return this.ID}decode(e,i){this.receiveByte.clear(),this.receiveByte.writeArrayBuffer(e),this.receiveByte.pos=0;var s=this.receiveByte.getInt16();return this.receiveByte.getInt16(),this.receiveByte.bytesAvailable>=s&&((new t.Byte).writeArrayBuffer(this.receiveByte,4,s),!0)}encode(e){let i=new t.Byte;return i.endian=t.Byte.LITTLE_ENDIAN,i.pos=0,i}}}(airkit||(airkit={})),function(t){class e extends fgui.GComponent{constructor(){super(),this._isOpen=!1,this._UIID=0,this.objectData=null,this._destory=!1,this._viewID=e.__ViewIDSeq++}createPanel(t,e){let i=fgui.UIPackage.createObjectFromURL("ui://"+t+"/"+e);null!=i&&(this._view=i.asCom,this._view.setSize(this.width,this.height),this._view.addRelation(this,fgui.RelationType.Width),this._view.addRelation(this,fgui.RelationType.Height),this.addChild(this._view))}debug(){}setup(e){this._isOpen=!0,this.onLangChange(),this.onCreate(e),t.EventCenter.dispatchEvent(t.EventID.UI_OPEN,this._UIID),t.EventCenter.on(t.EventID.UI_LANG,this,this.onLangChange),this.registerEvent(),this.registeGUIEvent(),this.registerSignalEvent()}dispose(){this._destory||(this._destory=!0,this.onDestroy(),this.unRegisterEvent(),this.unregisteGUIEvent(),this.unregisterSignalEvent(),this._isOpen=!1,this.objectData=null,t.EventCenter.dispatchEvent(t.EventID.UI_CLOSE,this._UIID),t.EventCenter.off(t.EventID.UI_LANG,this,this.onLangChange),super.dispose())}isDestory(){return this._destory}panel(){let t=this.getGObject("panel");return null!=t?t.asCom:null}bg(){let t=this.getGObject("bg");return null!=t?t.asCom:null}setVisible(t){this.visible;this.visible=t}setUIID(t){this._UIID=t}get UIID(){return this._UIID}get viewID(){return this._viewID}onCreate(t){}onDestroy(){}update(t){return!0}getGObject(t){return this._view.getChild(t)}onEnter(){}onLangChange(){}static res(){return null}static loaderTips(){return"资源加载中"}static loaderType(){return t.LOADVIEW_TYPE_NONE}signalMap(){return null}eventMap(){return null}registerEvent(){}unRegisterEvent(){}staticCacheUI(){return null}loadResource(e,i){return new Promise((s,r)=>{let n=[],a=i.res();if(a&&a.length>0)for(let e=0;e<a.length;++e){let i=a[e];t.ResourceManager.Instance.getRes(i[0])||n.push({url:i[0],type:i[1]})}if(n.length>0){let a=i.loaderTips(),l=i.loaderType();t.ResourceManager.Instance.loadArrayRes(n,l,a,1,!0,e).then(t=>{this.onAssetLoaded(),s(this),this.onEnter()}).catch(e=>{t.Log.error(e),r(e)})}else this.onAssetLoaded(),s(this),this.onEnter()})}onAssetLoaded(){this._isOpen}registerSignalEvent(){let t=this.signalMap();if(t)for(let e of t){e[0].on(e[1],e[2],e.slice(3))}}unregisterSignalEvent(){let t=this.signalMap();if(t)for(let e of t){e[0].off(e[1],e[2])}}registeGUIEvent(){let t=this.eventMap();if(t)for(let e of t){e[0].on(e[1],e[2],this)}}unregisteGUIEvent(){let t=this.eventMap();if(t)for(let e of t){e[0].off(e[1],e[2],this)}}doClose(){return!1===this._isOpen?(t.Log.error("连续点击"),!1):(this._isOpen=!1,t.UIManager.Instance.close(this.UIID,t.eCloseAnim.CLOSE_CENTER),!0)}}e.__ViewIDSeq=0,t.BaseView=e}(airkit||(airkit={})),function(t){class e extends fgui.GComponent{constructor(){super()}debug(){}}t.Layer=e;class i extends t.Singleton{static get stage(){return this._root}static getLayer(e){let i=null;switch(e){case t.eUILayer.BG:i=this.bgLayer;break;case t.eUILayer.MAIN:i=this.mainLayer;break;case t.eUILayer.GUI:i=this.uiLayer;break;case t.eUILayer.POPUP:i=this.popupLayer;break;case t.eUILayer.TOOLTIP:i=this.tooltipLayer;break;case t.eUILayer.SYSTEM:i=this.systemLayer;break;case t.eUILayer.LOADING:i=this.loadingLayer;break;case t.eUILayer.TOP:i=this.topLayer}return cc.director.getWinSize().width==i.width&&cc.director.getWinSize().height==i.height||(i.width=cc.director.getWinSize().width,i.height=cc.director.getWinSize().height),i}static setup(t){this._root=t,this._bgLayer=new e,this._bgLayer.node.name="bgLayer",this._bgLayer.touchable=!0,this._root.addChild(this._bgLayer),this._bgLayer.sortingOrder=0,this._mainLayer=new e,this._mainLayer.node.name="mainLayer",this._mainLayer.touchable=!0,this._root.addChild(this._mainLayer),this._mainLayer.sortingOrder=2,this._tooltipLayer=new e,this._tooltipLayer.node.name="tooltipLayer",this._tooltipLayer.touchable=!1,this._root.addChild(this._tooltipLayer),this._tooltipLayer.sortingOrder=3,this._uiLayer=new e,this._uiLayer.node.name="uiLayer",this._uiLayer.touchable=!0,this._root.addChild(this._uiLayer),this._uiLayer.sortingOrder=4,this._popupLayer=new e,this._popupLayer.node.name="popupLayer",this._popupLayer.touchable=!0,this._root.addChild(this._popupLayer),this._popupLayer.sortingOrder=5,this._systemLayer=new e,this._systemLayer.node.name="systemLayer",this._systemLayer.touchable=!0,this._root.addChild(this._systemLayer),this._systemLayer.sortingOrder=6,this._loadingLayer=new e,this._loadingLayer.node.name="loadingLayer",this._loadingLayer.touchable=!0,this._root.addChild(this._loadingLayer),this._loadingLayer.sortingOrder=1001,this._topLayer=new e,this._topLayer.node.name="topLayer",this._topLayer.touchable=!0,this._root.addChild(this._topLayer),this._topLayer.sortingOrder=1002,this.layers=[this._bgLayer,this._mainLayer,this._uiLayer,this._popupLayer,this._tooltipLayer,this._systemLayer,this._loadingLayer,this._topLayer],this.registerEvent(),this.resize()}static registerEvent(){t.EventCenter.on(t.EventID.RESIZE,this,this.resize)}static unRegisterEvent(){t.EventCenter.off(t.EventID.RESIZE,this,this.resize)}static resize(){var e,s;t.Log.info("LayerManager Receive Resize {0} {1}",cc.director.getWinSize().width,cc.director.getWinSize().height);let r=cc.director.getWinSize().width,n=cc.director.getWinSize().height;for(fgui.GRoot.inst.setSize(r,n),e=0,s=this.layers.length;e<s;e++)this.layers[e].setSize(r,n);if(this._bgLayer.numChildren){var a=this._bgLayer.getChildAt(0);let t=r-i.BG_WIDTH>>1,e=n-i.BG_HEIGHT;a.setPosition(t,e)}fgui.GRoot.inst.setSize(r,n);let l=[this._uiLayer,this._popupLayer,this._systemLayer,this._topLayer,this._loadingLayer];for(let t=0;t<l.length;t++){let e=l[t];for(let t=0,i=e.numChildren;t<i;t++){e.getChildAt(t).setSize(r,n)}}}static destroy(){i.removeAll(),t.DisplayUtils.removeAllChild(this._topLayer),t.DisplayUtils.removeAllChild(this._root),this._topLayer=null,this._loadingLayer=null,this._systemLayer=null,this._tooltipLayer=null,this._popupLayer=null,this._uiLayer=null,this._mainLayer=null,this._bgLayer=null}static removeAll(){t.DisplayUtils.removeAllChild(this._bgLayer),t.DisplayUtils.removeAllChild(this._mainLayer),t.DisplayUtils.removeAllChild(this._uiLayer),t.DisplayUtils.removeAllChild(this._popupLayer),t.DisplayUtils.removeAllChild(this._tooltipLayer),t.DisplayUtils.removeAllChild(this._systemLayer),t.DisplayUtils.removeAllChild(this._loadingLayer)}static get root(){return this._root}static get bgLayer(){return this._bgLayer}static addBg(t){var e;return this.bgLayer.numChildren?e=this.bgLayer.getChildAt(0):((e=new fgui.GLoader).width=i.BG_WIDTH,e.height=i.BG_HEIGHT,e.x=cc.director.getWinSize().width-i.BG_WIDTH>>1,e.y=cc.director.getWinSize().height-i.BG_HEIGHT,this.bgLayer.addChild(e)),e.url=t,e}static get mainLayer(){return this._mainLayer}static get uiLayer(){return this._uiLayer}static get popupLayer(){return this._popupLayer}static get tooltipLayer(){return this._tooltipLayer}static get systemLayer(){return this._systemLayer}static get loadingLayer(){return this._loadingLayer}static get topLayer(){return this._topLayer}}i.BG_WIDTH=750,i.BG_HEIGHT=1650,t.LayerManager=i}(airkit||(airkit={})),function(t){t.PopupView=class extends t.BaseView{constructor(){super(),this.bgTouch=!0}update(t){return super.update(t)}setup(t){super.setup(t),this.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height)}onEnter(){super.onEnter(),this.createPanel(this.pkgName,this.resName);let e=this.panel();e&&(t.DisplayUtils.popup(e,t.Handler.create(this,this.onOpen)),this.closeBtn=this.closeButton(),this.closeBtn&&(this.closeBtn.visible=!1)),t.TimerManager.Instance.addOnce(250,this,this.setupTouchClose)}onOpen(){}closeButton(){let t=this.panel().getChild("closeBtn");return null!=t?t.asButton:null}setupTouchClose(){let t=this.bg();t&&this.bgTouch&&(t.touchable=!0,t.onClick(this.onClose,this)),this.closeBtn&&(this.closeBtn.visible=!0,this.closeBtn.onClick(this.pressClose,this))}pressClose(){this.closeBtn&&t.TweenUtils.scale(this.closeBtn),this.onClose()}onClose(){this.doClose()}dispose(){super.dispose(),null!=this.callback&&this.callback()}loadResource(t,e){return super.loadResource(t,e)}}}(airkit||(airkit={})),function(t){class e{static registerScene(i,s,r){e.scenes.add(i,s),t.ClassUtils.regClass(s,r)}static get Instance(){return this.instance||(this.instance=new e),this.instance}setup(){this.registerEvent()}destroy(){this.unRegisterEvent()}update(t){this._curScene&&this._curScene.update(t)}registerEvent(){t.EventCenter.on(t.EventID.CHANGE_SCENE,this,this.onChangeScene),t.EventCenter.on(t.EventID.RESIZE,this,this.resize)}unRegisterEvent(){t.EventCenter.off(t.EventID.CHANGE_SCENE,this,this.onChangeScene),t.EventCenter.off(t.EventID.RESIZE,this,this.resize)}resize(){if(t.Log.info("SceneManager Receive Resize {0} {1}",cc.director.getWinSize().width,cc.director.getWinSize().height),this._curScene){this._curScene.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height);var e=this._curScene.resize;let t=null;e&&(t=e.apply(this._curScene))}}onChangeScene(t){let e=t.get(0);this.gotoScene(e)}onComplete(t){this._curScene=t}gotoScene(i,s){this.exitScene();let r=e.scenes.getValue(i),n=t.ClassUtils.getClass(r),a=new n;a.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height),a.setup(s),a.loadResource(t.ResourceManager.DefaultGroup,n).then(t=>{this.onComplete(t)}).catch(e=>{t.Log.error(e)}),t.LayerManager.mainLayer.addChild(a)}exitScene(){this._curScene&&(this._curScene.removeFromParent(),this._curScene.dispose(),this._curScene=null,t.UIManager.Instance.closeAll(),t.ObjectPools.clearAll(),t.ResourceManager.Instance.cleanTexture(t.ResourceManager.DefaultGroup))}}e.scenes=new t.NDictionary,e.instance=null,t.SceneManager=e}(airkit||(airkit={})),function(t){class e extends t.Singleton{constructor(){super(),this._dicConfig=null,this._dicUIView=null,this._UIQueues=null,this._dicConfig=new t.NDictionary,this._dicUIView=new t.NDictionary,this._UIQueues=new t.NDictionary,this._UIQueues.add(t.eUIQueueType.POPUP,new i),this._UIQueues.add(t.eUIQueueType.ALERT,new i)}static get Instance(){return this.instance||(this.instance=new e),this.instance}empty(){return!!this._UIQueues.getValue(t.eUIQueueType.POPUP).empty()&&!(this._dicUIView.length>0)}show(e,...i){return new Promise((s,r)=>{t.Log.info("show panel {0}",e);let n=this._dicUIView.getValue(e);if(null!=n){if(null!=n.displayObject)return n.setVisible(!0),void s(n);this._dicUIView.remove(e),n=null}let a=this._dicConfig.getValue(e);t.assert(null!=a,"UIManager::Show - not find id:"+a.mID);let l=i.slice(0),h=t.ClassUtils.getClass(a.name),o=new h;t.assert(null!=o,"UIManager::Show - cannot create ui:"+e),o.setUIID(e),o.setup(l),o.loadResource(t.ResourceManager.DefaultGroup,h).then(i=>{t.LayerManager.getLayer(a.mLayer).addChild(i),this._dicUIView.add(e,i),s(i)}).catch(e=>{t.Log.error(e)})})}close(e,i=0){return new Promise((s,r)=>{t.Log.info("close panel {0}",e);let n=this._dicConfig.getValue(e);t.assert(null!=n,"UIManager::Close - not find id:"+n.mID);let a=this._dicUIView.getValue(e);if(a)if(0==i){let t=this.clearPanel(e,a,n);s([e,t])}else t.DisplayUtils.hide(a,t.Handler.create(null,t=>{let i=this.clearPanel(e,a,n);s([e,i])}))})}clearPanel(e,i,s){return s.mHideDestroy?(this._dicUIView.remove(e),t.Log.info("clear panel {0}",e),i.removeFromParent(),i.dispose(),!0):(i.setVisible(!1),!1)}closeAll(i=null){this._dicUIView.foreach(function(s,r){return!(!i||!t.ArrayUtils.containsValue(i,s))||(e.Instance.close(s),!0)})}popup(e,...i){this._UIQueues.getValue(t.eUIQueueType.POPUP).show(e,i)}alert(e,...i){this._UIQueues.getValue(t.eUIQueueType.ALERT).show(e,i)}findPanel(t){return this._dicUIView.getValue(t)}isPanelOpen(t){return!!this._dicUIView.getValue(t)}tipsPopup(e,i,s,r=.5,n=null,a=null,l=!0){return new Promise((n,a)=>{e.addChild(s),s.setScale(.1,.1);let l=i.localToGlobal(i.width/2-i.pivotX*i.width,.382*i.height-i.pivotY*i.height),h=e.globalToLocal(l.x,l.y),o=0,c=600,u=fgui.EaseType.BounceOut;r>1.5?(o=e.height+600,c=-600,u=fgui.EaseType.QuadOut,s.setPosition(h.x,o)):s.setPosition(h.x,o-200),t.TweenUtils.get(s).delay(1.5).to({scaleX:1,scaleY:1,alpha:1,x:h.x,y:h.y},r,u).delay(.5).to({x:h.x,y:o-c},r,fgui.EaseType.ExpoOut,t.Handler.create(null,()=>{s.removeFromParent(),n()}))})}singleToast(e,i,s,r=.5,n,a=!0,l=null,h=null){return new Promise((n,o)=>{let c="_single_toast";null==i[c]&&(i[c]=[]);let u=fgui.EaseType.QuadOut,_=fgui.EaseType.QuadIn;e.addChild(s);let d=t.ClassUtils.classKey(s);for(var g in i[c]){let e=i[c][g];e&&(e.toY-=e.height+5,t.ClassUtils.classKey(e)==d&&(e.visible=!1))}i[c].push(s),s.visible=!0,s.setScale(.1,.1),null==l&&(l=i.width/2-i.pivotX*i.width),null==h&&(h=.382*i.height-i.pivotY*i.height);let p=i.localToGlobal(l,h),f=e.globalToLocal(p.x,p.y);s.setPosition(f.x,f.y),s.toY=s.y;let y=t.TweenUtils.get(s);y.setOnUpdate(t=>{let e=s.toY;if(e<s.y){let t=.4*(e-s.y),i=-5-Math.ceil(s.height/50);t<i&&(t=i),s.y+=t}});y.to({scaleX:1,scaleY:1,alpha:1},r,u).to({alpha:.4},.7*r,_,t.Handler.create(this,()=>{i[c].splice(i[c].indexOf(s),1),i&&s&&s.parent&&(s.removeFromParent(),y.clear()),a?t.ObjectPools.recover(s):s.dispose(),n()}))})}toast(e,i,s,r=.5,n,a=!0,l=null,h=null){return new Promise((o,c)=>{null==i._toastList&&(i._toastList=[]);let u=fgui.EaseType.QuadOut,_=fgui.EaseType.QuadIn;if(e.addChild(s),n){for(var d in i._toastList)i._toastList[d]&&(i._toastList[d].toY-=i._toastList[d].height+8,i._toastList[d].visible=!1);r=r,u=fgui.EaseType.BounceOut,_=fgui.EaseType.BounceIn}else for(var d in i._toastList)i._toastList[d]&&(i._toastList[d].toY-=i._toastList[d].height+8);i._toastList.push(s),s.setScale(.1,.1),null==l&&(l=i.width/2-i.pivotX*i.width),null==h&&(h=.382*i.height-i.pivotY*i.height);let g=i.localToGlobal(l,h),p=e.globalToLocal(g.x,g.y);s.setPosition(p.x,p.y),s.toY=s.y;let f=t.TweenUtils.get(s);f.setOnUpdate(t=>{let e=s.toY;if(e<s.y){let t=.4*(e-s.y),i=-8-Math.ceil(s.height/50);t<i&&(t=i),s.y+=t}});f.to({scaleX:1,scaleY:1,alpha:1},r,u).to({alpha:.4},.7*r,_,t.Handler.create(this,()=>{i._toastList.splice(i._toastList.indexOf(s),1),i&&s&&s.parent&&(s.removeFromParent(),f.clear()),a?t.ObjectPools.recover(s):s.dispose(),o()}))})}setup(){}destroy(){this.closeAll(),this.clearUIConfig()}update(t){this._dicUIView.foreach(function(e,i){return i.update(t),!0})}addUIConfig(e){this._dicConfig.containsKey(e.mID)?t.Log.error("UIManager::Push UIConfig - same id is register:"+e.mID):(this._dicConfig.add(e.mID,e),t.ClassUtils.regClass(e.name,e.cls))}clearUIConfig(){this._dicConfig.clear()}getUIConfig(t){return this._dicConfig.getValue(t)}getUILayerID(t){let e=this._dicConfig.getValue(t);return e?e.mLayer:-1}}e.instance=null,t.UIManager=e;t.AlertInfo=class{constructor(t,e="",i,s="",r={},n=null){this.title="",this.tips="",this.buttons=[],this.param=null,this.callback=t,this.title=e,this.content=i,this.tips=s,this.buttons=r,this.param=n}};t.UIConfig=class{constructor(t,e,i,s,r,n){this.mID=t,this.name=e,this.cls=i,this.mLayer=s,this.mHideDestroy=r,this.mAlige=n}};class i{constructor(){this._currentUI=0,this._currentUI=0,this._listPanels=new t.Queue}show(t,e){let i=[t,e];this._listPanels.enqueue(i),this.checkAlertNext()}empty(){return!(this._currentUI>0||this._listPanels.length>0)}checkAlertNext(){if(this._currentUI>0||this._listPanels.length<=0)return;let t=this._listPanels.dequeue();this.registerEvent(),this._currentUI=t[0],e.Instance.show(t[0],...t[1])}registerEvent(){t.EventCenter.on(t.EventID.UI_CLOSE,this,this.onUIEvent)}unRegisterEvent(){t.EventCenter.off(t.EventID.UI_CLOSE,this,this.onUIEvent)}onUIEvent(e){switch(e.type){case t.EventID.UI_CLOSE:let i=e.get(0);this._currentUI>0&&this._currentUI==i&&(this._currentUI=0,this.unRegisterEvent(),this.checkAlertNext())}}}}(airkit||(airkit={})),function(t){class e{static setGlobalKey(t){this._globalKey=t}static has(t){return null!=cc.sys.localStorage.getItem(this.getFullKey(t))}static getInt(t){return parseInt(cc.sys.localStorage.getItem(this.getFullKey(t)))}static setInt(t,e){cc.sys.localStorage.setItem(this.getFullKey(t),e.toString())}static getFloat(t){return parseInt(cc.sys.localStorage.getItem(this.getFullKey(t)))}static setFloat(t,e){cc.sys.localStorage.setItem(this.getFullKey(t),e.toString())}static getString(t){return cc.sys.localStorage.getItem(this.getFullKey(t))}static setString(t,e){cc.sys.localStorage.setItem(this.getFullKey(t),e)}static remove(t){cc.sys.localStorage.removeItem(this.getFullKey(t))}static clear(){cc.sys.localStorage.clear()}static getFullKey(t){return this._globalKey+"_"+t}}e._globalKey="",t.LocalDB=e}(airkit||(airkit={})),function(t){t.IntervalTimer=class{constructor(){this._nowTime=0}init(t,e){this._intervalTime=t,e&&(this._nowTime=this._intervalTime)}reset(){this._nowTime=0}update(t){return this._nowTime+=t,this._nowTime>=this._intervalTime&&(this._nowTime-=this._intervalTime,!0)}}}(airkit||(airkit={})),function(t){t.Timer=class{static Start(){}static get deltaTimeMS(){return cc.director.getDeltaTime()}static get fixedDeltaTime(){return 0}static get frameCount(){return cc.director.getTotalFrames()}static get timeScale(){return cc.director.getScheduler().getTimeScale()}static set timeScale(t){cc.director.getScheduler().setTimeScale(t)}}}(airkit||(airkit={})),function(t){class e extends t.Singleton{constructor(){super(...arguments),this._idCounter=0,this._removalPending=[],this._timers=[]}static get Instance(){return this.instance||(this.instance=new e),this.instance}setup(){this._idCounter=0}destroy(){t.ArrayUtils.clear(this._removalPending),t.ArrayUtils.clear(this._timers)}update(t){this.remove();for(let i=0;i<this._timers.length;i++)this._timers[i].update(t),0==this._timers[i].isActive&&e.Instance.removeTimer(this._timers[i].id)}addLoop(e,s,r,n,a=null){s<=0&&(s=0);let l=t.ObjectPools.get(i);++this._idCounter,null!=a&&t.ArrayUtils.insert(a,this._idCounter,0);let h=t.Handler.create(r,n,a,!1);return l.set(this._idCounter,e,s,h),this._timers.push(l),l.id}addOnce(e,s,r,n=null){let a=t.ObjectPools.get(i);++this._idCounter,null!=n&&t.ArrayUtils.insert(n,this._idCounter,0);let l=t.Handler.create(s,r,n,!1);return a.set(this._idCounter,e,1,l),this._timers.push(a),a.id}removeTimer(t){this._removalPending.push(t)}remove(){let e;if(this._removalPending.length>0){for(let i of this._removalPending)for(let s=0;s<this._timers.length;s++)if((e=this._timers[s]).id==i){e.clear(),t.ObjectPools.recover(e),this._timers.splice(s,1);break}t.ArrayUtils.clear(this._removalPending)}}}e.TIMER_OBJECT="timerObject",e.instance=null,t.TimerManager=e;class i{constructor(){this.mTime=new t.IntervalTimer}init(){}clear(){null!=this.handle&&(this.handle.recover(),this.handle=null)}set(t,e,i,s){this.id=t,this.mRate=e<0?0:e,this.mTicks=i<0?0:i,this.handle=s,this.mTicksElapsed=0,this.isActive=!0,this.mTime.init(this.mRate,!1)}update(e){this.isActive&&this.mTime.update(t.Timer.deltaTimeMS)&&(null!=this.handle&&this.handle.run(),this.mTicksElapsed++,this.mTicks>0&&this.mTicks==this.mTicksElapsed&&(this.isActive=!1))}}i.objectKey="TimerObject",t.TimerObject=i}(airkit||(airkit={})),function(t){let e;!function(t){t[t.ASCENDING=0]="ASCENDING",t[t.DESCENDING=1]="DESCENDING"}(e=t.eArraySortOrder||(t.eArraySortOrder={}));t.ArrayUtils=class{static insert(t,e,i){i>t.length-1?t.push(e):t.splice(i,0,e)}static isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}static equip(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var i=0,s=t.length;i<s;i++)if(t[i]instanceof Array&&e[i]instanceof Array){if(!t[i].equals(e[i]))return!1}else if(t[i]!=e[i])return!1;return!0}static removeValue(t,e){if(Array.isArray(e))for(let i=t.length-1;i>=0;i--)this.equip(t[i],e)&&t.splice(i,1);else{let i=t.indexOf(e);-1!=i&&t.splice(i,1)}}static removeAllValue(t,e){let i=t.indexOf(e);for(;i>=0;)t.splice(i,1),i=t.indexOf(e)}static containsValue(t,e){return t.length>0&&-1!=t.indexOf(e)}static copy(t){return JSON.parse(JSON.stringify(t))}static sort(t,i,s=e.DESCENDING){null!=t&&t.sort(function(t,r){switch(s){case e.ASCENDING:return t[i]<r[i]?-1:t[i]>r[i]?1:0;case e.DESCENDING:return t[i]>r[i]?-1:t[i]<r[i]?1:0}})}static clear(t){let e=0,i=t.length;for(e=0;e<i;++e)t[e]=null;t.splice(0)}static isEmpty(t){return null==t||0==t.length}}}(airkit||(airkit={})),function(t){class e{constructor(t=null){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,t?(this._u8d_=new Uint8Array(t),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}static getSystemEndian(){if(!e._sysEndian){var t=new ArrayBuffer(2);new DataView(t).setInt16(0,256,!0),e._sysEndian=256===new Int16Array(t)[0]?e.LITTLE_ENDIAN:e.BIG_ENDIAN}return e._sysEndian}get buffer(){var t=this._d_.buffer;return t.byteLength===this._length?t:t.slice(0,this._length)}get endian(){return this._xd_?e.LITTLE_ENDIAN:e.BIG_ENDIAN}set endian(t){this._xd_=t===e.LITTLE_ENDIAN}set length(t){this._allocated_<t?this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,2*this._allocated_))):this._allocated_>t&&this._resizeBuffer(this._allocated_=t),this._length=t}get length(){return this._length}_resizeBuffer(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}}getString(){return this.readString()}readString(){return this._rUTF(this.getUint16())}getFloat32Array(t,e){return this.readFloat32Array(t,e)}readFloat32Array(t,e){var i=t+e;i=i>this._length?this._length:i;var s=new Float32Array(this._d_.buffer.slice(t,i));return this._pos_=i,s}getUint8Array(t,e){return this.readUint8Array(t,e)}readUint8Array(t,e){var i=t+e;i=i>this._length?this._length:i;var s=new Uint8Array(this._d_.buffer.slice(t,i));return this._pos_=i,s}getInt16Array(t,e){return this.readInt16Array(t,e)}readInt16Array(t,e){var i=t+e;i=i>this._length?this._length:i;var s=new Int16Array(this._d_.buffer.slice(t,i));return this._pos_=i,s}getFloat32(){return this.readFloat32()}readFloat32(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,t}getFloat64(){return this.readFloat64()}readFloat64(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,t}writeFloat32(t){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,t,this._xd_),this._pos_+=4}writeFloat64(t){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,t,this._xd_),this._pos_+=8}getInt32(){return this.readInt32()}readInt32(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,t}getUint32(){return this.readUint32()}readUint32(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,t}writeInt32(t){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,t,this._xd_),this._pos_+=4}writeUint32(t){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,t,this._xd_),this._pos_+=4}getInt16(){return this.readInt16()}readInt16(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,t}getUint16(){return this.readUint16()}readUint16(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,t}writeUint16(t){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,t,this._xd_),this._pos_+=2}writeInt16(t){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,t,this._xd_),this._pos_+=2}getUint8(){return this.readUint8()}readUint8(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}writeUint8(t){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,t),this._pos_++}_getUInt8(t){return this._readUInt8(t)}_readUInt8(t){return this._d_.getUint8(t)}_getUint16(t){return this._readUint16(t)}_readUint16(t){return this._d_.getUint16(t,this._xd_)}_rUTF(t){var e,i,s=this._pos_+t,r=String.fromCharCode,n=this._u8d_,a=[],l=0;for(a.length=1e3;this._pos_<s;){if((e=n[this._pos_++])<128)0!=e&&(a[l++]=r(e));else if(e<224)a[l++]=r((63&e)<<6|127&n[this._pos_++]);else if(e<240)i=n[this._pos_++],a[l++]=r((31&e)<<12|(127&i)<<6|127&n[this._pos_++]);else{const t=(15&e)<<18|(127&(i=n[this._pos_++]))<<12|(127&n[this._pos_++])<<6|127&n[this._pos_++];if(t>=65536){const e=t-65536,i=55296|e>>10,s=56320|1023&e;a[l++]=r(i),a[l++]=r(s)}else a[l++]=r(t)}0}return a.length=l,a.join("")}getCustomString(t){return this.readCustomString(t)}readCustomString(t){for(var e,i="",s=0,r=String.fromCharCode,n=this._u8d_;t>0;)if((e=n[this._pos_])<128)i+=r(e),this._pos_++,t--;else for(s=e-128,this._pos_++,t-=s;s>0;)e=n[this._pos_++],i+=r(n[this._pos_++]<<8|e),s--;return i}get pos(){return this._pos_}set pos(t){this._pos_=t}get bytesAvailable(){return this._length-this._pos_}clear(){this._pos_=0,this.length=0}__getBuffer(){return this._d_.buffer}writeUTFBytes(t){for(var e=0,i=(t+="").length;e<i;e++){var s=t.charCodeAt(e);if(s<=127)this.writeByte(s);else if(s<=2047)this._ensureWrite(this._pos_+2),this._u8d_.set([192|s>>6,128|63&s],this._pos_),this._pos_+=2;else if(s>=55296&&s<=56319){e++;const i=t.charCodeAt(e);if(!Number.isNaN(i)&&i>=56320&&i<=57343){const t=64+(1023&s),e=1023&i,r=240|t>>8&63,n=128|t>>2&63,a=128|(3&t)<<4|e>>6&15,l=128|63&e;this._ensureWrite(this._pos_+4),this._u8d_.set([r,n,a,l],this._pos_),this._pos_+=4}}else s<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|s>>12,128|s>>6&63,128|63&s],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s],this._pos_),this._pos_+=4)}}writeUTFString(t){var e=this.pos;this.writeUint16(1),this.writeUTFBytes(t);var i=this.pos-e-2;this._d_.setUint16(e,i,this._xd_)}readUTFString(){return this.readUTFBytes(this.getUint16())}getUTFString(){return this.readUTFString()}readUTFBytes(t=-1){if(0===t)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";return t=t>0?t:e,this._rUTF(t)}getUTFBytes(t=-1){return this.readUTFBytes(t)}writeByte(t){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,t),this._pos_+=1}readByte(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}getByte(){return this.readByte()}_ensureWrite(t){this._length<t&&(this._length=t),this._allocated_<t&&(this.length=t)}writeArrayBuffer(t,e=0,i=0){if(e<0||i<0)throw"writeArrayBuffer error - Out of bounds";0==i&&(i=t.byteLength-e),this._ensureWrite(this._pos_+i);var s=new Uint8Array(t);this._u8d_.set(s.subarray(e,e+i),this._pos_),this._pos_+=i}readArrayBuffer(t){var e;return e=this._u8d_.buffer.slice(this._pos_,this._pos_+t),this._pos_=this._pos_+t,e}}e.BIG_ENDIAN="bigEndian",e.LITTLE_ENDIAN="littleEndian",e._sysEndian=null,t.Byte=e}(airkit||(airkit={})),function(t){function e(e,i){var s=new t.Byte(e);return s.endian=i,s.getUint8Array(s.pos,s.length-s.pos)}function i(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e}t.bytes2Uint8Array=e,t.bytes2String=function(t,s){return i(e(t,s))},t.string2ArrayBuffer=function(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),s=0;s<t.length;++s)i[s]=t.charCodeAt(s);return e},t.string2Uint8Array=function(t){for(var e=[],i=0,s=t.length;i<s;++i)e.push(t.charCodeAt(i));return new Uint8Array(e)},t.uint8Array2String=i}(airkit||(airkit={})),function(t){class e{static regClass(t,i){e._classMap[t]=i}static regShortClassName(t){for(var i=0;i<t.length;i++){var s=t[i],r=s.name;e._classMap[r]=s}}static getRegClass(t){return e._classMap[t]}static getClass(t){return e._classMap[t]||e._classMap["cc."+t]||t}static getInstance(t){var i=e.getClass(t);return i?new i:(console.warn("[error] Undefined class:",t),null)}static copyObject(t){let e=JSON.stringify(t);return JSON.parse(e)}static getObjectValue(t,e,i){return t[e]?t[e]:i}static callFunc(e,i,s=null){if(null==i)return;var r=e[i];let n=null;return r?n=null==s?r.apply(e):r.apply(e,s):t.Log.error("cant find funcName {0} from Module:{1}",i,e.name),n}static classKey(t){return Object.getPrototypeOf(t).constructor.objectKey}}e._classMap={},t.ClassUtils=e}(airkit||(airkit={})),function(t){class e{static setServerTime(t){this.serverTime=t,this.serverTimeDiff=Date.now()-t}static getNow(){return Math.floor((Date.now()-this.serverTimeDiff)/1e3)}static getNowMS(){return Date.now()-this.serverTimeDiff}static isTheSameMonth(t,i){let s=e.getNow(),r=new Date(1e3*(s-i)),n=new Date(r.getFullYear(),r.getMonth(),1);return t>=Math.floor(n.getTime()/1e3)+i}static isTheSameDayByNow(t,i){let s=60*(new Date).getTimezoneOffset(),r=(t-s-i)/86400,n=(e.getNow()-s-i)/86400;return Math.floor(r)===Math.floor(n)}static passedDays(t,e,i=0){let s=60*(new Date).getTimezoneOffset(),r=(t-s-i)/86400,n=(e-s-i)/86400;return Math.floor(n)-Math.floor(r)}static currentYMDHMS(){return this.formatDateTime(this.getNowMS())}static currentHour(){return new Date(this.getNowMS()).getHours()}static formatDateTime(t){var e=new Date(t),i=e.getFullYear(),s=e.getMonth()+1,r=s<10?"0"+s:s,n=e.getDate(),a=n<10?"0"+n:n,l=e.getHours(),h=l<10?"0"+l:l,o=e.getMinutes(),c=e.getSeconds();return i+"-"+r+"-"+a+" "+h+":"+(o<10?"0"+o:o)+":"+(c<10?"0"+c:c)}static countdown(t,e="D天H时M分S秒"){let i=Math.max(0,t/1e3),s=Math.floor(i/24/3600),r=Math.floor(i/3600%24),n=Math.floor(i/60%60);i=Math.floor(i%60);let a=e.replace(/D/,s.toString());return a=(a=(a=a.replace(/H/,r.toString())).replace(/M/,n.toString())).replace(/S/,i.toString())}static formatTime(e,i="{0}:{1}:{2}"){let s=Math.max(0,e),r=Math.floor(s/3600%24),n=Math.floor(s/60%60);return s=Math.floor(s%60),t.StringUtils.format(i,r<10?"0"+r:r,n<10?"0"+n:n,s<10?"0"+s:s)}static format2Time(e){let i="{0}:{1}",s=Math.max(0,e),r=Math.floor(s/24/3600);if(r>0)return t.StringUtils.format("{0}天",r);let n=Math.floor(s/3600%24),a=Math.floor(s/60%60),l=a<10?"0"+a:a,h=n<10?"0"+n:n,o=(s=Math.floor(s%60))<10?"0"+s:s;return n>0?t.StringUtils.format(i,h,l):(i=i.replace(":","’"),t.StringUtils.format(i,l,o))}static format2Time2(e){let i="{0}:{1}",s=Math.max(0,e),r=Math.floor(s/24/3600);if(r>0)return t.StringUtils.format("{0}天",r);let n=Math.floor(s/3600%24),a=Math.floor(s/60%60),l=a<10?"0"+a:a,h=n<10?"0"+n:n,o=(s=Math.floor(s%60))<10?"0"+s:s;return n>0?t.StringUtils.format(i,h,l):(i=i.replace(":","’"),t.StringUtils.format(i,l,o))}}e.serverTimeDiff=0,e.serverTime=0,t.DateUtils=e}(airkit||(airkit={})),function(t){class e{static getKeys(t){let e=[];for(let i in t)e.push(i);return e}static getValues(t){let e=[];for(let i in t)e.push(t[i]);return e}static clearDic(t){let i;for(let s in t)(i=t[s])instanceof Object&&e.clearDic(i),delete t[s]}static foreach(t,e){for(let i in t)if(!e.call(null,i,t[i]))break}static isEmpty(t){if(null==t)return!0;for(let e in t)return!1;return!0}static getLength(t){if(null==t)return 0;let e=0;for(let i in t)++e;return e}static assign(t,e){Object.assign(t,e)}}t.DicUtils=e}(airkit||(airkit={})),function(t){function e(){return cc.director.getWinSize().width}function i(){return cc.director.getWinSize().height}t.displayWidth=e,t.displayHeight=i;t.DisplayUtils=class{static removeAllChild(t){if(t&&!(t.numChildren<=0))for(;t.numChildren>0;){let e=t.removeChildAt(0);if(e){let t=e.constructor;if("Animation"==t.name){let t=e;t.clear(),t.destroy(!0),t=null}else e.removeFromParent(),e.dispose();t=null}e=null}}static colorBG(t,e,i){let s=new fgui.GGraph;return s.drawRect(1,t,t),s.setSize(e,i),s.alpha=.7,s}static popupDown(s,r,n){s.scale(.8,.8);let a=e()>>1,l=i()>>1;null!=n&&n?(a=s.x,l=s.y):(s.anchorX=.5,s.anchorY=.5),s.pos(a,0),t.TweenUtils.get(s).to({scaleX:1,scaleY:1,x:a,y:l},500,fgui.EaseType.BackOut,r),s.parent&&s.parent.bg&&(s.parent.bg.alpha=0,t.TweenUtils.get(s.parent.bg).to({alpha:1},500,fgui.EaseType.QuadOut))}static popup(s,r,n){s.setScale(.85,.85);let a=e()>>1,l=i()>>1;if(null!=n&&n?(a=s.x,l=s.y):s.setPivot(.5,.5,!0),s.setPosition(a,l),t.TweenUtils.get(s).to({scaleX:1,scaleY:1},.25,fgui.EaseType.QuadOut,r),s.parent&&s.parent.getChild("bg")){let e=s.parent.getChild("bg");e.alpha=0,t.TweenUtils.get(e).to({alpha:1},.25,fgui.EaseType.QuadOut)}}static hide(e,i){let s=e.panel(),r=e.bg();null==s?i&&i.run():(t.TweenUtils.get(s).to({scaleX:.5,scaleY:.5},.2,fgui.EaseType.BackIn,i),r&&t.TweenUtils.get(r).to({alpha:0},.2,fgui.EaseType.QuadOut))}}}(airkit||(airkit={})),function(t){class e{constructor(t=null,e=null,i=null,s=!1){this.once=!1,this._id=0,this.setTo(t,e,i,s)}setTo(t,i,s,r=!1){return this._id=e._gid++,this.caller=t,this.method=i,this.args=s,this.once=r,this}run(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e}runWith(t){if(null==this.method)return null;var e=this._id;if(null==t)var i=this.method.apply(this.caller,this.args);else i=this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===e&&this.once&&this.recover(),i}clear(){return this.caller=null,this.method=null,this.args=null,this}recover(){this._id>0&&(this._id=0,e._pool.push(this.clear()))}static create(t,i,s=null,r=!0){return e._pool.length?e._pool.pop().setTo(t,i,s,r):new e(t,i,s,r)}}e._pool=[],e._gid=1,t.Handler=e}(airkit||(airkit={})),function(t){let e;!function(t){t[t.Line=3]="Line",t[t.Curve=2]="Curve"}(e=t.OrbitType||(t.OrbitType={}));class i{static sign(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1}static clamp(t,e,i){if(e>i){let t=e;e=i,i=t}return t<e?e:t>i?i:t}static clamp01(t){return t<0?0:t>1?1:t}static lerp(t,e,s){return t+(e-t)*i.clamp01(s)}static lerpAngle(t,e,s){let r=i.repeat(e-t,360);return r>180&&(r-=360),t+r*i.clamp01(s)}static repeat(t,e){return t-Math.floor(t/e)*e}static randRange(t,e){return Math.random()*(e-t)+t}static randRange_Int(t,e){let i=Math.random()*(e-t+1)+t;return Math.floor(i)}static randRange_Array(t){if(0==t.length)return null;return t[i.randRange_Int(0,t.length-1)]}static clampDegrees(t){for(;t<0;)t+=360;for(;t>=360;)t-=360;return t}static clampRadians(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}static getDistance(t,e,i,s){return Math.sqrt(Math.pow(s-e,2)+Math.pow(i-t,2))}static getSquareDistance(t,e,i,s){return Math.pow(s-e,2)+Math.pow(i-t,2)}static getLineRadians(t,e,i,s){return Math.atan2(s-e,i-t)}static getLineDegree(t,e,s,r){let n=i.toDegree(i.getLineRadians(t,e,s,r));return i.clampDegrees(n)}static getPointRadians(t,e){return Math.atan2(e,t)}static getPointDegree(t,e){let s=i.toDegree(i.getPointRadians(t,e));return i.clampDegrees(s)}static toDegree(t){return t*(180/Math.PI)}static toRadian(t){return t*(Math.PI/180)}static moveTowards(t,e,s){return Math.abs(e-t)<=s?e:t+i.sign(e-t)*s}static radians4point(t,e,i,s){return Math.atan2(e-s,i-t)}static pointAtCircle(t,e,i,s){return new cc.Vec2(t+Math.cos(i)*s,e-Math.sin(i)*s)}static getPos(t,i,s){if(0==t.length)return null;if(1==t.length)return t[0];i=Math.min(i,1);let r=new cc.Vec2,n=t.length;if(s==e.Line){let e=1/(n-1),s=Math.floor(i/e);if(s+1<n){let n=t[s],a=t[s+1],l=(i-s*e)/e;r.x=n.x+(a.x-n.x)*l,r.y=n.y+(a.y-n.y)*l}else r.x=t[t.length-1].x,r.y=t[t.length-1].y}else s==e.Curve&&(r=this.getBezierat(t,i));return r}static getRotation(t,e,i,s){let r=i-t,n=s-e,a=180*Math.atan(n/r)/Math.PI;return a+=r>=0?90:270}static getBezierat(t,e){let i=new cc.Vec2;return 3==t.length?(i.x=Math.pow(1-e,2)*t[0].x+2*e*(1-e)*t[1].x+Math.pow(e,2)*t[2].x,i.y=Math.pow(1-e,2)*t[0].y+2*e*(1-e)*t[1].y+Math.pow(e,2)*t[2].y):4==t.length&&(i.x=Math.pow(1-e,3)*t[0].x+3*e*Math.pow(1-e,2)*t[1].x+3*Math.pow(e,2)*(1-e)*t[2].x+Math.pow(e,3)*t[3].x,i.y=Math.pow(1-e,3)*t[0].y+3*e*Math.pow(1-e,2)*t[1].y+3*Math.pow(e,2)*(1-e)*t[2].y+Math.pow(e,3)*t[3].y),i}static getDirection(t){let e=new cc.Vec2;if(0==t||180==t)e.x=0,e.y=0==t?-1:1;else if(90==t||270==t)e.y=0,e.x=90==t?1:-1;else{let i=Math.floor(t/90),s=(90-t)*Math.PI/180;e.x=0==i||1==i?1:-1,e.y=1==i||2==i?Math.abs(Math.tan(s)):-Math.abs(Math.tan(s)),e=this.normalize(e)}return e}static normalize(t){let e=t.y/t.x,i=Math.sqrt(1/(e*e+1)),s=Math.abs(e*i);return t.x=t.x>0?i:-i,t.y=t.y>0?s:-s,t}static distance(t,e,i,s){return Math.sqrt((i-t)*(i-t)+(s-e)*(s-e))}static getVerticalVector(t,e,i){let s=new cc.Vec2;s.x=e.x-t.x,s.y=e.y-t.y,s.normalize();let r=new cc.Vec2;r.x=1,r.y=-s.x/s.y;let n=new cc.Vec2;return n.x=(t.x+e.x)/2+r.x*i,n.y=(t.y+e.y)/2+r.y*i,n}static getCtrlPoint(t,e,i=100,s=50,r=50){let n=this.getVerticalVector(t,e,i);return n.x+=s,n.y+=r,n}static getDefaultPoints(e,i,s=150,r=150,n=150){return e.x>t.displayWidth()/2&&(s=-s),e.y>i.y&&(r=-r),[e,this.getCtrlPoint(e,i,n,s,r),i]}}i.BYTE_TO_M=1/1048576,i.BYTE_TO_K=1/1024,i.Deg2Rad=.01745329,i.Rad2Deg=57.29578,i.Cycle8Points=[[-200,0],[-127,-74],[0,-100],[127,-74],[200,0],[127,74],[0,100],[-127,74]],i.Cycle9Points=[[0,0],[-200,0],[-127,-74],[0,-100],[127,-74],[200,0],[127,74],[0,100],[-127,74]],t.MathUtils=i}(airkit||(airkit={})),function(t){t.NumberUtils=class{static toFixed(e,i){return t.StringUtils.toNumber(e.toFixed(i))}static toInt(t){return Math.floor(t)}static isInt(t){return Math.ceil(t)==t}static reserveNumber(e,i){let s=String(e),r=s.length,n=s.indexOf(".");if(n<0)return e;let a=s.slice(0,n+1),l=r-n;l>i&&(l=i);let h=s.slice(n+1,n+1+l);return t.StringUtils.toNumber(a+h)}static reserveNumberWithZero(t,e){let i=String(t),s=i.length,r=i.indexOf(".");if(r<0){i+=".";for(let t=0;t<e;++t)i+="0";return i}let n=i.slice(0,r+1),a=s-r-1;if(a>e)return a=e,n+i.slice(r+1,r+1+a);if(a<e){let t=e-a;for(let e=0;e<t;++e)i+="0";return i}return i}}}(airkit||(airkit={})),function(t){class e{static get empty(){return""}static isNullOrEmpty(t){return!(null!=t&&t.length>0)}static toInt(t){return t&&0!=t.length?parseInt(t):0}static toNumber(t){return t&&0!=t.length?parseFloat(t):0}static stringCut(t,e,i="..."){var s=t;return t.length>e&&(s=t.substr(0,e)+i),s}static getNumBytes(t){let e=0,i=t.length,s=-1;for(var r=0;r<i;r++)e+=(s=t.charCodeAt(r))>=0&&s<=128?1:2;return e}static addZero(t,e,i=0){let s="",r=t.length,n="",a="";if(0==i?a="0":n="0",r<e){let i=0;for(;i<e-r;)s=n+s+a,++i;return s+t}return t}static isString(t){return"[object String]"===Object.prototype.toString.call(t)}static trim(t){return null==t?"":t.replace(/^\s+|\s+$""^\s+|\s+$/g,"")}static trimLeft(t){return null==t?"":t.replace(/^\s+""^\s+/,"")}static trimRight(t){return null==t?"":t.replace(/\s+$""\s+$/,"")}static minuteFormat(t){let e=Math.floor(t/60),i=Math.floor(t%60);return(e<10?"0"+e.toString():e.toString())+":"+(i<10?"0"+i.toString():i.toString())}static hourFormat(t){let i=Math.floor(t/3600);return(i<10?"0"+i.toString():i.toString())+":"+e.minuteFormat(t%3600)}static format(t,...e){for(let i=0;i<e.length;i++)t=t.replace(new RegExp("\\{"+i+"\\}","gm"),e[i]);return t}static formatWithDic(t,e){for(let i in e)t=t.replace(new RegExp("\\{"+i+"\\}","gm"),e[i]);return t}static beginsWith(t,e){return e==t.substring(0,e.length)}static endsWith(t,e){return e==t.substring(t.length-e.length)}static getGUIDString(){let t=Date.now();return window.performance&&"function"==typeof window.performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)})}}t.StringUtils=e}(airkit||(airkit={})),function(t){t.TouchUtils=class{}}(airkit||(airkit={})),function(t){class e{constructor(t){this._target=t,this.clear()}static get(t){return new e(t)}get target(){return this._target}setOnUpdate(t){this._updateFunc=t}onUpdate(t){this._updateFunc&&this._updateFunc(t)}to(t,e,i=fgui.EaseType.QuadOut,s=null,r=0){return this._steps.push({props:t,duration:e,ease:i,complete:s,delay:r}),this.trigger(),this}delay(t){return this._steps.push({delay:t}),this}trigger(){if(!this._isPlaying&&this._steps&&this._steps.length){var e=this._steps.shift();if(e.hasOwnProperty("props")){if(this._isPlaying=!0,null!=e.props.x||null!=e.props.y){let t=null!=e.props.x?e.props.x:this._target.x,i=null!=e.props.y?e.props.y:this._target.y;fgui.GTween.to2(this._target.x,this._target.y,t,i,e.duration).setTarget(this._target,this._target.setPosition).setEase(e.ease)}if(null!=e.props.scaleX||null!=e.props.scaleY){let t=null!=e.props.scaleX?e.props.scaleX:this._target.scaleX,i=null!=e.props.scaleY?e.props.scaleY:this._target.scaleY;fgui.GTween.to2(this._target.scaleX,this._target.scaleY,t,i,e.duration).setTarget(this._target,this._target.setScale).setEase(e.ease)}if(null!=e.props.rotation){let t=null!=e.props.rotation?e.props.rotation:this._target.rotation;fgui.GTween.to(this._target.rotation,t,e.duration).setTarget(this._target,"rotation").setEase(e.ease)}null!=e.props.alpha&&(e.props.pts?fgui.GTween.to(this._target.alpha,e.props.alpha,e.duration).setTarget(this._target,"alpha").setEase(e.ease).onUpdate(i=>{let s=t.MathUtils.getPos(e.props.pts,i.normalizedTime,t.OrbitType.Curve);this._target.setPosition(s.x,s.y),this.onUpdate(i)},null):fgui.GTween.to(this._target.alpha,e.props.alpha,e.duration).setTarget(this._target,"alpha").setEase(e.ease).onUpdate(t=>{this.onUpdate(t)},null)),t.TimerManager.Instance.addOnce(1e3*(e.duration+e.delay),this,this.onStepComplete,[e.complete])}else e.hasOwnProperty("delay")&&(this._isPlaying=!0,t.TimerManager.Instance.addOnce(1e3*e.delay,this,this.onStepComplete,[e.complete]))}}onStepComplete(t){t&&t.runWith(),this._isPlaying=!1,this.trigger()}clear(){this._steps=[],this._isPlaying=!1,fgui.GTween.kill(this._target)}static scale(t){this.get(t).to({scaleX:.8,scaleY:.8},.05,fgui.EaseType.QuadIn).to({scaleX:1,scaleY:1},.05,fgui.EaseType.QuadIn)}static appear(t){t.setScale(0,0),this.get(t).to({scaleX:1.2,scaleY:1.2},.4,fgui.EaseType.QuadOut).to({scaleX:1,scaleY:1},.2,fgui.EaseType.QuadOut)}}e.EaseBezier=9999,t.TweenUtils=e}(airkit||(airkit={})),function(t){t.UrlUtils=class{static getFileExte(e){if(t.StringUtils.isNullOrEmpty(e))return t.StringUtils.empty;let i=e.lastIndexOf(".");return i>=0?e.substr(i+1):t.StringUtils.empty}static getPathWithNoExtend(e){if(t.StringUtils.isNullOrEmpty(e))return t.StringUtils.empty;let i=e.lastIndexOf(".");return i>=0?e.substr(0,i):t.StringUtils.empty}}}(airkit||(airkit={})),function(t){class e{static openURL(t){window.location.href=t}static getLocationParams(){let e=window.location.href,i=new t.SDictionary,s=e.indexOf("?");if(s>=0){let t,r,n=(e=e.substr(s+1)).split("&");for(let e in n){let a=n[e];s=a.indexOf("="),t=a.substr(0,s),r=a.substr(s+1),i.add(t,r)}}return i}static obj2query(t){if(!t)return"";var e=[];for(var i in t)e.push(i+"="+t[i]);return e.join("&")}static injectProp(t,e=null,i=null,s=!0,r=!0,n=""){if(!e)return!1;for(let n in e){let a=e[n];s&&"function"==typeof a||r&&null==a||(i?i(t,n,a):t[n]=a)}return!0}}e.parseXMLFromString=function(t){var e;if(t=t.replace(/>\s+</g,"><"),(e=(new DOMParser).parseFromString(t,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors")>-1)throw new Error(e.firstChild.firstChild.textContent);return e},t.Utils=e;function i(t,e){if(!t)throw e||"assert"}function s(t){return null==t||(null===t||void 0===t)}t.FlagUtils=class{static hasFlag(e,i){return 0!=((e=t.NumberUtils.toInt(e))&(i=t.NumberUtils.toInt(i)))}static insertFlag(e,i){return e=t.NumberUtils.toInt(e),e|=i=t.NumberUtils.toInt(i)}static removeFlag(e,i){return e=t.NumberUtils.toInt(e),e^=i=t.NumberUtils.toInt(i)}},t.assert=i,t.assertNullOrNil=function(t,e){null!=t&&null!=t||i(!1,e)},t.checkNullOrNil=s,t.checkEmptyDic=function(t){return!!s(t)||"{}"==JSON.stringify(t)}}(airkit||(airkit={})),function(t){class e{static unzip(i){return new Promise((s,r)=>{let n={};e.parseZip(i).then(i=>{let a=i.jszip,l=i.filelist;if(a&&l){let h=0;for(let o=0;o<l.length;o++)e.parseZipFile(a,l[o]).then(t=>{h++,n[l[o]]=t,h==l.length&&(i=null,a=null,l=null,s(n))}).catch(e=>{t.Log.error(e),r(e)})}}).catch(e=>{t.Log.error(e),r(e)})})}static parseZip(e){return new Promise((i,s)=>{new t.SDictionary;let r=new Array;window.JSZip.loadAsync(e).then(t=>{for(var e in t.files)r.push(e);i({jszip:t,filelist:r})}).catch(e=>{t.Log.error(e)})})}static parseZipFile(e,i){return new Promise((s,r)=>{e.file(i).async("text").then(t=>{s(t)}).catch(e=>{r(e),t.Log.error(e)})})}}t.ZipUtils=e}(airkit||(airkit={}));