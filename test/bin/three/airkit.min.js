window.airkit={},window.__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),function(t){var e=function(){function e(){var n=this.constructor;if(n){if(-1!=e.classKeys.indexOf(n))throw new Error(this+" 只允许实例化一次！");e.classKeys.push(n),e.classValues.push(this)}else t.Log.warning("浏览器不支持读取构造函数")}return e.classKeys=[],e.classValues=[],e}();t.Singleton=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._isStopGame=!1,n._mainloopHandle=null,t.Timer.Start(),n}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.prototype.setup=function(e,n,r,i,o,s){void 0===n&&(n=t.LogLevel.INFO),void 0===r&&(r=750),void 0===i&&(i=1334),void 0===o&&(o=""),void 0===s&&(s=1),this.printDeviceInfo(),this._lastTimeMS=t.DateUtils.getNowMS(),this._isStopGame=!1,cc.view.setResizeCallback(function(){t.EventCenter.dispatchEvent(t.EventID.RESIZE)}),t.Log.LEVEL=n,cc.director.getScheduler().scheduleUpdate(this,0,!1),t.LayerManager.setup(e),t.TimerManager.Instance.setup(),t.UIManager.Instance.setup(),t.ResourceManager.Instance.setup(),t.DataProvider.Instance.setup(),t.LangManager.Instance.init(),t.SceneManager.Instance.setup(),t.Mediator.Instance.setup(),t.LoaderManager.Instance.setup()},n.prototype.destroy=function(){t.Mediator.Instance.destroy(),t.LoaderManager.Instance.destroy(),t.TimerManager.Instance.destroy(),t.UIManager.Instance.destroy(),t.SceneManager.Instance.destroy(),t.ResourceManager.Instance.destroy(),t.DataProvider.Instance.destroy(),t.LayerManager.destroy(),t.LangManager.Instance.destory()},n.prototype.update=function(e){if(!this._isStopGame){var n=t.DateUtils.getNowMS(),r=n-this._lastTimeMS;this._lastTimeMS=n,this.preTick(r),this.tick(r),this.endTick(r)}},n.prototype.preTick=function(e){t.TimerManager.Instance.update(e),t.UIManager.Instance.update(e),t.ResourceManager.Instance.update(e),t.Mediator.Instance.update(e),t.SceneManager.Instance.update(e)},n.prototype.tick=function(t){this._mainloopHandle&&this._mainloopHandle.runWith([t])},n.prototype.endTick=function(t){},n.prototype.pauseGame=function(){this._isStopGame=!0,t.EventCenter.dispatchEvent(t.EventID.STOP_GAME,!0)},n.prototype.resumeGame=function(){this._isStopGame=!1,t.EventCenter.dispatchEvent(t.EventID.STOP_GAME,!1)},Object.defineProperty(n.prototype,"isStopGame",{get:function(){return this._isStopGame},enumerable:!0,configurable:!0}),n.prototype.printDeviceInfo=function(){if(navigator){var e=navigator.userAgent,n=e.indexOf("("),r=e.indexOf(")");if(n<0||r<0||r<n)return;var i=e.substring(n+1,r);t.Log.info(i);var o=void 0,s=void 0,a=void 0,u=i.split(";");if(3==u.length){o=u[2];var l=u[1].split(" ");l.length>=2&&(s=l[1],a=l[2])}else 2==u.length?(s=u[0],o=u[0],a=u[1]):(s=navigator.platform,o=navigator.platform,a=i);t.Log.info("{0},{1},{2}",s,o,a)}},n.instance=null,n}(t.Singleton);t.Framework=e}(airkit||(airkit={})),function(t){var e=function(){function e(t,e,n,r){this.r=t,this.g=e,this.b=n,this.a=r}return e.prototype.set=function(t,e,n,r){this.r=t,this.g=e,this.b=n,this.a=r},e.add=function(t,n){return new e(t.r+n.r,t.g+n.g,t.b+n.b,t.a+n.a)},e.prototype.add=function(t){return this.set(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a),this},e.sub=function(t,n){return new e(t.r-n.r,t.g-n.g,t.b-n.b,t.a-n.a)},e.prototype.sub=function(t){return this.set(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a),this},e.mul=function(t,n){return new e(t.r*n,t.g*n,t.b*n,t.a*n)},e.prototype.mul=function(t){return this.set(this.r*t,this.g*t,this.b*t,this.a*t),this},e.div=function(t,n){return new e(t.r/n,t.g/n,t.b/n,t.a/n)},e.prototype.div=function(t){return this.set(this.r/t,this.g/t,this.b/t,this.a/t),this},e.prototype.equals=function(t){return this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a},e.lerp=function(n,r,i){return i=t.MathUtils.clamp(i,0,1),new e(n.r+(r.r-n.r)*i,n.g+(r.g-n.g)*i,n.b+(r.b-n.b)*i+(r.a-n.a)*i)},Object.defineProperty(e,"zero",{get:function(){return new e(0,0,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"one",{get:function(){return new e(1,1,1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"red",{get:function(){return new e(1,0,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"green",{get:function(){return new e(0,1,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"blue",{get:function(){return new e(0,0,1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"white",{get:function(){return new e(1,1,1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"black",{get:function(){return new e(0,0,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"yellow",{get:function(){return new e(1,.9215686,.01568628,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cyan",{get:function(){return new e(0,1,1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"magenta",{get:function(){return new e(1,0,1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"gray",{get:function(){return new e(.5,.5,.5,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"grey",{get:function(){return new e(.5,.5,.5,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clear",{get:function(){return new e(0,0,0,0)},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return t.StringUtils.format("({0}, {1}, {2}, {3})",this.r,this.g,this.b,this.a)},e}();t.Color=e}(airkit||(airkit={})),function(t){var e=function(){function e(){this._dic={}}return e.prototype.add=function(e,n){return this.containsKey(e)?(t.Log.warning("NDictionary already containsKey ",e.toString()),!1):(this._dic[e]=n,!0)},e.prototype.remove=function(t){delete this._dic[t]},e.prototype.set=function(t,e){this._dic[t]=e},e.prototype.containsKey=function(t){return null!=this._dic[t]},e.prototype.getValue=function(t){return this.containsKey(t)?this._dic[t]:null},e.prototype.clear=function(){for(var t in this._dic)delete this._dic[t]},e.prototype.getkeys=function(){var e=[];for(var n in this._dic)e.push(t.StringUtils.toNumber(n));return e},e.prototype.getValues=function(){var t=[];for(var e in this._dic)t.push(this._dic[e]);return t},e.prototype.foreach=function(t){for(var e in this._dic)if(!t.call(null,e,this._dic[e]))break},Object.defineProperty(e.prototype,"length",{get:function(){return t.DicUtils.getLength(this._dic)},enumerable:!0,configurable:!0}),e}();t.NDictionary=e;var n=function(){function e(){this._dic={}}return e.prototype.add=function(t,e){return!this.containsKey(t)&&(this._dic[t]=e,!0)},e.prototype.set=function(t,e){this._dic[t]=e},e.prototype.remove=function(t){delete this._dic[t]},e.prototype.containsKey=function(t){return null!=this._dic[t]},e.prototype.getValue=function(t){return this.containsKey(t)?this._dic[t]:null},e.prototype.getkeys=function(){var t=[];for(var e in this._dic)t.push(e);return t},e.prototype.getValues=function(){var t=[];for(var e in this._dic)t.push(this._dic[e]);return t},e.prototype.clear=function(){for(var t in this._dic)delete this._dic[t]},e.prototype.foreach=function(t){for(var e in this._dic)if(!t.call(null,e,this._dic[e]))break},Object.defineProperty(e.prototype,"length",{get:function(){return t.DicUtils.getLength(this._dic)},enumerable:!0,configurable:!0}),e}();t.SDictionary=n}(airkit||(airkit={})),function(t){var e=function(){function e(t,e,n){if(this._array=[],t>0&&e>0)for(var r=0;r<t;++r)for(var i=0;i<e;++i)this.set(r,i,n)}return e.prototype.set=function(t,e,n){this._array[t]||(this._array[t]=[]),this._array[t][e]=n},e.prototype.get=function(t,e){return this._array[t]?this._array[t][e]:null},e.prototype.clear=function(){t.ArrayUtils.clear(this._array)},e}();t.DoubleArray=e}(airkit||(airkit={})),function(t){var e=function(){function e(){this._linkHead=null,this._size=0,this._linkHead={Data:null,Prev:null,Next:null},this._linkHead.Prev=this._linkHead,this._linkHead.Next=this._linkHead,this._size=0}return e.prototype.add=function(t){this.append(this._size,t)},e.prototype.insert=function(e,n){if((this._size<1||e>=this._size)&&t.Log.exception("没有可插入的点或者索引溢出了"),0==e)this.append(this._size,n);else{var r=this.getNode(e),i={Data:n,Prev:r.Prev,Next:r};r.Prev.Next=i,r.Prev=i,this._size++}},e.prototype.append=function(e,n){var r;0==e?r=this._linkHead:((e-=1)<0&&t.Log.exception("位置不存在"),r=this.getNode(e));var i={Data:n,Prev:r,Next:r.Next};r.Next.Prev=i,r.Next=i,this._size++},e.prototype.del=function(t){var e=this.getNode(t);e.Prev.Next=e.Next,e.Next.Prev=e.Prev,this._size--},e.prototype.delFirst=function(){this.del(0)},e.prototype.delLast=function(){this.del(this._size-1)},e.prototype.get=function(t){return this.getNode(t).Data},e.prototype.getFirst=function(){return this.getNode(0).Data},e.prototype.getLast=function(){return this.getNode(this._size-1).Data},e.prototype.getNode=function(e){if((e<0||e>=this._size)&&t.Log.exception("索引溢出或者链表为空"),e<this._size/2){for(var n=this._linkHead.Next,r=0;r<e;r++)n=n.Next;return n}var i=this._linkHead.Prev,o=this._size-e-1;for(r=0;r<o;r++)i=i.Prev;return i},e.prototype.foreach=function(t){var e=this._linkHead.Next;if(e)do{if(!t.call(null,e.Data))break;e=e.Next}while(e!=this._linkHead)},e.prototype.isEmpty=function(){return 0==this._size},Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!0,configurable:!0}),e}();t.LinkList=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.get=function(e){var n=e.objectKey;null==n&&t.Log.error("static objectKey must set in {0} ",e.name);var r=this.poolsMap[n];null==r&&(r=new Array,this.poolsMap[n]=r);var i=r.pop();return null==i&&(i=new e),i&&i.init&&i.init(),i},e.recover=function(t){if(t)if(null!=t.parent&&t.removeFromParent(),t.dispose&&null==t.displayObject)t.dispose();else{var e=Object.getPrototypeOf(t).constructor.objectKey,n=this.poolsMap[e];null!=n&&(null!==t.visible&&!1===t.visible&&(t.visible=!0),n.push(t))}},e.clearAll=function(){var e=this;t.DicUtils.foreach(this.poolsMap,function(t,n){return e.clear(t),!0})},e.clear=function(e){var n=this.poolsMap[e];for(t.Log.info("max object count {0}",n.length);n.length>0;){var r=n.pop();r&&r.dispose&&(null!=r.parent?r.removeFromParent():null!=r.displayObject.parent&&r.displayObject.removeFromParent(),r.dispose())}},e.poolsMap={},e}();t.ObjectPools=e}(airkit||(airkit={})),function(t){var e=function(){function t(){this._list=[]}return t.prototype.enqueue=function(t){this._list.push(t)},t.prototype.dequeue=function(){return this._list.shift()},t.prototype.peek=function(){return 0==this._list.length?null:this._list[0]},t.prototype.seek=function(t){return this._list.length<t?null:this._list[t]},t.prototype.toArray=function(){return this._list.slice(0,this._list.length)},t.prototype.contains=function(t){return-1!=this._list.indexOf(t,0)},t.prototype.clear=function(){this._list.length=0},Object.defineProperty(t.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),t.prototype.foreach=function(t){for(var e=0,n=this._list;e<n.length;e++){var r=n[e];if(!t.call(null,r))break}},t}();t.Queue=e}(airkit||(airkit={})),function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e}return t.prototype.set=function(t,e){this._width=t,this._height=e},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t}();t.Size=e}(airkit||(airkit={})),function(t){var e=function(){function t(){this._list=[]}return t.prototype.push=function(t){this._list.push(t)},t.prototype.pop=function(){return this._list.pop()},t.prototype.peek=function(){return 0==this._list.length?null:this._list[this._list.length-1]},t.prototype.toArray=function(){return this._list.slice(0,this._list.length)},t.prototype.contains=function(t){return-1!=this._list.indexOf(t,0)},t.prototype.clear=function(){this._list.length=0},Object.defineProperty(t.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),t.prototype.foreach=function(t){for(var e=0,n=this._list;e<n.length;e++){var r=n[e];if(!t.call(null,r))break}},t}();t.Stack=e}(airkit||(airkit={})),function(t){t.LOADVIEW_TYPE_NONE=0,function(t){t[t.POPUP=1]="POPUP",t[t.ALERT=2]="ALERT"}(t.eUIQueueType||(t.eUIQueueType={})),t.ePopupAnim||(t.ePopupAnim={}),function(t){t[t.CLOSE_CENTER=1]="CLOSE_CENTER"}(t.eCloseAnim||(t.eCloseAnim={})),function(t){t[t.NONE=0]="NONE",t[t.RIGHT=1]="RIGHT",t[t.RIGHT_BOTTOM=2]="RIGHT_BOTTOM",t[t.BOTTOM=3]="BOTTOM",t[t.LEFT_BOTTOM=4]="LEFT_BOTTOM",t[t.LEFT=5]="LEFT",t[t.LEFT_TOP=6]="LEFT_TOP",t[t.TOP=7]="TOP",t[t.RIGHT_TOP=8]="RIGHT_TOP",t[t.MID=9]="MID"}(t.eAligeType||(t.eAligeType={})),function(t){t[t.BG=0]="BG",t[t.MAIN=1]="MAIN",t[t.GUI=2]="GUI",t[t.POPUP=3]="POPUP",t[t.TOOLTIP=4]="TOOLTIP",t[t.SYSTEM=5]="SYSTEM",t[t.LOADING=6]="LOADING",t[t.TOP=7]="TOP",t[t.MAX=8]="MAX"}(t.eUILayer||(t.eUILayer={})),function(t){t[t.DEBUG=7]="DEBUG",t[t.INFO=6]="INFO",t[t.WARNING=5]="WARNING",t[t.ERROR=4]="ERROR",t[t.EXCEPTION=3]="EXCEPTION"}(t.LogLevel||(t.LogLevel={})),function(t){t[t.Close=0]="Close",t[t.Cancel=1]="Cancel",t[t.Ok=2]="Ok"}(t.ePopupButton||(t.ePopupButton={}))}(airkit||(airkit={})),function(t){var e=function(){return function(t,e,n){this.url=t,this.name=e,this.key=n}}();t.ConfigItem=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.prototype.init=function(e,r){void 0===r&&(r=null),null!=r&&(n.zipUrl=r),this._listTables=[];var i=e;for(var o in i)this._listTables.push(new t.ConfigItem(o,o,i[o]))},n.prototype.release=function(){if(this._listTables){for(var e=0,n=this._listTables;e<n.length;e++){var r=n[e];t.DataProvider.Instance.unload(r.url)}t.ArrayUtils.clear(this._listTables),this._listTables=null}},n.prototype.loadAll=function(){if(this._listTables.length>0)return t.DataProvider.Instance.enableZip(),t.DataProvider.Instance.loadZip(n.zipUrl,this._listTables)},n.prototype.getList=function(e,n){var r=t.DataProvider.Instance.getConfig(e);if(null==r)return[];null==n&&(n=[]);var i=[];for(var o in r){for(var s=r[o],a=!0,u=0;u<n.length;u++){var l=n[u].k,c=n[u].v;if(s[l]!=c){a=!1;break}}a&&i.push(s)}return i},n.prototype.getInfo=function(e,n){return t.DataProvider.Instance.getInfo(e,n)},Object.defineProperty(n.prototype,"listTables",{get:function(){return this._listTables},enumerable:!0,configurable:!0}),n.instance=null,n.zipUrl="res/config.zip",n}(t.Singleton);t.ConfigManger=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._dicTemplate=null,t._dicData=null,t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.prototype.enableZip=function(){this._zip=!0},n.prototype.setup=function(){this._dicTemplate=new t.SDictionary,this._dicData=new t.SDictionary,this._zip=!1},n.prototype.destroy=function(){this.unloadAll(),this._dicTemplate&&(this._dicTemplate.clear(),this._dicTemplate=null),this._dicData&&(this._dicData.clear(),this._dicData=null)},n.prototype.loadZip=function(e,n){var r=this;return new Promise(function(i,o){t.ResourceManager.Instance.loadRes(e,cc.BufferAsset).then(function(s){var a=t.ResourceManager.Instance.getRes(e);t.ZipUtils.unzip(a).then(function(e){for(var o=0;o<n.length;o++){var s=n[o];r._dicTemplate.add(n[o].url,s),t.Log.info("Load config {0}",s.url);var a=JSON.parse(e[s.url]);if(t.StringUtils.isNullOrEmpty(s.key))r._dicData.add(s.name,a);else{for(var u={},l=void 0,c=void 0,h=0,p=Array.isArray(s.key);a[h];){if(c=a[h],p){l=c[s.key[0]];for(var f=1;f<s.key.length;f++)l+="_"+c[s.key[f]]}else l=c[s.key];t.assertNullOrNil(l,"配置表解析错误:"+s.url),u[l]=c,h++}r._dicData.add(s.name,u)}}i(e)}).catch(function(e){t.Log.error(e),o(e)})})})},n.prototype.load=function(e){var n=this;return new Promise(function(r,i){for(var o=[],s=0;s<e.length;s++)t.ResourceManager.Instance.getRes(e[s].url)||(o.push({url:e[s].url,type:cc.JsonAsset}),n._dicTemplate.add(e[s].url,e[s]));0!=o.length?t.ResourceManager.Instance.loadArrayRes(o,null,null,null,null,t.ResourceManager.SystemGroup).then(function(t){for(var e=0;e<t.length;e++)n.onLoadComplete(t[e]),r(t)}).catch(function(t){i(t)}):r([])})},n.prototype.unload=function(e){var n=this._dicTemplate.getValue(e);n&&this._dicData.remove(n.name),this._zip||t.ResourceManager.Instance.clearRes(e),this._dicTemplate.remove(e)},n.prototype.unloadAll=function(){this._dicTemplate&&(this._dicTemplate.foreach(function(t,e){return this.Unload(t),!0}),this._dicData.clear(),this._dicTemplate.clear())},n.prototype.getConfig=function(t){return this._dicData.getValue(t)},n.prototype.getInfo=function(t,e){var n=this._dicData.getValue(t);if(n){var r=void 0;if(Array.isArray(e)){r=e[0];for(var i=1;i<e.length;i++)r+="_"+e[i]}else r=e;return n[r]}return null},n.prototype.getRes=function(e){t.Log.debug("[load]加载配置表:"+e);var n=this._dicTemplate.getValue(e);if(n){var r=t.ResourceManager.Instance.getRes(e);if(t.StringUtils.isNullOrEmpty(n.key))this._dicData.add(n.name,r);else{for(var i={},o=void 0,s=void 0,a=0,u=Array.isArray(n.key);r[a];){if(s=r[a],u){o=s[n.key[0]];for(var l=1;l<n.key.length;l++)o+="_"+s[n.key[l]]}else o=s[n.key];t.assertNullOrNil(o,"配置表解析错误:"+n.url),i[o]=s,a++}this._dicData.add(n.name,i)}}},n.prototype.onLoadComplete=function(t){this.getRes(t)},n.instance=null,n}(t.Singleton);t.DataProvider=e}(airkit||(airkit={})),function(t){function e(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return e}t.base64_encode=function(t){var r=new n,i=e(t);return r.encode(i)},t.stringToArrayBuffer=e;var n=function(){function t(){this.alphabet=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],this.values={};for(var t=0;t<64;++t)this.values[this.alphabet[t]]=t}return t.prototype.encode=function(t){for(var e,n,r=new Uint8Array(t),i=[],o=0;o+2<r.byteLength;)n=(e=r[o]<<16|r[o+1]<<8|r[o+2])>>18&63,i.push(this.alphabet[n]),n=e>>12&63,i.push(this.alphabet[n]),n=e>>6&63,i.push(this.alphabet[n]),n=63&e,i.push(this.alphabet[n]),o+=3;return o+1===r.byteLength?(n=(e=r[o]<<4)>>6&63,i.push(this.alphabet[n]),n=63&e,i.push(this.alphabet[n]),i.push("==")):o+2===r.byteLength&&(n=(e=r[o]<<10|r[o+1]<<2)>>12&63,i.push(this.alphabet[n]),n=e>>6&63,i.push(this.alphabet[n]),n=63&e,i.push(this.alphabet[n]),i.push("=")),i.join("")},t.prototype.decode=function(t){var e=t.length;if(0===e)return new Uint8Array(new ArrayBuffer(0));if(e%4!=0)throw new Error("Bad length: "+e);if(!t.match(/^[a-zA-Z0-9+\/]+={0,2}$/))throw new Error("Invalid base64 encoded value");var n=e/4*3,r=0;"="===t.charAt(e-1)&&(r++,n--),"="===t.charAt(e-2)&&(r++,n--);var i,o=new Uint8Array(new ArrayBuffer(n)),s=0,a=0;for(r>0&&(e-=4);s<e;){i=0;for(var u=0;u<4;++u)i=i<<6|this.values[t.charAt(s+u)];o[a++]=i>>16&255,o[a++]=i>>8&255,o[a++]=255&i,s+=4}if(r>0){i=0;for(u=0;u<4-r;++u)i=i<<6|this.values[t.charAt(s+u)];1===r?(i>>=2,o[a++]=i>>8&255,o[a++]=255&i):(i>>=4,o[a++]=255&i)}return o},t}();t.Base64=n}(airkit||(airkit={})),function(t){t.md5_encrypt=function(t){return(new e).hex_md5(t)};var e=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),n)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var n=this.rstr2binl(t);n.length>16&&(n=this.binl_md5(n,8*t.length));for(var r=Array(16),i=Array(16),o=0;o<16;o++)r[o]=909522486^n[o],i[o]=1549556828^n[o];var s=this.binl_md5(r.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(i.concat(s),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(t){this.hexcase=0}for(var e,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",i=0;i<t.length;i++)e=t.charCodeAt(i),r+=n.charAt(e>>>4&15)+n.charAt(15&e);return r},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(t){this.b64pad=""}for(var e="",n=t.length,r=0;r<n;r+=3)for(var i=t.charCodeAt(r)<<16|(r+1<n?t.charCodeAt(r+1)<<8:0)|(r+2<n?t.charCodeAt(r+2):0),o=0;o<4;o++)8*r+6*o>8*t.length?e+=this.b64pad:e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-o)&63);return e},t.prototype.rstr2any=function(t,e){var n,r,i,o,s,a=e.length,u=Array(Math.ceil(t.length/2));for(n=0;n<u.length;n++)u[n]=t.charCodeAt(2*n)<<8|t.charCodeAt(2*n+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(l);for(r=0;r<l;r++){for(s=Array(),o=0,n=0;n<u.length;n++)o=(o<<16)+u[n],o-=(i=Math.floor(o/a))*a,(s.length>0||i>0)&&(s[s.length]=i);c[r]=o,u=s}var h="";for(n=c.length-1;n>=0;n--)h+=e.charAt(c[n]);return h},t.prototype.str2rstr_utf8=function(t){for(var e,n,r="",i=-1;++i<t.length;)e=t.charCodeAt(i),n=i+1<t.length?t.charCodeAt(i+1):0,55296<=e&&e<=56319&&56320<=n&&n<=57343&&(e=65536+((1023&e)<<10)+(1023&n),i++),e<=127?r+=String.fromCharCode(e):e<=2047?r+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?r+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(r+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return r},t.prototype.str2rstr_utf16le=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n),t.charCodeAt(n)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t.charCodeAt(n)>>>8&255,255&t.charCodeAt(n));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},t.prototype.binl2rstr=function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var a=n,u=r,l=i,c=o;n=this.md5_ff(n,r,i,o,t[s+0],7,-680876936),o=this.md5_ff(o,n,r,i,t[s+1],12,-389564586),i=this.md5_ff(i,o,n,r,t[s+2],17,606105819),r=this.md5_ff(r,i,o,n,t[s+3],22,-1044525330),n=this.md5_ff(n,r,i,o,t[s+4],7,-176418897),o=this.md5_ff(o,n,r,i,t[s+5],12,1200080426),i=this.md5_ff(i,o,n,r,t[s+6],17,-1473231341),r=this.md5_ff(r,i,o,n,t[s+7],22,-45705983),n=this.md5_ff(n,r,i,o,t[s+8],7,1770035416),o=this.md5_ff(o,n,r,i,t[s+9],12,-1958414417),i=this.md5_ff(i,o,n,r,t[s+10],17,-42063),r=this.md5_ff(r,i,o,n,t[s+11],22,-1990404162),n=this.md5_ff(n,r,i,o,t[s+12],7,1804603682),o=this.md5_ff(o,n,r,i,t[s+13],12,-40341101),i=this.md5_ff(i,o,n,r,t[s+14],17,-1502002290),r=this.md5_ff(r,i,o,n,t[s+15],22,1236535329),n=this.md5_gg(n,r,i,o,t[s+1],5,-165796510),o=this.md5_gg(o,n,r,i,t[s+6],9,-1069501632),i=this.md5_gg(i,o,n,r,t[s+11],14,643717713),r=this.md5_gg(r,i,o,n,t[s+0],20,-373897302),n=this.md5_gg(n,r,i,o,t[s+5],5,-701558691),o=this.md5_gg(o,n,r,i,t[s+10],9,38016083),i=this.md5_gg(i,o,n,r,t[s+15],14,-660478335),r=this.md5_gg(r,i,o,n,t[s+4],20,-405537848),n=this.md5_gg(n,r,i,o,t[s+9],5,568446438),o=this.md5_gg(o,n,r,i,t[s+14],9,-1019803690),i=this.md5_gg(i,o,n,r,t[s+3],14,-187363961),r=this.md5_gg(r,i,o,n,t[s+8],20,1163531501),n=this.md5_gg(n,r,i,o,t[s+13],5,-1444681467),o=this.md5_gg(o,n,r,i,t[s+2],9,-51403784),i=this.md5_gg(i,o,n,r,t[s+7],14,1735328473),r=this.md5_gg(r,i,o,n,t[s+12],20,-1926607734),n=this.md5_hh(n,r,i,o,t[s+5],4,-378558),o=this.md5_hh(o,n,r,i,t[s+8],11,-2022574463),i=this.md5_hh(i,o,n,r,t[s+11],16,1839030562),r=this.md5_hh(r,i,o,n,t[s+14],23,-35309556),n=this.md5_hh(n,r,i,o,t[s+1],4,-1530992060),o=this.md5_hh(o,n,r,i,t[s+4],11,1272893353),i=this.md5_hh(i,o,n,r,t[s+7],16,-155497632),r=this.md5_hh(r,i,o,n,t[s+10],23,-1094730640),n=this.md5_hh(n,r,i,o,t[s+13],4,681279174),o=this.md5_hh(o,n,r,i,t[s+0],11,-358537222),i=this.md5_hh(i,o,n,r,t[s+3],16,-722521979),r=this.md5_hh(r,i,o,n,t[s+6],23,76029189),n=this.md5_hh(n,r,i,o,t[s+9],4,-640364487),o=this.md5_hh(o,n,r,i,t[s+12],11,-421815835),i=this.md5_hh(i,o,n,r,t[s+15],16,530742520),r=this.md5_hh(r,i,o,n,t[s+2],23,-995338651),n=this.md5_ii(n,r,i,o,t[s+0],6,-198630844),o=this.md5_ii(o,n,r,i,t[s+7],10,1126891415),i=this.md5_ii(i,o,n,r,t[s+14],15,-1416354905),r=this.md5_ii(r,i,o,n,t[s+5],21,-57434055),n=this.md5_ii(n,r,i,o,t[s+12],6,1700485571),o=this.md5_ii(o,n,r,i,t[s+3],10,-1894986606),i=this.md5_ii(i,o,n,r,t[s+10],15,-1051523),r=this.md5_ii(r,i,o,n,t[s+1],21,-2054922799),n=this.md5_ii(n,r,i,o,t[s+8],6,1873313359),o=this.md5_ii(o,n,r,i,t[s+15],10,-30611744),i=this.md5_ii(i,o,n,r,t[s+6],15,-1560198380),r=this.md5_ii(r,i,o,n,t[s+13],21,1309151649),n=this.md5_ii(n,r,i,o,t[s+4],6,-145523070),o=this.md5_ii(o,n,r,i,t[s+11],10,-1120210379),i=this.md5_ii(i,o,n,r,t[s+2],15,718787259),r=this.md5_ii(r,i,o,n,t[s+9],21,-343485551),n=this.safe_add(n,a),r=this.safe_add(r,u),i=this.safe_add(i,l),o=this.safe_add(o,c)}return[n,r,i,o]},t.prototype.md5_cmn=function(t,e,n,r,i,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(r,o)),i),n)},t.prototype.md5_ff=function(t,e,n,r,i,o,s){return this.md5_cmn(e&n|~e&r,t,e,i,o,s)},t.prototype.md5_gg=function(t,e,n,r,i,o,s){return this.md5_cmn(e&r|n&~r,t,e,i,o,s)},t.prototype.md5_hh=function(t,e,n,r,i,o,s){return this.md5_cmn(e^n^r,t,e,i,o,s)},t.prototype.md5_ii=function(t,e,n,r,i,o,s){return this.md5_cmn(n^(e|~r),t,e,i,o,s)},t.prototype.safe_add=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();t.MD5=e}(airkit||(airkit={})),function(t){var e=function(){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._type="",this._data=null,e&&0!=e.length&&(e instanceof Array?this._data=t.ArrayUtils.copy(e[0]):this._data=t.ArrayUtils.copy(e))}return e.prototype.init=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];0!=e.length&&(e instanceof Array?this._data=t.ArrayUtils.copy(e[0]):this._data=t.ArrayUtils.copy(e))},e.prototype.get=function(t){return this._data&&0!=this._data.length?t<0||t>=this._data.length?null:this._data[t]:null},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),e}();t.EventArgs=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._event=null,n._evtArgs=null,n._event=new t.EventDispatcher,n._evtArgs=new t.EventArgs,n}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.on=function(t,e,r){n.Instance._event.on(t,e,r)},n.off=function(t,e,r){n.Instance._event.off(t,e,r)},n.dispatchEvent=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];n.Instance._evtArgs.init(e),n.Instance._event.dispatchEvent(t,n.Instance._evtArgs)},n.clear=function(){n.Instance._event.clear()},n.instance=null,n}(t.Singleton);t.EventCenter=e}(airkit||(airkit={})),function(t){var e=function(){function e(){this._dicFuns={},this._evtArgs=null,this._evtArgs=new t.EventArgs}return e.prototype.on=function(e,n,r){if(this._dicFuns[e]){for(var i=this._dicFuns[e],o=0,s=i;o<s.length;o++){var a=s[o];if(a.caller==n&&a.method==r)return}i.push(t.Handler.create(n,r,null,!1))}else this._dicFuns[e]=[],this._dicFuns[e].push(t.Handler.create(n,r,null,!1))},e.prototype.off=function(t,e,n){var r=this._dicFuns[t];if(r)for(var i=0;i<r.length;++i){var o=r[i];if(o.caller==e&&o.method==n){o.recover(),r.splice(i,1);break}}},e.prototype.dispatchEvent=function(t,e){e.type=t;var n=this._dicFuns[t];if(n)for(var r=0,i=n;r<i.length;r++){i[r].runWith(e)}},e.prototype.dispatch=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._evtArgs.init(e),this.dispatchEvent(t,this._evtArgs)},e.prototype.clear=function(){t.DicUtils.clearDic(this._dicFuns)},e}();t.EventDispatcher=e}(airkit||(airkit={})),function(t){var e=function(){function t(){}return t.PROGRESS="progress",t.COMPLETE="complete",t.ERROR="error",t}();t.Event=e;var n=function(){function t(){}return t.BEGIN_GAME="BEGIN_GAME",t.RESTART_GAEM="RESTART_GAME",t.STOP_GAME="STOP_GAME",t.PAUSE_GAME="PAUSE_GAME",t.ON_SHOW="ON_SHOW",t.ON_HIDE="ON_HIDE",t.CHANGE_SCENE="CHANGE_SCENE",t.RESIZE="RESIZE",t.BEGIN_MODULE="BEGIN_MODULE",t.END_MODULE="END_MODULE",t.UI_OPEN="UI_OPEN",t.UI_CLOSE="UI_CLOSE",t.UI_LANG="UI_LANG",t}();t.EventID=n;var r=function(){function t(){}return t.RESOURCE_LOAD_COMPLATE="RESOURCE_LOAD_COMPLATE",t.RESOURCE_LOAD_PROGRESS="RESOURCE_LOAD_PROGRESS",t.RESOURCE_LOAD_FAILED="RESOURCE_LOAD_FAILED",t.LOADVIEW_OPEN="LOADVIEW_OPEN",t.LOADVIEW_COMPLATE="LOADVIEW_COMPLATE",t.LOADVIEW_PROGRESS="LOADVIEW_PROGRESS",t}();t.LoaderEventID=r}(airkit||(airkit={})),function(t){var e=function(){function t(){}return t.prototype.destory=function(){this._listener&&this._listener.destory(),this._listener=null},t.prototype.dispatch=function(t){this._listener&&this._listener.execute(t)},t.prototype.has=function(t){return null!=this._listener&&this._listener.has(t)},t.prototype.on=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this.makeSureListenerManager(),this._listener.on(t,e,n,!1)},t.prototype.once=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this.makeSureListenerManager(),this._listener.on(t,e,n,!0)},t.prototype.off=function(t,e){this._listener&&this._listener.off(t,e)},t.prototype.makeSureListenerManager=function(){this._listener||(this._listener=new n)},t}();t.Signal=e;var n=function(){function e(){this.stopped=!1}return e.prototype.destory=function(){this.stopped=!1,this.clear()},e.prototype.has=function(t){for(var e=0;e<this.handlers.length;e++)if(this.handlers[e].caller==t)return!0;return!1},e.prototype.on=function(e,n,r,i){void 0===i&&(i=!1),this.handlers||(this.handlers=[]);var o=new t.Handler(e,n,r,i);return this.handlers.push(o),o},e.prototype.off=function(t,e){if(this.handlers&&!(this.handlers.length<=0)){for(var n=[],r=0;r<this.handlers.length;r++){var i=this.handlers[r];if(i.caller===t&&i.method===e){i.recover();break}n.push(i)}for(++r;r<this.handlers.length;++r)n.push(this.handlers[r]);this.handlers=n}},e.prototype.offAll=function(t,e){if(this.handlers&&!(this.handlers.length<=0)){for(var n=[],r=this.handlers,i=r.length,o=0;o<i;++o)t!==r[o].caller||e!==r[o].method?n.push(r[o]):r[o].recover();this.handlers=n}},e.prototype.clear=function(){if(this.handlers&&!(this.handlers.length<=0)){for(var t=0;t<this.handlers.length;t++){this.handlers[t].recover()}this.handlers=null}},e.prototype.stop=function(){this.stopped=!0},e.prototype.execute=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.handlers&&!(this.handlers.length<=0)){for(var n,r=this.handlers,i=r.length,o=[],s=0;s<i&&!this.stopped;++s)(n=r[s]).runWith(t),n.method&&o.push(n);for(;s<i;++s)o.push(r[s]);this.stopped=!1,this.handlers=o,n=null,r=null,o=null}},e}();t.SignalListener=n}(airkit||(airkit={})),function(t){t.L=function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=e.Instance.getText(e.Instance.curLang,n);return null==o?"unknown key:"+n:t.StringUtils.format.apply(t.StringUtils,[o].concat(r))};var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.prototype.init=function(){this._curLang=null},n.prototype.destory=function(){},n.prototype.changeLang=function(e){var n=this;return new Promise(function(r,i){e!=n._curLang?t.ConfigManger.Instance.getList(n._curLang)?t.DataProvider.Instance.getConfig(e)&&(n._curLang=e,t.EventCenter.dispatchEvent(t.EventID.UI_LANG,n._curLang),r(e)):(t.Log.error("no lang package {0} ",e),i("no lang package "+e)):r(e)})},n.prototype.getText=function(e,n){var r=t.DataProvider.Instance.getInfo(e,n);return r?r.name:(t.Log.error("cant get lang key",n),"")},Object.defineProperty(n.prototype,"curLang",{get:function(){return this._curLang},enumerable:!0,configurable:!0}),n.instance=null,n}(t.Singleton);t.LangManager=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.registerLoadingView=function(e,n,r){this.loaders.add(e,n),t.ClassUtils.regClass(n,r)},Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.prototype.setup=function(){this.registerEvent(),this._dicLoadView=new t.NDictionary},n.prototype.destroy=function(){if(this.unRegisterEvent(),this._dicLoadView){this._dicLoadView.foreach(function(t,e){return e.close(),!0}),this._dicLoadView.clear(),this._dicLoadView=null}},n.prototype.registerEvent=function(){t.EventCenter.on(t.LoaderEventID.LOADVIEW_OPEN,this,this.onLoadViewEvt),t.EventCenter.on(t.LoaderEventID.LOADVIEW_COMPLATE,this,this.onLoadViewEvt),t.EventCenter.on(t.LoaderEventID.LOADVIEW_PROGRESS,this,this.onLoadViewEvt)},n.prototype.unRegisterEvent=function(){t.EventCenter.off(t.LoaderEventID.LOADVIEW_OPEN,this,this.onLoadViewEvt),t.EventCenter.off(t.LoaderEventID.LOADVIEW_COMPLATE,this,this.onLoadViewEvt),t.EventCenter.off(t.LoaderEventID.LOADVIEW_PROGRESS,this,this.onLoadViewEvt)},n.prototype.onLoadViewEvt=function(e){var n=e.type,r=e.get(0);switch(n){case t.LoaderEventID.LOADVIEW_OPEN:t.Log.debug("显示加载界面");var i=e.get(1),o=e.get(2);this.show(r,i,o);break;case t.LoaderEventID.LOADVIEW_PROGRESS:var s=e.get(1);i=e.get(2);this.setProgress(r,s,i);break;case t.LoaderEventID.LOADVIEW_COMPLATE:t.Log.debug("加载界面关闭"),this.close(r)}},n.prototype.show=function(e,r,i){var o=this;if(null!=e&&e!=t.LOADVIEW_TYPE_NONE){var s=this._dicLoadView.getValue(e);if(s)this.updateView(s,r,i);else{var a=n.loaders.getValue(e);if(a.length>0){if(null==(s=t.ClassUtils.getInstance(a)))return;s.setup([]);var u=t.ClassUtils.getClass(a);s.loadResource(t.ResourceManager.SystemGroup,u).then(function(){t.LayerManager.loadingLayer.addChild(s),o._dicLoadView.add(e,s),o.updateView(s,r,i)})}else t.Log.error("Must set loadingview first type= {0}",e)}}},n.prototype.updateView=function(e,n,r){e.parent||t.LayerManager.loadingLayer.addChild(e),e.onOpen(n),e.setTips(r),e.setVisible(!0)},n.prototype.setProgress=function(t,e,n){var r=this._dicLoadView.getValue(t);r&&r.setProgress(e,n)},n.prototype.close=function(t){var e=this._dicLoadView.getValue(t);e&&(e.setVisible(!1),e.onClose(),this._dicLoadView.remove(t),e=null)},n.loaders=new t.NDictionary,n.instance=null,n}(t.Singleton);t.LoaderManager=e}(airkit||(airkit={})),function(t){t.FONT_SIZE_4=18,t.FONT_SIZE_5=22,t.FONT_SIZE_6=25,t.FONT_SIZE_7=29;var e,n=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t._dicLoaderUrl=null,t}return __extends(i,n),Object.defineProperty(i,"Instance",{get:function(){return this.instance||(this.instance=new i),this.instance},enumerable:!0,configurable:!0}),i.prototype.setup=function(){this._dicLoaderUrl=new t.SDictionary,this._minLoaderTime=1e3,this._aniAnimDic=new t.SDictionary,this.onAniResUpdateSignal=new t.Signal},i.asyncLoad=function(t,e,n,r,i,o,s){return new Promise(function(r,i){cc.loader.loadRes(t,n,function(t,n,r){e.runWith(t/n)},function(e,n){e?i(t):r(t)})})},i.prototype.destroy=function(){this._dicLoaderUrl&&(this._dicLoaderUrl.clear(),this._dicLoaderUrl=null)},i.prototype.update=function(t){},i.prototype.getRes=function(t){return this.refreshResourceTime(t,null,!1),cc.loader.getRes(t)},i.prototype.loadRes=function(e,n,r,o,s,a,u){var l=this;return void 0===r&&(r=t.LOADVIEW_TYPE_NONE),void 0===o&&(o=1),void 0===s&&(s=!0),void 0===a&&(a="default"),void 0===u&&(u=!1),this.refreshResourceTime(e,a,!0),null==r&&(r=t.LOADVIEW_TYPE_NONE),r!=t.LOADVIEW_TYPE_NONE&&cc.loader.getRes(e)&&(r=t.LOADVIEW_TYPE_NONE),r!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_OPEN,r,1),new Promise(function(c,h){i.asyncLoad(e,t.Handler.create(l,l.onLoadProgress,[r,1],!1),n,o,s,a,u).then(function(t){l.onLoadComplete(r,[e]),c(e)}).catch(function(t){h(t)})})},i.prototype.loadArrayRes=function(e,n,r,o,s,a,u){var l=this;void 0===n&&(n=t.LOADVIEW_TYPE_NONE),void 0===r&&(r=null),void 0===o&&(o=1),void 0===s&&(s=!0),void 0===a&&(a="default"),void 0===u&&(u=!1);var c=!1,h=[],p=[];null==n&&(n=t.LOADVIEW_TYPE_NONE),null==o&&(o=1),null==s&&(s=!0);for(var f=0,d=e;f<d.length;f++){var g=d[f];h.push({url:g.url,type:g.type}),p.push(g.url),c||cc.loader.getRes(g.url)||(c=!0),this.refreshResourceTime(g.url,a,!0)}return c||n==t.LOADVIEW_TYPE_NONE||(n=t.LOADVIEW_TYPE_NONE),n!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_OPEN,n,h.length,r),new Promise(function(e,c){i.asyncLoad(h,t.Handler.create(l,l.onLoadProgress,[n,h.length,r],!1),void 0,o,s,a,u).then(function(i){n!=t.LOADVIEW_TYPE_NONE?t.TimerManager.Instance.addOnce(l._minLoaderTime,null,function(t){l.onLoadComplete(n,p,r),e(p)}):(l.onLoadComplete(n,p,r),e(p))}).catch(function(t){c(t)})})},i.prototype.onLoadComplete=function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(r)for(var o=0,s=r[0];o<s.length;o++){var a=s[o];t.Log.debug("[load]加载完成url:"+a);var u=a.lastIndexOf(".bin");if(u>0){var l=a.substr(0,u);fgui.UIPackage.addPackage(l),t.Log.info("add Package :"+l)}var c=this._dicLoaderUrl.getValue(a);c&&c.updateStatus(e.LOADED)}n!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_COMPLATE,n)},i.prototype.onLoadProgress=function(e,n,r,i){var o=t.NumberUtils.toInt(Math.floor(i*n));t.Log.debug("[load]进度: current={0} total={1}",o,n),e!=t.LOADVIEW_TYPE_NONE&&t.EventCenter.dispatchEvent(t.LoaderEventID.LOADVIEW_PROGRESS,e,o,n,r)},i.prototype.refreshResourceTime=function(t,n,i){var o;i?(o=this._dicLoaderUrl.getValue(t))?o.ctime=Date.now():(o=new r(t,n),this._dicLoaderUrl.add(t,o),o.updateStatus(e.LOADING)):(o=this._dicLoaderUrl.getValue(t))&&(o.utime=Date.now())},i.prototype.clearRes=function(e){this._dicLoaderUrl.remove(e),cc.loader.releaseRes(e);var n=e.lastIndexOf(".bin");if(n>0){var r=e.lastIndexOf("/"),i=e.substr(r+1,n-r-1);fgui.UIPackage.removePackage(i),t.Log.info("remove Package :"+i)}t.Log.info("[res]释放资源:"+e)},i.prototype.cleanTexture=function(e){var n=this;this._dicLoaderUrl.foreach(function(r,i){return i.group==e&&(t.Log.info("清理texture资源 {0}",r),n.clearRes(r)),!0})},i.prototype.setAniAnim=function(t,e,n){var r=this._aniAnimDic.getValue(t);null==r?this._aniAnimDic.add(t,[e,1,n]):r[1]+=1},i.prototype.createFuiAnim=function(t,e,n,r){return void 0===r&&(r="default"),new Promise(function(o,s){var a=n+"_atlas0.png",u=n+".bin";if(null==i.Instance.getRes(a))i.Instance.loadArrayRes([{url:a,type:cc.SpriteFrame},{url:u,type:cc.BufferAsset}],null,null,0,!0,r).then(function(n){var r=fgui.UIPackage.createObject(t,e);o(r.asCom)}).catch(function(t){s(t)});else{var l=fgui.UIPackage.createObject(t,e);o(l.asCom)}})},i.imageProxy=function(e,n,r,o){return new Promise(function(s,a){if(null!=i.Instance.getRes(n))e.url=n;else{var u=n;null!=o&&(u=o),r&&(e.url=r),t.Log.info("imageProxy start load {0} ",u),i.Instance.loadRes(u).then(function(r){e.url=n,e.alpha=.1,t.TweenUtils.get(e).to({alpha:1},.3),t.Log.info("imageProxy start load done {0} ",u)}).catch(function(e){return t.Log.error(e)})}})},i.FONT_Yuanti="Yuanti SC Regular",i.Font_Helvetica="Helvetica",i.FONT_DEFAULT="",i.FONT_DEFAULT_SIZE=t.FONT_SIZE_5,i.DefaultGroup="airkit",i.SystemGroup="system",i.instance=null,i}(t.Singleton);t.ResourceManager=n,function(t){t[t.READY=0]="READY",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(e||(e={}));var r=function(){function t(t,n){this.url=t,this.group=n,this.ctime=Date.now(),this.utime=Date.now(),this.status=e.READY}return t.prototype.updateStatus=function(t){this.status=t},t}()}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.format=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(null==e)return"null";if(t.StringUtils.isString(e)){for(var i=[],o=0;o<n.length;o++){var s=n[o];t.StringUtils.isString(s)?i.push(s):i.push(JSON.stringify(s,null,4))}return t.StringUtils.format.apply(t.StringUtils,[e].concat(i))}return"object"==typeof e&&e.message?e.message:JSON.stringify(e,null,4)},e.debug=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(!(this.LEVEL<t.LogLevel.DEBUG)){var i=this.format.apply(this,[e].concat(n));return console.log(t.DateUtils.currentYMDHMS(),"[debug]",i),i}},e.info=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(!(this.LEVEL<t.LogLevel.INFO)){var i=this.format.apply(this,[e].concat(n));return console.log(t.DateUtils.currentYMDHMS(),"[info]",i),i}},e.warning=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(!(this.LEVEL<t.LogLevel.WARNING)){var i=this.format.apply(this,[e].concat(n));return console.warn(t.DateUtils.currentYMDHMS(),"[warn]",i),i}},e.error=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(!(this.LEVEL<t.LogLevel.ERROR)){var i=this.format.apply(this,[e].concat(n));return console.error(t.DateUtils.currentYMDHMS(),"[error]",i),i}},e.exception=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(!(this.LEVEL<t.LogLevel.EXCEPTION)){var i=this.format.apply(this,[e].concat(n));return console.exception(t.DateUtils.currentYMDHMS(),"[exce]",i),i}},e.dump=function(e){if(!(this.LEVEL<t.LogLevel.INFO)){if(e instanceof Object)try{e=JSON.stringify(e,null,4)}catch(t){console.error(t)}console.log(t.DateUtils.currentYMDHMS(),"[Dump]",e)}},e.LEVEL=t.LogLevel.INFO,e}();t.Log=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.setup=function(e){this.emit(t.EventID.BEGIN_MODULE,this.name),this.registerEvent()},n.prototype.start=function(){},n.prototype.update=function(t){},n.prototype.registerEvent=function(){this.registerSignalEvent()},n.prototype.unRegisterEvent=function(){this.unregisterSignalEvent()},n.res=function(){return null},n.loaderTips=function(){return"资源加载中"},n.loaderType=function(){return t.LOADVIEW_TYPE_NONE},n.prototype.registerSignalEvent=function(){var t=this.signalMap();if(t)for(var e=0,n=t;e<n.length;e++){var r=n[e];r[0].on(r[1],r[2],r.slice(3))}},n.prototype.unregisterSignalEvent=function(){var t=this.signalMap();if(t)for(var e=0,n=t;e<n.length;e++){var r=n[e];r[0].off(r[1],r[2])}},n.prototype.signalMap=function(){return null},n.prototype.dispose=function(){this.emit(t.EventID.END_MODULE,this.name),this.unRegisterEvent()},n}(cc.Node);t.BaseModule=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this.instance||(this.instance=new e),this.instance},enumerable:!0,configurable:!0}),e.prototype.setup=function(){this.registerEvent()},e.register=function(e,n){t.ClassUtils.regClass(e,n)},e.call=function(e,n){for(var r=this,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return new Promise(function(o,s){var a=r.modules.getValue(e);if(null==a){a=t.ClassUtils.getInstance(e);var u=t.ClassUtils.getClass(e);null==a&&(t.Log.warning("Cant find module {0}",e),s("Cant find module"+e)),r.modules.add(e,a),a.name=e,r.loadResource(a,u).then(function(e){a.once(t.EventID.BEGIN_MODULE,function(){if(a.start(),null==n)o(a);else{var t=r.callFunc(a,n,i);o(t)}},null),a.setup(null)}).catch(function(n){t.Log.warning("Load module Resource Failed {0}",e),s("Load module Resource Failed "+e)})}else if(null==n)o(a);else{var l=r.callFunc(a,n,i);o(l)}})},e.callFunc=function(e,n,r){if(null!=n){var i=e[n],o=null;return i?o=r?i.apply(e,r):i.apply(e):t.Log.error("cant find funcName {0} from Module:{1}",n,e.name),o}},e.loadResource=function(e,n){var r=[],i=n.res();if(i&&i.length>0)for(var o=0;o<i.length;++o){var s=i[o];t.ResourceManager.Instance.getRes(s[0])||r.push({url:s[0],type:s[1]})}return new Promise(function(e,i){if(r.length>0){var o=n.loaderType(),s=n.loaderTips();t.ResourceManager.Instance.loadArrayRes(r,o,s,1,!0,t.ResourceManager.DefaultGroup).then(function(t){e(t)}).catch(function(t){i(t)})}else e([])})},e.prototype.destroy=function(){this.unRegisterEvent(),this.clear()},e.prototype.clear=function(){e.modules&&(e.modules.foreach(function(t,e){return e.dispose(),!0}),e.modules.clear())},e.prototype.update=function(t){e.modules.foreach(function(e,n){return n.update(t),!0})},e.prototype.registerEvent=function(){},e.prototype.unRegisterEvent=function(){},e.modules=new t.SDictionary,e.instance=null,e}();t.Mediator=e}(airkit||(airkit={})),function(t){var e;!function(t){t[t.TypeText=0]="TypeText",t[t.TypeJson=1]="TypeJson",t[t.TypePB=2]="TypePB"}(e=t.eHttpRequestType||(t.eHttpRequestType={})),t.POST="POST",t.GET="GET",t.CONTENT_TYPE_TEXT="application/x-www-form-urlencoded",t.CONTENT_TYPE_JSON="application/json",t.CONTENT_TYPE_PB="application/octet-stream",t.RESPONSE_TYPE_TEXT="text",t.RESPONSE_TYPE_JSON="json",t.RESPONSE_TYPE_XML="xml",t.RESPONSE_TYPE_BYTE="arraybuffer",t.HTTP_REQUEST_TIMEOUT=1e4;var n=function(){function n(){}return n.request=function(r,i,o,s,a,u){var l=this;return new Promise(function(c,h){n.currentRequsts>n.maxRequest&&t.Log.error("reached max request {0}",n.currentRequsts),n.currentRequsts<0&&(n.currentRequsts=0),n.currentRequsts++,null==u&&(u="text"),i!=t.POST&&i!=t.GET&&(n.currentRequsts--,h("method error")),s||(s=[]);var p="Content-Type";switch(o){case e.TypeText:s.push(p,t.CONTENT_TYPE_TEXT);break;case e.TypeJson:s.push(p,t.CONTENT_TYPE_JSON);break;case e.TypePB:s.push(p,t.CONTENT_TYPE_PB);break;default:s.push(p,t.CONTENT_TYPE_TEXT)}var f=new t.HttpRequest;f.http.timeout=t.HTTP_REQUEST_TIMEOUT,f.http.ontimeout=function(){t.Log.error("request timeout {0}",r),f.targetOff(f),n.currentRequsts--,h("timeout")},f.once(t.Event.COMPLETE,l,function(e){var r;switch(u){case t.RESPONSE_TYPE_TEXT:case t.RESPONSE_TYPE_JSON:r=f.data;break;case t.RESPONSE_TYPE_BYTE:var i=new t.Byte(f.data);i.endian=t.Byte.BIG_ENDIAN,r=i.getUint8Array(i.pos,i.length-i.pos);break;default:r=f.data}f.targetOff(f),n.currentRequsts--,c(r)}),f.once(t.Event.ERROR,l,function(e){t.Log.error("req:{0} error:{1}",r,e),f.targetOff(f),n.currentRequsts--,h(e)}),f.on(t.Event.PROGRESS,l,function(t){}),i==t.GET?f.send(r,null,i,u,s):f.send(r,a,i,u,s)})},n.get=function(n,r,i,o){return null==r&&(r=e.TypeText),null==o&&(o=t.RESPONSE_TYPE_TEXT),this.request(n,t.GET,r,i,null,o)},n.post=function(n,r,i,o,s){var a=null;switch(null==i&&(i=e.TypeText),i){case e.TypeText:r&&(a=t.Utils.obj2query(r));break;case e.TypeJson:r&&(a=JSON.stringify(r));break;case e.TypePB:r&&(a=r)}return null==s&&(s=t.RESPONSE_TYPE_TEXT),this.request(n,t.POST,i,o,a,s)},n.currentRequsts=0,n.maxRequest=6,n}();t.Http=n}(airkit||(airkit={})),function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._http=new XMLHttpRequest,t}return __extends(n,e),n.prototype.send=function(t,e,n,r,i){void 0===e&&(e=null),void 0===n&&(n="get"),void 0===r&&(r="text"),void 0===i&&(i=null),this._responseType=r,this._data=null,this._url=t;var o=this,s=this._http;s.open(n,t,!0);var a=!1;if(i)for(var u=0;u<i.length;u++)s.setRequestHeader(i[u++],i[u]);else window.conch||(e&&"string"!=typeof e?(s.setRequestHeader("Content-Type","application/json"),a=!0):s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var l="arraybuffer"!==r?"text":"arraybuffer";s.responseType=l,s.dataType&&(s.dataType=l),s.onerror=function(t){o._onError(t)},s.onabort=function(t){o._onAbort(t)},s.onprogress=function(t){o._onProgress(t)},s.onload=function(t){o._onLoad(t)},s.send(a?JSON.stringify(e):e)},n.prototype._onProgress=function(e){e&&e.lengthComputable&&this.emit(t.Event.PROGRESS,e.loaded/e.total)},n.prototype._onAbort=function(t){this.error("Request was aborted by user")},n.prototype._onError=function(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},n.prototype._onLoad=function(t){var e=this._http,n=void 0!==e.status?e.status:200;200===n||204===n||0===n?this.complete():this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)},n.prototype.error=function(e){this.clear(),console.warn(this.url,e),this.emit(t.Event.ERROR,e)},n.prototype.complete=function(){this.clear();var e=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=t.Utils.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(t){e=!1,this.error(t.message)}e&&this.emit(t.Event.COMPLETE,this._data instanceof Array?[this._data]:this._data)},n.prototype.clear=function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null},Object.defineProperty(n.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"http",{get:function(){return this._http},enumerable:!0,configurable:!0}),n._urlEncode=encodeURI,n}(cc.Node);t.HttpRequest=e}(airkit||(airkit={})),function(t){var e=function(){function e(t,e){this._owner=null,this._status=0,this._times=0,this._tick=0,this._entity=t,this._status=e}return e.prototype.enter=function(){t.Log.info("you must overwrite the func state.enter !")},e.prototype.update=function(e){t.Log.info("you must overwrite the func state.update !")},e.prototype.exit=function(){t.Log.info("you must overwrite the func state.exit !")},e}();t.State=e}(airkit||(airkit={})),function(t){var e=function(){function t(){this._currentState=null,this._previousState=null,this._globalState=null}return t.prototype.update=function(t){this._globalState&&this._globalState.update(t),this._currentState&&this._currentState.update(t)},t.prototype.changeState=function(t){this._previousState=this._currentState,this._currentState=t,this._currentState._owner=this,this._previousState&&this._previousState.exit(),this._currentState.enter()},t.prototype.setCurrentState=function(t){this._currentState&&this._currentState.exit(),this._currentState=t,this._currentState._owner=this,this._currentState.enter()},t.prototype.setGlobalState=function(t){this._globalState&&this._globalState.exit(),this._globalState=t,this._globalState._owner=this,this._globalState.enter()},t.prototype.clearAllState=function(){this._globalState&&(this._globalState.exit(),this._globalState=null),this._currentState&&(this._currentState.exit(),this._currentState=null),this._previousState=null},Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"previousState",{get:function(){return this._previousState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalState",{get:function(){return this._globalState},enumerable:!0,configurable:!0}),t}();t.StateMachine=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.getSeq=function(){return e.REQ_ID++},e.prototype.decode=function(e,n){var r=t.bytes2String(e,n),i=JSON.parse(r);return i&&i.payload?(this.uid=i.uid,this.cmd=i.cmd,this.msgType=i.msgType,this.ID=i.userdata,this.data=JSON.parse(i.payload),!0):(r=null,!1)},e.prototype.encode=function(t){this.ID=e.getSeq();var n={uid:this.uid,cmd:this.cmd,msgType:this.msgType,seq:this.ID,userdata:this.ID,payload:JSON.stringify(this.data)};return JSON.stringify(n)},e.prototype.getID=function(){return this.ID},e.REQ_ID=1,e}();t.JSONMsg=e;var n=function(){function e(){this.receiveByte=new t.Byte,this.receiveByte.endian=t.Byte.LITTLE_ENDIAN}return e.prototype.getID=function(){return this.ID},e.prototype.decode=function(e,n){this.receiveByte.clear(),this.receiveByte.writeArrayBuffer(e),this.receiveByte.pos=0;var r=this.receiveByte.getInt16();this.receiveByte.getInt16();return this.receiveByte.bytesAvailable>=r&&((new t.Byte).writeArrayBuffer(this.receiveByte,4,r),!0)},e.prototype.encode=function(e){var n=new t.Byte;return n.endian=t.Byte.LITTLE_ENDIAN,n.pos=0,n},e}();t.PBMsg=n}(airkit||(airkit={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._isOpen=!1,t._UIID=0,t.objectData=null,t._destory=!1,t._viewID=n.__ViewIDSeq++,t}return __extends(n,e),n.prototype.createPanel=function(t,e){var n=fgui.UIPackage.createObjectFromURL("ui://"+t+"/"+e);null!=n&&(this._view=n.asCom,this._view.setSize(this.width,this.height),this._view.addRelation(this,fgui.RelationType.Width),this._view.addRelation(this,fgui.RelationType.Height),this.addChild(this._view))},n.prototype.debug=function(){},n.prototype.setup=function(e){this._isOpen=!0,this.onLangChange(),this.onCreate(e),t.EventCenter.dispatchEvent(t.EventID.UI_OPEN,this._UIID),t.EventCenter.on(t.EventID.UI_LANG,this,this.onLangChange),this.registerEvent(),this.registeGUIEvent(),this.registerSignalEvent()},n.prototype.dispose=function(){this._destory||(this._destory=!0,this.onDestroy(),this.unRegisterEvent(),this.unregisteGUIEvent(),this.unregisterSignalEvent(),this._isOpen=!1,this.objectData=null,t.EventCenter.dispatchEvent(t.EventID.UI_CLOSE,this._UIID),t.EventCenter.off(t.EventID.UI_LANG,this,this.onLangChange),e.prototype.dispose.call(this))},n.prototype.isDestory=function(){return this._destory},n.prototype.panel=function(){var t=this.getGObject("panel");return null!=t?t.asCom:null},n.prototype.bg=function(){var t=this.getGObject("bg");return null!=t?t.asCom:null},n.prototype.setVisible=function(t){this.visible;this.visible=t},n.prototype.setUIID=function(t){this._UIID=t},Object.defineProperty(n.prototype,"UIID",{get:function(){return this._UIID},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewID",{get:function(){return this._viewID},enumerable:!0,configurable:!0}),n.prototype.onCreate=function(t){},n.prototype.onDestroy=function(){},n.prototype.update=function(t){return!0},n.prototype.getGObject=function(t){return this._view.getChild(t)},n.prototype.onEnter=function(){},n.prototype.onLangChange=function(){},n.res=function(){return null},n.loaderTips=function(){return"资源加载中"},n.loaderType=function(){return t.LOADVIEW_TYPE_NONE},n.prototype.signalMap=function(){return null},n.prototype.eventMap=function(){return null},n.prototype.registerEvent=function(){},n.prototype.unRegisterEvent=function(){},n.prototype.staticCacheUI=function(){return null},n.prototype.loadResource=function(e,n){var r=this;return new Promise(function(i,o){var s=[],a=n.res();if(a&&a.length>0)for(var u=0;u<a.length;++u){var l=a[u];t.ResourceManager.Instance.getRes(l[0])||s.push({url:l[0],type:l[1]})}if(s.length>0){var c=n.loaderTips(),h=n.loaderType();t.ResourceManager.Instance.loadArrayRes(s,h,c,1,!0,e).then(function(t){r.onAssetLoaded(),i(r),r.onEnter()}).catch(function(e){t.Log.error(e),o(e)})}else r.onAssetLoaded(),i(r),r.onEnter()})},n.prototype.onAssetLoaded=function(){this._isOpen},n.prototype.registerSignalEvent=function(){var t=this.signalMap();if(t)for(var e=0,n=t;e<n.length;e++){var r=n[e];r[0].on(r[1],r[2],r.slice(3))}},n.prototype.unregisterSignalEvent=function(){var t=this.signalMap();if(t)for(var e=0,n=t;e<n.length;e++){var r=n[e];r[0].off(r[1],r[2])}},n.prototype.registeGUIEvent=function(){var t=this.eventMap();if(t)for(var e=0,n=t;e<n.length;e++){var r=n[e];r[0].on(r[1],r[2],this)}},n.prototype.unregisteGUIEvent=function(){var t=this.eventMap();if(t)for(var e=0,n=t;e<n.length;e++){var r=n[e];r[0].off(r[1],r[2],this)}},n.prototype.doClose=function(){return!1===this._isOpen?(t.Log.error("连续点击"),!1):(this._isOpen=!1,t.UIManager.Instance.close(this.UIID,t.eCloseAnim.CLOSE_CENTER),!0)},n.__ViewIDSeq=0,n}(fgui.GComponent);t.BaseView=e}(airkit||(airkit={})),function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.debug=function(){},e}(fgui.GComponent);t.Layer=e;var n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return __extends(r,n),Object.defineProperty(r,"stage",{get:function(){return this._root},enumerable:!0,configurable:!0}),r.getLayer=function(e){var n=null;switch(e){case t.eUILayer.BG:n=this.bgLayer;break;case t.eUILayer.MAIN:n=this.mainLayer;break;case t.eUILayer.GUI:n=this.uiLayer;break;case t.eUILayer.POPUP:n=this.popupLayer;break;case t.eUILayer.TOOLTIP:n=this.tooltipLayer;break;case t.eUILayer.SYSTEM:n=this.systemLayer;break;case t.eUILayer.LOADING:n=this.loadingLayer;break;case t.eUILayer.TOP:n=this.topLayer}return cc.director.getWinSize().width==n.width&&cc.director.getWinSize().height==n.height||(n.width=cc.director.getWinSize().width,n.height=cc.director.getWinSize().height),n},r.setup=function(t){this._root=t,this._bgLayer=new e,this._bgLayer.node.name="bgLayer",this._bgLayer.touchable=!0,this._root.addChild(this._bgLayer),this._bgLayer.sortingOrder=0,this._mainLayer=new e,this._mainLayer.node.name="mainLayer",this._mainLayer.touchable=!0,this._root.addChild(this._mainLayer),this._mainLayer.sortingOrder=2,this._tooltipLayer=new e,this._tooltipLayer.node.name="tooltipLayer",this._tooltipLayer.touchable=!1,this._root.addChild(this._tooltipLayer),this._tooltipLayer.sortingOrder=3,this._uiLayer=new e,this._uiLayer.node.name="uiLayer",this._uiLayer.touchable=!0,this._root.addChild(this._uiLayer),this._uiLayer.sortingOrder=4,this._popupLayer=new e,this._popupLayer.node.name="popupLayer",this._popupLayer.touchable=!0,this._root.addChild(this._popupLayer),this._popupLayer.sortingOrder=5,this._systemLayer=new e,this._systemLayer.node.name="systemLayer",this._systemLayer.touchable=!0,this._root.addChild(this._systemLayer),this._systemLayer.sortingOrder=6,this._loadingLayer=new e,this._loadingLayer.node.name="loadingLayer",this._loadingLayer.touchable=!0,this._root.addChild(this._loadingLayer),this._loadingLayer.sortingOrder=1001,this._topLayer=new e,this._topLayer.node.name="topLayer",this._topLayer.touchable=!0,this._root.addChild(this._topLayer),this._topLayer.sortingOrder=1002,this.layers=[this._bgLayer,this._mainLayer,this._uiLayer,this._popupLayer,this._tooltipLayer,this._systemLayer,this._loadingLayer,this._topLayer],this.registerEvent(),this.resize()},r.registerEvent=function(){t.EventCenter.on(t.EventID.RESIZE,this,this.resize)},r.unRegisterEvent=function(){t.EventCenter.off(t.EventID.RESIZE,this,this.resize)},r.resize=function(){var e,n;t.Log.info("LayerManager Receive Resize {0} {1}",cc.director.getWinSize().width,cc.director.getWinSize().height);var i=cc.director.getWinSize().width,o=cc.director.getWinSize().height;for(fgui.GRoot.inst.setSize(i,o),e=0,n=this.layers.length;e<n;e++)this.layers[e].setSize(i,o);if(this._bgLayer.numChildren){var s=this._bgLayer.getChildAt(0),a=i-r.BG_WIDTH>>1,u=o-r.BG_HEIGHT;s.setPosition(a,u)}fgui.GRoot.inst.setSize(i,o);for(var l=[this._uiLayer,this._popupLayer,this._systemLayer,this._topLayer,this._loadingLayer],c=0;c<l.length;c++)for(var h=l[c],p=0,f=h.numChildren;p<f;p++){h.getChildAt(p).setSize(i,o)}},r.destroy=function(){r.removeAll(),t.DisplayUtils.removeAllChild(this._topLayer),t.DisplayUtils.removeAllChild(this._root),this._topLayer=null,this._loadingLayer=null,this._systemLayer=null,this._tooltipLayer=null,this._popupLayer=null,this._uiLayer=null,this._mainLayer=null,this._bgLayer=null},r.removeAll=function(){t.DisplayUtils.removeAllChild(this._bgLayer),t.DisplayUtils.removeAllChild(this._mainLayer),t.DisplayUtils.removeAllChild(this._uiLayer),t.DisplayUtils.removeAllChild(this._popupLayer),t.DisplayUtils.removeAllChild(this._tooltipLayer),t.DisplayUtils.removeAllChild(this._systemLayer),t.DisplayUtils.removeAllChild(this._loadingLayer)},Object.defineProperty(r,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(r,"bgLayer",{get:function(){return this._bgLayer},enumerable:!0,configurable:!0}),r.addBg=function(t){var e;return this.bgLayer.numChildren?e=this.bgLayer.getChildAt(0):((e=new fgui.GLoader).width=r.BG_WIDTH,e.height=r.BG_HEIGHT,e.x=cc.director.getWinSize().width-r.BG_WIDTH>>1,e.y=cc.director.getWinSize().height-r.BG_HEIGHT,this.bgLayer.addChild(e)),e.url=t,e},Object.defineProperty(r,"mainLayer",{get:function(){return this._mainLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r,"uiLayer",{get:function(){return this._uiLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r,"popupLayer",{get:function(){return this._popupLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r,"tooltipLayer",{get:function(){return this._tooltipLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r,"systemLayer",{get:function(){return this._systemLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r,"loadingLayer",{get:function(){return this._loadingLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r,"topLayer",{get:function(){return this._topLayer},enumerable:!0,configurable:!0}),r.BG_WIDTH=750,r.BG_HEIGHT=1650,r}(t.Singleton);t.LayerManager=n}(airkit||(airkit={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.bgTouch=!0,t}return __extends(n,e),n.prototype.update=function(t){return e.prototype.update.call(this,t)},n.prototype.setup=function(t){e.prototype.setup.call(this,t),this.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height)},n.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.createPanel(this.pkgName,this.resName);var n=this.panel();n&&(t.DisplayUtils.popup(n,t.Handler.create(this,this.onOpen)),this.closeBtn=this.closeButton(),this.closeBtn&&(this.closeBtn.visible=!1)),t.TimerManager.Instance.addOnce(250,this,this.setupTouchClose)},n.prototype.onOpen=function(){},n.prototype.closeButton=function(){var t=this.panel().getChild("closeBtn");return null!=t?t.asButton:null},n.prototype.setupTouchClose=function(){var t=this.bg();t&&this.bgTouch&&(t.touchable=!0,t.onClick(this.onClose,this)),this.closeBtn&&(this.closeBtn.visible=!0,this.closeBtn.onClick(this.pressClose,this))},n.prototype.pressClose=function(){this.closeBtn&&t.TweenUtils.scale(this.closeBtn),this.onClose()},n.prototype.onClose=function(){this.doClose()},n.prototype.dispose=function(){e.prototype.dispose.call(this),null!=this.callback&&this.callback()},n.prototype.loadResource=function(t,n){return e.prototype.loadResource.call(this,t,n)},n}(t.BaseView);t.PopupView=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.registerScene=function(n,r,i){e.scenes.add(n,r),t.ClassUtils.regClass(r,i)},Object.defineProperty(e,"Instance",{get:function(){return this.instance||(this.instance=new e),this.instance},enumerable:!0,configurable:!0}),e.prototype.setup=function(){this.registerEvent()},e.prototype.destroy=function(){this.unRegisterEvent()},e.prototype.update=function(t){this._curScene&&this._curScene.update(t)},e.prototype.registerEvent=function(){t.EventCenter.on(t.EventID.CHANGE_SCENE,this,this.onChangeScene),t.EventCenter.on(t.EventID.RESIZE,this,this.resize)},e.prototype.unRegisterEvent=function(){t.EventCenter.off(t.EventID.CHANGE_SCENE,this,this.onChangeScene),t.EventCenter.off(t.EventID.RESIZE,this,this.resize)},e.prototype.resize=function(){if(t.Log.info("SceneManager Receive Resize {0} {1}",cc.director.getWinSize().width,cc.director.getWinSize().height),this._curScene){this._curScene.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height);var e=this._curScene.resize;e&&e.apply(this._curScene)}},e.prototype.onChangeScene=function(t){var e=t.get(0);this.gotoScene(e)},e.prototype.onComplete=function(t){this._curScene=t},e.prototype.gotoScene=function(n,r){var i=this;this.exitScene();var o=e.scenes.getValue(n),s=t.ClassUtils.getClass(o),a=new s;a.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height),a.setup(r),a.loadResource(t.ResourceManager.DefaultGroup,s).then(function(t){i.onComplete(t)}).catch(function(e){t.Log.error(e)}),t.LayerManager.mainLayer.addChild(a)},e.prototype.exitScene=function(){this._curScene&&(this._curScene.removeFromParent(),this._curScene.dispose(),this._curScene=null,t.UIManager.Instance.closeAll(),t.ObjectPools.clearAll(),t.ResourceManager.Instance.cleanTexture(t.ResourceManager.DefaultGroup))},e.scenes=new t.NDictionary,e.instance=null,e}();t.SceneManager=e}(airkit||(airkit={})),function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._dicConfig=null,n._dicUIView=null,n._UIQueues=null,n._dicConfig=new t.NDictionary,n._dicUIView=new t.NDictionary,n._UIQueues=new t.NDictionary,n._UIQueues.add(t.eUIQueueType.POPUP,new i),n._UIQueues.add(t.eUIQueueType.ALERT,new i),n}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!0,configurable:!0}),n.prototype.empty=function(){return!!this._UIQueues.getValue(t.eUIQueueType.POPUP).empty()&&!(this._dicUIView.length>0)},n.prototype.show=function(e){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return new Promise(function(i,o){t.Log.info("show panel {0}",e);var s=n._dicUIView.getValue(e);if(null!=s){if(null!=s.displayObject)return s.setVisible(!0),void i(s);n._dicUIView.remove(e),s=null}var a=n._dicConfig.getValue(e);t.assert(null!=a,"UIManager::Show - not find id:"+a.mID);var u=r.slice(0),l=t.ClassUtils.getClass(a.name),c=new l;t.assert(null!=c,"UIManager::Show - cannot create ui:"+e),c.setUIID(e),c.setup(u),c.loadResource(t.ResourceManager.DefaultGroup,l).then(function(r){t.LayerManager.getLayer(a.mLayer).addChild(r),n._dicUIView.add(e,r),i(r)}).catch(function(e){t.Log.error(e)})})},n.prototype.close=function(e,n){var r=this;return void 0===n&&(n=0),new Promise(function(i,o){t.Log.info("close panel {0}",e);var s=r._dicConfig.getValue(e);t.assert(null!=s,"UIManager::Close - not find id:"+s.mID);var a=r._dicUIView.getValue(e);if(a)if(0==n){var u=r.clearPanel(e,a,s);i([e,u])}else t.DisplayUtils.hide(a,t.Handler.create(null,function(t){var n=r.clearPanel(e,a,s);i([e,n])}))})},n.prototype.clearPanel=function(e,n,r){return r.mHideDestroy?(this._dicUIView.remove(e),t.Log.info("clear panel {0}",e),n.removeFromParent(),n.dispose(),!0):(n.setVisible(!1),!1)},n.prototype.closeAll=function(e){void 0===e&&(e=null),this._dicUIView.foreach(function(r,i){return!(!e||!t.ArrayUtils.containsValue(e,r))||(n.Instance.close(r),!0)})},n.prototype.popup=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this._UIQueues.getValue(t.eUIQueueType.POPUP).show(e,n)},n.prototype.alert=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this._UIQueues.getValue(t.eUIQueueType.ALERT).show(e,n)},n.prototype.findPanel=function(t){return this._dicUIView.getValue(t)},n.prototype.isPanelOpen=function(t){return!!this._dicUIView.getValue(t)},n.prototype.tipsPopup=function(e,n,r,i,o,s,a){return void 0===i&&(i=.5),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=!0),new Promise(function(o,s){e.addChild(r),r.setScale(.1,.1);var a=n.localToGlobal(n.width/2-n.pivotX*n.width,.382*n.height-n.pivotY*n.height),u=e.globalToLocal(a.x,a.y),l=0,c=600,h=fgui.EaseType.BounceOut;i>1.5?(l=e.height+600,c=-600,h=fgui.EaseType.QuadOut,r.setPosition(u.x,l)):r.setPosition(u.x,l-200),t.TweenUtils.get(r).delay(1.5).to({scaleX:1,scaleY:1,alpha:1,x:u.x,y:u.y},i,h).delay(.5).to({x:u.x,y:l-c},i,fgui.EaseType.ExpoOut,t.Handler.create(null,function(){r.removeFromParent(),o()}))})},n.prototype.singleToast=function(e,n,r,i,o,s,a,u){var l=this;return void 0===i&&(i=.5),void 0===s&&(s=!0),void 0===a&&(a=null),void 0===u&&(u=null),new Promise(function(o,c){var h="_single_toast";null==n[h]&&(n[h]=[]);var p=fgui.EaseType.QuadOut,f=fgui.EaseType.QuadIn;e.addChild(r);var d=t.ClassUtils.classKey(r);for(var g in n[h]){var _=n[h][g];_&&(_.toY-=_.height+5,t.ClassUtils.classKey(_)==d&&(_.visible=!1))}n[h].push(r),r.visible=!0,r.setScale(.1,.1),null==a&&(a=n.width/2-n.pivotX*n.width),null==u&&(u=.382*n.height-n.pivotY*n.height);var y=n.localToGlobal(a,u),v=e.globalToLocal(y.x,y.y);r.setPosition(v.x,v.y),r.toY=r.y;var m=t.TweenUtils.get(r);m.setOnUpdate(function(t){var e=r.toY;if(e<r.y){var n=.4*(e-r.y),i=-5-Math.ceil(r.height/50);n<i&&(n=i),r.y+=n}});m.to({scaleX:1,scaleY:1,alpha:1},i,p).to({alpha:.4},.7*i,f,t.Handler.create(l,function(){n[h].splice(n[h].indexOf(r),1),n&&r&&r.parent&&(r.removeFromParent(),m.clear()),s?t.ObjectPools.recover(r):r.dispose(),o()}))})},n.prototype.toast=function(e,n,r,i,o,s,a,u){var l=this;return void 0===i&&(i=.5),void 0===s&&(s=!0),void 0===a&&(a=null),void 0===u&&(u=null),new Promise(function(c,h){null==n._toastList&&(n._toastList=[]);var p=fgui.EaseType.QuadOut,f=fgui.EaseType.QuadIn;if(e.addChild(r),o){for(var d in n._toastList)n._toastList[d]&&(n._toastList[d].toY-=n._toastList[d].height+8,n._toastList[d].visible=!1);i=i,p=fgui.EaseType.BounceOut,f=fgui.EaseType.BounceIn}else for(var d in n._toastList)n._toastList[d]&&(n._toastList[d].toY-=n._toastList[d].height+8);n._toastList.push(r),r.setScale(.1,.1),null==a&&(a=n.width/2-n.pivotX*n.width),null==u&&(u=.382*n.height-n.pivotY*n.height);var g=n.localToGlobal(a,u),_=e.globalToLocal(g.x,g.y);r.setPosition(_.x,_.y),r.toY=r.y;var y=t.TweenUtils.get(r);y.setOnUpdate(function(t){var e=r.toY;if(e<r.y){var n=.4*(e-r.y),i=-8-Math.ceil(r.height/50);n<i&&(n=i),r.y+=n}});y.to({scaleX:1,scaleY:1,alpha:1},i,p).to({alpha:.4},.7*i,f,t.Handler.create(l,function(){n._toastList.splice(n._toastList.indexOf(r),1),n&&r&&r.parent&&(r.removeFromParent(),y.clear()),s?t.ObjectPools.recover(r):r.dispose(),c()}))})},n.prototype.setup=function(){},n.prototype.destroy=function(){this.closeAll(),this.clearUIConfig()},n.prototype.update=function(t){this._dicUIView.foreach(function(e,n){return n.update(t),!0})},n.prototype.addUIConfig=function(e){this._dicConfig.containsKey(e.mID)?t.Log.error("UIManager::Push UIConfig - same id is register:"+e.mID):(this._dicConfig.add(e.mID,e),t.ClassUtils.regClass(e.name,e.cls))},n.prototype.clearUIConfig=function(){this._dicConfig.clear()},n.prototype.getUIConfig=function(t){return this._dicConfig.getValue(t)},n.prototype.getUILayerID=function(t){var e=this._dicConfig.getValue(t);return e?e.mLayer:-1},n.instance=null,n}(t.Singleton);t.UIManager=e;var n=function(){return function(t,e,n,r,i,o){void 0===e&&(e=""),void 0===r&&(r=""),void 0===i&&(i={}),void 0===o&&(o=null),this.title="",this.tips="",this.buttons=[],this.param=null,this.callback=t,this.title=e,this.content=n,this.tips=r,this.buttons=i,this.param=o}}();t.AlertInfo=n;var r=function(){return function(t,e,n,r,i,o){this.mID=t,this.name=e,this.cls=n,this.mLayer=r,this.mHideDestroy=i,this.mAlige=o}}();t.UIConfig=r;var i=function(){function n(){this._currentUI=0,this._currentUI=0,this._listPanels=new t.Queue}return n.prototype.show=function(t,e){var n=[t,e];this._listPanels.enqueue(n),this.checkAlertNext()},n.prototype.empty=function(){return!(this._currentUI>0||this._listPanels.length>0)},n.prototype.checkAlertNext=function(){var t;if(!(this._currentUI>0||this._listPanels.length<=0)){var n=this._listPanels.dequeue();this.registerEvent(),this._currentUI=n[0],(t=e.Instance).show.apply(t,[n[0]].concat(n[1]))}},n.prototype.registerEvent=function(){t.EventCenter.on(t.EventID.UI_CLOSE,this,this.onUIEvent)},n.prototype.unRegisterEvent=function(){t.EventCenter.off(t.EventID.UI_CLOSE,this,this.onUIEvent)},n.prototype.onUIEvent=function(e){switch(e.type){case t.EventID.UI_CLOSE:var n=e.get(0);this._currentUI>0&&this._currentUI==n&&(this._currentUI=0,this.unRegisterEvent(),this.checkAlertNext())}},n}()}(airkit||(airkit={})),function(t){var e=function(){function t(){}return t.setGlobalKey=function(t){this._globalKey=t},t.has=function(t){return null!=cc.sys.localStorage.getItem(this.getFullKey(t))},t.getInt=function(t){return parseInt(cc.sys.localStorage.getItem(this.getFullKey(t)))},t.setInt=function(t,e){cc.sys.localStorage.setItem(this.getFullKey(t),e.toString())},t.getFloat=function(t){return parseInt(cc.sys.localStorage.getItem(this.getFullKey(t)))},t.setFloat=function(t,e){cc.sys.localStorage.setItem(this.getFullKey(t),e.toString())},t.getString=function(t){return cc.sys.localStorage.getItem(this.getFullKey(t))},t.setString=function(t,e){cc.sys.localStorage.setItem(this.getFullKey(t),e)},t.remove=function(t){cc.sys.localStorage.removeItem(this.getFullKey(t))},t.clear=function(){cc.sys.localStorage.clear()},t.getFullKey=function(t){return this._globalKey+"_"+t},t._globalKey="",t}();t.LocalDB=e}(airkit||(airkit={})),function(t){var e=function(){function t(){this._nowTime=0}return t.prototype.init=function(t,e){this._intervalTime=t,e&&(this._nowTime=this._intervalTime)},t.prototype.reset=function(){this._nowTime=0},t.prototype.update=function(t){return this._nowTime+=t,this._nowTime>=this._intervalTime&&(this._nowTime-=this._intervalTime,!0)},t}();t.IntervalTimer=e}(airkit||(airkit={})),function(t){var e=function(){function t(){}return t.Start=function(){},Object.defineProperty(t,"deltaTimeMS",{get:function(){return cc.director.getDeltaTime()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fixedDeltaTime",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"frameCount",{get:function(){return cc.director.getTotalFrames()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"timeScale",{get:function(){return cc.director.getScheduler().getTimeScale()},set:function(t){cc.director.getScheduler().setTimeScale(t)},enumerable:!0,configurable:!0}),t}();t.Timer=e}(airkit||(airkit={})),function(t){var e=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._idCounter=0,t._removalPending=[],t._timers=[],t}return __extends(r,e),Object.defineProperty(r,"Instance",{get:function(){return this.instance||(this.instance=new r),this.instance},enumerable:!0,configurable:!0}),r.prototype.setup=function(){this._idCounter=0},r.prototype.destroy=function(){t.ArrayUtils.clear(this._removalPending),t.ArrayUtils.clear(this._timers)},r.prototype.update=function(t){this.remove();for(var e=0;e<this._timers.length;e++)this._timers[e].update(t),0==this._timers[e].isActive&&r.Instance.removeTimer(this._timers[e].id)},r.prototype.addLoop=function(e,r,i,o,s){void 0===s&&(s=null),r<=0&&(r=0);var a=t.ObjectPools.get(n);++this._idCounter,null!=s&&t.ArrayUtils.insert(s,this._idCounter,0);var u=t.Handler.create(i,o,s,!1);return a.set(this._idCounter,e,r,u),this._timers.push(a),a.id},r.prototype.addOnce=function(e,r,i,o){void 0===o&&(o=null);var s=t.ObjectPools.get(n);++this._idCounter,null!=o&&t.ArrayUtils.insert(o,this._idCounter,0);var a=t.Handler.create(r,i,o,!1);return s.set(this._idCounter,e,1,a),this._timers.push(s),s.id},r.prototype.removeTimer=function(t){this._removalPending.push(t)},r.prototype.remove=function(){var e;if(this._removalPending.length>0){for(var n=0,r=this._removalPending;n<r.length;n++)for(var i=r[n],o=0;o<this._timers.length;o++)if((e=this._timers[o]).id==i){e.clear(),t.ObjectPools.recover(e),this._timers.splice(o,1);break}t.ArrayUtils.clear(this._removalPending)}},r.TIMER_OBJECT="timerObject",r.instance=null,r}(t.Singleton);t.TimerManager=e;var n=function(){function e(){this.mTime=new t.IntervalTimer}return e.prototype.init=function(){},e.prototype.clear=function(){null!=this.handle&&(this.handle.recover(),this.handle=null)},e.prototype.set=function(t,e,n,r){this.id=t,this.mRate=e<0?0:e,this.mTicks=n<0?0:n,this.handle=r,this.mTicksElapsed=0,this.isActive=!0,this.mTime.init(this.mRate,!1)},e.prototype.update=function(e){this.isActive&&this.mTime.update(t.Timer.deltaTimeMS)&&(null!=this.handle&&this.handle.run(),this.mTicksElapsed++,this.mTicks>0&&this.mTicks==this.mTicksElapsed&&(this.isActive=!1))},e.objectKey="TimerObject",e}();t.TimerObject=n}(airkit||(airkit={})),function(t){var e;!function(t){t[t.ASCENDING=0]="ASCENDING",t[t.DESCENDING=1]="DESCENDING"}(e=t.eArraySortOrder||(t.eArraySortOrder={}));var n=function(){function t(){}return t.insert=function(t,e,n){n>t.length-1?t.push(e):t.splice(n,0,e)},t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.equip=function(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!t[n].equals(e[n]))return!1}else if(t[n]!=e[n])return!1;return!0},t.removeValue=function(t,e){if(Array.isArray(e))for(var n=t.length-1;n>=0;n--)this.equip(t[n],e)&&t.splice(n,1);else-1!=(n=t.indexOf(e))&&t.splice(n,1)},t.removeAllValue=function(t,e){for(var n=t.indexOf(e);n>=0;)t.splice(n,1),n=t.indexOf(e)},t.containsValue=function(t,e){return t.length>0&&-1!=t.indexOf(e)},t.copy=function(t){return JSON.parse(JSON.stringify(t))},t.sort=function(t,n,r){void 0===r&&(r=e.DESCENDING),null!=t&&t.sort(function(t,i){switch(r){case e.ASCENDING:return t[n]<i[n]?-1:t[n]>i[n]?1:0;case e.DESCENDING:return t[n]>i[n]?-1:t[n]<i[n]?1:0}})},t.clear=function(t){var e=0,n=t.length;for(e=0;e<n;++e)t[e]=null;t.splice(0)},t.isEmpty=function(t){return null==t||0==t.length},t}();t.ArrayUtils=n}(airkit||(airkit={})),function(t){var e=function(){function t(t){void 0===t&&(t=null),this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,t?(this._u8d_=new Uint8Array(t),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}return t.getSystemEndian=function(){if(!t._sysEndian){var e=new ArrayBuffer(2);new DataView(e).setInt16(0,256,!0),t._sysEndian=256===new Int16Array(e)[0]?t.LITTLE_ENDIAN:t.BIG_ENDIAN}return t._sysEndian},Object.defineProperty(t.prototype,"buffer",{get:function(){var t=this._d_.buffer;return t.byteLength===this._length?t:t.slice(0,this._length)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endian",{get:function(){return this._xd_?t.LITTLE_ENDIAN:t.BIG_ENDIAN},set:function(e){this._xd_=e===t.LITTLE_ENDIAN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){this._allocated_<t?this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,2*this._allocated_))):this._allocated_>t&&this._resizeBuffer(this._allocated_=t),this._length=t},enumerable:!0,configurable:!0}),t.prototype._resizeBuffer=function(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}},t.prototype.getString=function(){return this.readString()},t.prototype.readString=function(){return this._rUTF(this.getUint16())},t.prototype.getFloat32Array=function(t,e){return this.readFloat32Array(t,e)},t.prototype.readFloat32Array=function(t,e){var n=t+e;n=n>this._length?this._length:n;var r=new Float32Array(this._d_.buffer.slice(t,n));return this._pos_=n,r},t.prototype.getUint8Array=function(t,e){return this.readUint8Array(t,e)},t.prototype.readUint8Array=function(t,e){var n=t+e;n=n>this._length?this._length:n;var r=new Uint8Array(this._d_.buffer.slice(t,n));return this._pos_=n,r},t.prototype.getInt16Array=function(t,e){return this.readInt16Array(t,e)},t.prototype.readInt16Array=function(t,e){var n=t+e;n=n>this._length?this._length:n;var r=new Int16Array(this._d_.buffer.slice(t,n));return this._pos_=n,r},t.prototype.getFloat32=function(){return this.readFloat32()},t.prototype.readFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,t},t.prototype.getFloat64=function(){return this.readFloat64()},t.prototype.readFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,t},t.prototype.writeFloat32=function(t){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,t,this._xd_),this._pos_+=4},t.prototype.writeFloat64=function(t){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,t,this._xd_),this._pos_+=8},t.prototype.getInt32=function(){return this.readInt32()},t.prototype.readInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,t},t.prototype.getUint32=function(){return this.readUint32()},t.prototype.readUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,t},t.prototype.writeInt32=function(t){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,t,this._xd_),this._pos_+=4},t.prototype.writeUint32=function(t){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,t,this._xd_),this._pos_+=4},t.prototype.getInt16=function(){return this.readInt16()},t.prototype.readInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,t},t.prototype.getUint16=function(){return this.readUint16()},t.prototype.readUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,t},t.prototype.writeUint16=function(t){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,t,this._xd_),this._pos_+=2},t.prototype.writeInt16=function(t){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,t,this._xd_),this._pos_+=2},t.prototype.getUint8=function(){return this.readUint8()},t.prototype.readUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]},t.prototype.writeUint8=function(t){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,t),this._pos_++},t.prototype._getUInt8=function(t){return this._readUInt8(t)},t.prototype._readUInt8=function(t){return this._d_.getUint8(t)},t.prototype._getUint16=function(t){return this._readUint16(t)},t.prototype._readUint16=function(t){return this._d_.getUint16(t,this._xd_)},t.prototype._rUTF=function(t){var e,n,r=this._pos_+t,i=String.fromCharCode,o=this._u8d_,s=[],a=0;for(s.length=1e3;this._pos_<r;){if((e=o[this._pos_++])<128)0!=e&&(s[a++]=i(e));else if(e<224)s[a++]=i((63&e)<<6|127&o[this._pos_++]);else if(e<240)n=o[this._pos_++],s[a++]=i((31&e)<<12|(127&n)<<6|127&o[this._pos_++]);else{var u=(15&e)<<18|(127&(n=o[this._pos_++]))<<12|(127&o[this._pos_++])<<6|127&o[this._pos_++];if(u>=65536){var l=u-65536,c=55296|l>>10,h=56320|1023&l;s[a++]=i(c),s[a++]=i(h)}else s[a++]=i(u)}0}return s.length=a,s.join("")},t.prototype.getCustomString=function(t){return this.readCustomString(t)},t.prototype.readCustomString=function(t){for(var e,n="",r=0,i=String.fromCharCode,o=this._u8d_;t>0;)if((e=o[this._pos_])<128)n+=i(e),this._pos_++,t--;else for(r=e-128,this._pos_++,t-=r;r>0;)e=o[this._pos_++],n+=i(o[this._pos_++]<<8|e),r--;return n},Object.defineProperty(t.prototype,"pos",{get:function(){return this._pos_},set:function(t){this._pos_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bytesAvailable",{get:function(){return this._length-this._pos_},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._pos_=0,this.length=0},t.prototype.__getBuffer=function(){return this._d_.buffer},t.prototype.writeUTFBytes=function(t){for(var e=0,n=(t+="").length;e<n;e++){var r=t.charCodeAt(e);if(r<=127)this.writeByte(r);else if(r<=2047)this._ensureWrite(this._pos_+2),this._u8d_.set([192|r>>6,128|63&r],this._pos_),this._pos_+=2;else if(r>=55296&&r<=56319){e++;var i=t.charCodeAt(e);if(!Number.isNaN(i)&&i>=56320&&i<=57343){var o=64+(1023&r),s=1023&i,a=240|o>>8&63,u=128|o>>2&63,l=128|(3&o)<<4|s>>6&15,c=128|63&s;this._ensureWrite(this._pos_+4),this._u8d_.set([a,u,l,c],this._pos_),this._pos_+=4}}else r<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|r>>12,128|r>>6&63,128|63&r],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r],this._pos_),this._pos_+=4)}},t.prototype.writeUTFString=function(t){var e=this.pos;this.writeUint16(1),this.writeUTFBytes(t);var n=this.pos-e-2;this._d_.setUint16(e,n,this._xd_)},t.prototype.readUTFString=function(){return this.readUTFBytes(this.getUint16())},t.prototype.getUTFString=function(){return this.readUTFString()},t.prototype.readUTFBytes=function(t){if(void 0===t&&(t=-1),0===t)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";return t=t>0?t:e,this._rUTF(t)},t.prototype.getUTFBytes=function(t){return void 0===t&&(t=-1),this.readUTFBytes(t)},t.prototype.writeByte=function(t){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,t),this._pos_+=1},t.prototype.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},t.prototype.getByte=function(){return this.readByte()},t.prototype._ensureWrite=function(t){this._length<t&&(this._length=t),this._allocated_<t&&(this.length=t)},t.prototype.writeArrayBuffer=function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),e<0||n<0)throw"writeArrayBuffer error - Out of bounds";0==n&&(n=t.byteLength-e),this._ensureWrite(this._pos_+n);var r=new Uint8Array(t);this._u8d_.set(r.subarray(e,e+n),this._pos_),this._pos_+=n},t.prototype.readArrayBuffer=function(t){var e;return e=this._u8d_.buffer.slice(this._pos_,this._pos_+t),this._pos_=this._pos_+t,e},t.BIG_ENDIAN="bigEndian",t.LITTLE_ENDIAN="littleEndian",t._sysEndian=null,t}();t.Byte=e}(airkit||(airkit={})),function(t){function e(e,n){var r=new t.Byte(e);return r.endian=n,r.getUint8Array(r.pos,r.length-r.pos)}function n(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}t.bytes2Uint8Array=e,t.bytes2String=function(t,r){return n(e(t,r))},t.string2ArrayBuffer=function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return e},t.string2Uint8Array=function(t){for(var e=[],n=0,r=t.length;n<r;++n)e.push(t.charCodeAt(n));return new Uint8Array(e)},t.uint8Array2String=n}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.regClass=function(t,n){e._classMap[t]=n},e.regShortClassName=function(t){for(var n=0;n<t.length;n++){var r=t[n],i=r.name;e._classMap[i]=r}},e.getRegClass=function(t){return e._classMap[t]},e.getClass=function(t){return e._classMap[t]||e._classMap["cc."+t]||t},e.getInstance=function(t){var n=e.getClass(t);return n?new n:(console.warn("[error] Undefined class:",t),null)},e.copyObject=function(t){var e=JSON.stringify(t);return JSON.parse(e)},e.getObjectValue=function(t,e,n){return t[e]?t[e]:n},e.callFunc=function(e,n,r){if(void 0===r&&(r=null),null!=n){var i=e[n],o=null;return i?o=null==r?i.apply(e):i.apply(e,r):t.Log.error("cant find funcName {0} from Module:{1}",n,e.name),o}},e.classKey=function(t){return Object.getPrototypeOf(t).constructor.objectKey},e._classMap={},e}();t.ClassUtils=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.setServerTime=function(t){this.serverTime=t,this.serverTimeDiff=Date.now()-t},e.getNow=function(){return Math.floor((Date.now()-this.serverTimeDiff)/1e3)},e.getNowMS=function(){return Date.now()-this.serverTimeDiff},e.isTheSameMonth=function(t,n){var r=e.getNow(),i=new Date(1e3*(r-n)),o=new Date(i.getFullYear(),i.getMonth(),1);return t>=Math.floor(o.getTime()/1e3)+n},e.isTheSameDayByNow=function(t,n){var r=60*(new Date).getTimezoneOffset(),i=(t-r-n)/86400,o=(e.getNow()-r-n)/86400;return Math.floor(i)===Math.floor(o)},e.passedDays=function(t,e,n){void 0===n&&(n=0);var r=60*(new Date).getTimezoneOffset(),i=(t-r-n)/86400,o=(e-r-n)/86400;return Math.floor(o)-Math.floor(i)},e.currentYMDHMS=function(){return this.formatDateTime(this.getNowMS())},e.currentHour=function(){return new Date(this.getNowMS()).getHours()},e.formatDateTime=function(t){var e=new Date(t),n=e.getFullYear(),r=e.getMonth()+1,i=r<10?"0"+r:r,o=e.getDate(),s=o<10?"0"+o:o,a=e.getHours(),u=a<10?"0"+a:a,l=e.getMinutes(),c=e.getSeconds();return n+"-"+i+"-"+s+" "+u+":"+(l<10?"0"+l:l)+":"+(c<10?"0"+c:c)},e.countdown=function(t,e){void 0===e&&(e="D天H时M分S秒");var n=Math.max(0,t/1e3),r=Math.floor(n/24/3600),i=Math.floor(n/3600%24),o=Math.floor(n/60%60);n=Math.floor(n%60);var s=e.replace(/D/,r.toString());return s=(s=(s=s.replace(/H/,i.toString())).replace(/M/,o.toString())).replace(/S/,n.toString())},e.formatTime=function(e,n){void 0===n&&(n="{0}:{1}:{2}");var r=Math.max(0,e),i=Math.floor(r/3600%24),o=Math.floor(r/60%60);return r=Math.floor(r%60),t.StringUtils.format(n,i<10?"0"+i:i,o<10?"0"+o:o,r<10?"0"+r:r)},e.format2Time=function(e){var n="{0}:{1}",r=Math.max(0,e),i=Math.floor(r/24/3600);if(i>0)return t.StringUtils.format("{0}天",i);var o=Math.floor(r/3600%24),s=Math.floor(r/60%60),a=s<10?"0"+s:s,u=o<10?"0"+o:o,l=(r=Math.floor(r%60))<10?"0"+r:r;return o>0?t.StringUtils.format(n,u,a):(n=n.replace(":","’"),t.StringUtils.format(n,a,l))},e.format2Time2=function(e){var n="{0}:{1}",r=Math.max(0,e),i=Math.floor(r/24/3600);if(i>0)return t.StringUtils.format("{0}天",i);var o=Math.floor(r/3600%24),s=Math.floor(r/60%60),a=s<10?"0"+s:s,u=o<10?"0"+o:o,l=(r=Math.floor(r%60))<10?"0"+r:r;return o>0?t.StringUtils.format(n,u,a):(n=n.replace(":","’"),t.StringUtils.format(n,a,l))},e.serverTimeDiff=0,e.serverTime=0,e}();t.DateUtils=e}(airkit||(airkit={})),function(t){var e=function(){function t(){}return t.getKeys=function(t){var e=[];for(var n in t)e.push(n);return e},t.getValues=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.clearDic=function(e){var n;for(var r in e)(n=e[r])instanceof Object&&t.clearDic(n),delete e[r]},t.foreach=function(t,e){for(var n in t)if(!e.call(null,n,t[n]))break},t.isEmpty=function(t){if(null==t)return!0;for(var e in t)return!1;return!0},t.getLength=function(t){if(null==t)return 0;var e=0;for(var n in t)++e;return e},t.assign=function(t,e){Object.assign(t,e)},t}();t.DicUtils=e}(airkit||(airkit={})),function(t){function e(){return cc.director.getWinSize().width}function n(){return cc.director.getWinSize().height}t.displayWidth=e,t.displayHeight=n;var r=function(){function r(){}return r.removeAllChild=function(t){if(t&&!(t.numChildren<=0))for(;t.numChildren>0;){var e=t.removeChildAt(0);if(e){var n=e.constructor;if("Animation"==n.name){var r=e;r.clear(),r.destroy(!0),r=null}else e.removeFromParent(),e.dispose();n=null}e=null}},r.colorBG=function(t,e,n){var r=new fgui.GGraph;return r.drawRect(1,t,t),r.setSize(e,n),r.alpha=.7,r},r.popupDown=function(r,i,o){r.scale(.8,.8);var s=e()>>1,a=n()>>1;null!=o&&o?(s=r.x,a=r.y):(r.anchorX=.5,r.anchorY=.5),r.pos(s,0);t.TweenUtils.get(r).to({scaleX:1,scaleY:1,x:s,y:a},500,fgui.EaseType.BackOut,i),r.parent&&r.parent.bg&&(r.parent.bg.alpha=0,t.TweenUtils.get(r.parent.bg).to({alpha:1},500,fgui.EaseType.QuadOut))},r.popup=function(r,i,o){r.setScale(.85,.85);var s=e()>>1,a=n()>>1;null!=o&&o?(s=r.x,a=r.y):r.setPivot(.5,.5,!0),r.setPosition(s,a);if(t.TweenUtils.get(r).to({scaleX:1,scaleY:1},.25,fgui.EaseType.QuadOut,i),r.parent&&r.parent.getChild("bg")){var u=r.parent.getChild("bg");u.alpha=0,t.TweenUtils.get(u).to({alpha:1},.25,fgui.EaseType.QuadOut)}},r.hide=function(e,n){var r=e.panel(),i=e.bg();null==r?n&&n.run():(t.TweenUtils.get(r).to({scaleX:.5,scaleY:.5},.2,fgui.EaseType.BackIn,n),i&&t.TweenUtils.get(i).to({alpha:0},.2,fgui.EaseType.QuadOut))},r}();t.DisplayUtils=r}(airkit||(airkit={})),function(t){var e=function(){function t(t,e,n,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=!1),this.once=!1,this._id=0,this.setTo(t,e,n,r)}return t.prototype.setTo=function(e,n,r,i){return void 0===i&&(i=!1),this._id=t._gid++,this.caller=e,this.method=n,this.args=r,this.once=i,this},t.prototype.run=function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e},t.prototype.runWith=function(t){if(null==this.method)return null;var e=this._id;if(null==t)var n=this.method.apply(this.caller,this.args);else n=this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===e&&this.once&&this.recover(),n},t.prototype.clear=function(){return this.caller=null,this.method=null,this.args=null,this},t.prototype.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(e,n,r,i){return void 0===r&&(r=null),void 0===i&&(i=!0),t._pool.length?t._pool.pop().setTo(e,n,r,i):new t(e,n,r,i)},t._pool=[],t._gid=1,t}();t.Handler=e}(airkit||(airkit={})),function(t){var e;!function(t){t[t.Line=3]="Line",t[t.Curve=2]="Curve"}(e=t.OrbitType||(t.OrbitType={}));var n=function(){function n(){}return n.sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1},n.clamp=function(t,e,n){if(e>n){var r=e;e=n,n=r}return t<e?e:t>n?n:t},n.clamp01=function(t){return t<0?0:t>1?1:t},n.lerp=function(t,e,r){return t+(e-t)*n.clamp01(r)},n.lerpAngle=function(t,e,r){var i=n.repeat(e-t,360);return i>180&&(i-=360),t+i*n.clamp01(r)},n.repeat=function(t,e){return t-Math.floor(t/e)*e},n.randRange=function(t,e){return Math.random()*(e-t)+t},n.randRange_Int=function(t,e){var n=Math.random()*(e-t+1)+t;return Math.floor(n)},n.randRange_Array=function(t){return 0==t.length?null:t[n.randRange_Int(0,t.length-1)]},n.clampDegrees=function(t){for(;t<0;)t+=360;for(;t>=360;)t-=360;return t},n.clampRadians=function(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t},n.getDistance=function(t,e,n,r){return Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2))},n.getSquareDistance=function(t,e,n,r){return Math.pow(r-e,2)+Math.pow(n-t,2)},n.getLineRadians=function(t,e,n,r){return Math.atan2(r-e,n-t)},n.getLineDegree=function(t,e,r,i){var o=n.toDegree(n.getLineRadians(t,e,r,i));return n.clampDegrees(o)},n.getPointRadians=function(t,e){return Math.atan2(e,t)},n.getPointDegree=function(t,e){var r=n.toDegree(n.getPointRadians(t,e));return n.clampDegrees(r)},n.toDegree=function(t){return t*(180/Math.PI)},n.toRadian=function(t){return t*(Math.PI/180)},n.moveTowards=function(t,e,r){return Math.abs(e-t)<=r?e:t+n.sign(e-t)*r},n.radians4point=function(t,e,n,r){return Math.atan2(e-r,n-t)},n.pointAtCircle=function(t,e,n,r){return new cc.Vec2(t+Math.cos(n)*r,e-Math.sin(n)*r)},n.getPos=function(t,n,r){if(0==t.length)return null;if(1==t.length)return t[0];n=Math.min(n,1);var i=new cc.Vec2,o=t.length;if(r==e.Line){var s=1/(o-1),a=Math.floor(n/s);if(a+1<o){var u=t[a],l=t[a+1],c=(n-a*s)/s;i.x=u.x+(l.x-u.x)*c,i.y=u.y+(l.y-u.y)*c}else i.x=t[t.length-1].x,i.y=t[t.length-1].y}else r==e.Curve&&(i=this.getBezierat(t,n));return i},n.getRotation=function(t,e,n,r){var i=n-t,o=r-e,s=180*Math.atan(o/i)/Math.PI;return s+=i>=0?90:270},n.getBezierat=function(t,e){var n=new cc.Vec2;return 3==t.length?(n.x=Math.pow(1-e,2)*t[0].x+2*e*(1-e)*t[1].x+Math.pow(e,2)*t[2].x,n.y=Math.pow(1-e,2)*t[0].y+2*e*(1-e)*t[1].y+Math.pow(e,2)*t[2].y):4==t.length&&(n.x=Math.pow(1-e,3)*t[0].x+3*e*Math.pow(1-e,2)*t[1].x+3*Math.pow(e,2)*(1-e)*t[2].x+Math.pow(e,3)*t[3].x,n.y=Math.pow(1-e,3)*t[0].y+3*e*Math.pow(1-e,2)*t[1].y+3*Math.pow(e,2)*(1-e)*t[2].y+Math.pow(e,3)*t[3].y),n},n.getDirection=function(t){var e=new cc.Vec2;if(0==t||180==t)e.x=0,e.y=0==t?-1:1;else if(90==t||270==t)e.y=0,e.x=90==t?1:-1;else{var n=Math.floor(t/90),r=(90-t)*Math.PI/180;e.x=0==n||1==n?1:-1,e.y=1==n||2==n?Math.abs(Math.tan(r)):-Math.abs(Math.tan(r)),e=this.normalize(e)}return e},n.normalize=function(t){var e=t.y/t.x,n=Math.sqrt(1/(e*e+1)),r=Math.abs(e*n);return t.x=t.x>0?n:-n,t.y=t.y>0?r:-r,t},n.distance=function(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))},n.getVerticalVector=function(t,e,n){var r=new cc.Vec2;r.x=e.x-t.x,r.y=e.y-t.y,r.normalize();var i=new cc.Vec2;i.x=1,i.y=-r.x/r.y;var o=new cc.Vec2;return o.x=(t.x+e.x)/2+i.x*n,o.y=(t.y+e.y)/2+i.y*n,o},n.getCtrlPoint=function(t,e,n,r,i){void 0===n&&(n=100),void 0===r&&(r=50),void 0===i&&(i=50);var o=this.getVerticalVector(t,e,n);return o.x+=r,o.y+=i,o},n.getDefaultPoints=function(e,n,r,i,o){return void 0===r&&(r=150),void 0===i&&(i=150),void 0===o&&(o=150),e.x>t.displayWidth()/2&&(r=-r),e.y>n.y&&(i=-i),[e,this.getCtrlPoint(e,n,o,r,i),n]},n.BYTE_TO_M=1/1048576,n.BYTE_TO_K=1/1024,n.Deg2Rad=.01745329,n.Rad2Deg=57.29578,n.Cycle8Points=[[-200,0],[-127,-74],[0,-100],[127,-74],[200,0],[127,74],[0,100],[-127,74]],n.Cycle9Points=[[0,0],[-200,0],[-127,-74],[0,-100],[127,-74],[200,0],[127,74],[0,100],[-127,74]],n}();t.MathUtils=n}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.toFixed=function(e,n){return t.StringUtils.toNumber(e.toFixed(n))},e.toInt=function(t){return Math.floor(t)},e.isInt=function(t){return Math.ceil(t)==t},e.reserveNumber=function(e,n){var r=String(e),i=r.length,o=r.indexOf(".");if(o<0)return e;var s=r.slice(0,o+1),a=i-o;a>n&&(a=n);var u=r.slice(o+1,o+1+a);return t.StringUtils.toNumber(s+u)},e.reserveNumberWithZero=function(t,e){var n=String(t),r=n.length,i=n.indexOf(".");if(i<0){n+=".";for(var o=0;o<e;++o)n+="0";return n}var s=n.slice(0,i+1),a=r-i-1;if(a>e)return a=e,s+n.slice(i+1,i+1+a);if(a<e){var u=e-a;for(o=0;o<u;++o)n+="0";return n}return n},e}();t.NumberUtils=e}(airkit||(airkit={})),function(t){var e=function(){function t(){}return Object.defineProperty(t,"empty",{get:function(){return""},enumerable:!0,configurable:!0}),t.isNullOrEmpty=function(t){return!(null!=t&&t.length>0)},t.toInt=function(t){return t&&0!=t.length?parseInt(t):0},t.toNumber=function(t){return t&&0!=t.length?parseFloat(t):0},t.stringCut=function(t,e,n){void 0===n&&(n="...");var r=t;return t.length>e&&(r=t.substr(0,e)+n),r},t.getNumBytes=function(t){for(var e=0,n=t.length,r=-1,i=0;i<n;i++)e+=(r=t.charCodeAt(i))>=0&&r<=128?1:2;return e},t.addZero=function(t,e,n){void 0===n&&(n=0);var r="",i=t.length,o="",s="";if(0==n?s="0":o="0",i<e){for(var a=0;a<e-i;)r=o+r+s,++a;return r+t}return t},t.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},t.trim=function(t){return null==t?"":t.replace(/^\s+|\s+$""^\s+|\s+$/g,"")},t.trimLeft=function(t){return null==t?"":t.replace(/^\s+""^\s+/,"")},t.trimRight=function(t){return null==t?"":t.replace(/\s+$""\s+$/,"")},t.minuteFormat=function(t){var e=Math.floor(t/60),n=Math.floor(t%60);return(e<10?"0"+e.toString():e.toString())+":"+(n<10?"0"+n.toString():n.toString())},t.hourFormat=function(e){var n=Math.floor(e/3600);return(n<10?"0"+n.toString():n.toString())+":"+t.minuteFormat(e%3600)},t.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)t=t.replace(new RegExp("\\{"+r+"\\}","gm"),e[r]);return t},t.formatWithDic=function(t,e){for(var n in e)t=t.replace(new RegExp("\\{"+n+"\\}","gm"),e[n]);return t},t.beginsWith=function(t,e){return e==t.substring(0,e.length)},t.endsWith=function(t,e){return e==t.substring(t.length-e.length)},t.getGUIDString=function(){var t=Date.now();return window.performance&&"function"==typeof window.performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})},t}();t.StringUtils=e}(airkit||(airkit={})),function(t){var e=function(){return function(){}}();t.TouchUtils=e}(airkit||(airkit={})),function(t){var e=function(){function e(t){this._target=t,this.clear()}return e.get=function(t){return new e(t)},Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),e.prototype.setOnUpdate=function(t){this._updateFunc=t},e.prototype.onUpdate=function(t){this._updateFunc&&this._updateFunc(t)},e.prototype.to=function(t,e,n,r,i){return void 0===n&&(n=fgui.EaseType.QuadOut),void 0===r&&(r=null),void 0===i&&(i=0),this._steps.push({props:t,duration:e,ease:n,complete:r,delay:i}),this.trigger(),this},e.prototype.delay=function(t){return this._steps.push({delay:t}),this},e.prototype.trigger=function(){var e=this;if(!this._isPlaying&&this._steps&&this._steps.length){var n=this._steps.shift();if(n.hasOwnProperty("props")){if(this._isPlaying=!0,null!=n.props.x||null!=n.props.y){var r=null!=n.props.x?n.props.x:this._target.x,i=null!=n.props.y?n.props.y:this._target.y;fgui.GTween.to2(this._target.x,this._target.y,r,i,n.duration).setTarget(this._target,this._target.setPosition).setEase(n.ease)}if(null!=n.props.scaleX||null!=n.props.scaleY){r=null!=n.props.scaleX?n.props.scaleX:this._target.scaleX,i=null!=n.props.scaleY?n.props.scaleY:this._target.scaleY;fgui.GTween.to2(this._target.scaleX,this._target.scaleY,r,i,n.duration).setTarget(this._target,this._target.setScale).setEase(n.ease)}if(null!=n.props.rotation){var o=null!=n.props.rotation?n.props.rotation:this._target.rotation;fgui.GTween.to(this._target.rotation,o,n.duration).setTarget(this._target,"rotation").setEase(n.ease)}null!=n.props.alpha&&(n.props.pts?fgui.GTween.to(this._target.alpha,n.props.alpha,n.duration).setTarget(this._target,"alpha").setEase(n.ease).onUpdate(function(r){var i=t.MathUtils.getPos(n.props.pts,r.normalizedTime,t.OrbitType.Curve);e._target.setPosition(i.x,i.y),e.onUpdate(r)},null):fgui.GTween.to(this._target.alpha,n.props.alpha,n.duration).setTarget(this._target,"alpha").setEase(n.ease).onUpdate(function(t){e.onUpdate(t)},null)),t.TimerManager.Instance.addOnce(1e3*(n.duration+n.delay),this,this.onStepComplete,[n.complete])}else n.hasOwnProperty("delay")&&(this._isPlaying=!0,t.TimerManager.Instance.addOnce(1e3*n.delay,this,this.onStepComplete,[n.complete]))}},e.prototype.onStepComplete=function(t){t&&t.runWith(),this._isPlaying=!1,this.trigger()},e.prototype.clear=function(){this._steps=[],this._isPlaying=!1,fgui.GTween.kill(this._target)},e.scale=function(t){this.get(t).to({scaleX:.8,scaleY:.8},.05,fgui.EaseType.QuadIn).to({scaleX:1,scaleY:1},.05,fgui.EaseType.QuadIn)},e.appear=function(t){t.setScale(0,0),this.get(t).to({scaleX:1.2,scaleY:1.2},.4,fgui.EaseType.QuadOut).to({scaleX:1,scaleY:1},.2,fgui.EaseType.QuadOut)},e.EaseBezier=9999,e}();t.TweenUtils=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.getFileExte=function(e){if(t.StringUtils.isNullOrEmpty(e))return t.StringUtils.empty;var n=e.lastIndexOf(".");return n>=0?e.substr(n+1):t.StringUtils.empty},e.getPathWithNoExtend=function(e){if(t.StringUtils.isNullOrEmpty(e))return t.StringUtils.empty;var n=e.lastIndexOf(".");return n>=0?e.substr(0,n):t.StringUtils.empty},e}();t.UrlUtils=e}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.openURL=function(t){window.location.href=t},e.getLocationParams=function(){var e=window.location.href,n=new t.SDictionary,r=e.indexOf("?");if(r>=0){var i=void 0,o=void 0,s=(e=e.substr(r+1)).split("&");for(var a in s){var u=s[a];r=u.indexOf("="),i=u.substr(0,r),o=u.substr(r+1),n.add(i,o)}}return n},e.obj2query=function(t){if(!t)return"";var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")},e.injectProp=function(t,e,n,r,i,o){if(void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=""),!e)return!1;for(var s in e){var a=e[s];r&&"function"==typeof a||i&&null==a||(n?n(t,s,a):t[s]=a)}return!0},e.parseXMLFromString=function(t){var e;if(t=t.replace(/>\s+</g,"><"),(e=(new DOMParser).parseFromString(t,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors")>-1)throw new Error(e.firstChild.firstChild.textContent);return e},e}();t.Utils=e;var n=function(){function e(){}return e.hasFlag=function(e,n){return 0!=((e=t.NumberUtils.toInt(e))&(n=t.NumberUtils.toInt(n)))},e.insertFlag=function(e,n){return e=t.NumberUtils.toInt(e),e|=n=t.NumberUtils.toInt(n)},e.removeFlag=function(e,n){return e=t.NumberUtils.toInt(e),e^=n=t.NumberUtils.toInt(n)},e}();function r(t,e){if(!t)throw e||"assert"}function i(t){return null==t||(null===t||void 0===t)}t.FlagUtils=n,t.assert=r,t.assertNullOrNil=function(t,e){null!=t&&null!=t||r(!1,e)},t.checkNullOrNil=i,t.checkEmptyDic=function(t){return!!i(t)||"{}"==JSON.stringify(t)}}(airkit||(airkit={})),function(t){var e=function(){function e(){}return e.unzip=function(n){return new Promise(function(r,i){var o={};e.parseZip(n).then(function(n){var s=n.jszip,a=n.filelist;if(s&&a)for(var u=0,l=function(l){e.parseZipFile(s,a[l]).then(function(t){u++,o[a[l]]=t,u==a.length&&(n=null,s=null,a=null,r(o))}).catch(function(e){t.Log.error(e),i(e)})},c=0;c<a.length;c++)l(c)}).catch(function(e){t.Log.error(e),i(e)})})},e.parseZip=function(e){return new Promise(function(n,r){new t.SDictionary;var i=new Array;window.JSZip.loadAsync(e).then(function(t){for(var e in t.files)i.push(e);n({jszip:t,filelist:i})}).catch(function(e){t.Log.error(e)})})},e.parseZipFile=function(e,n){return new Promise(function(r,i){e.file(n).async("text").then(function(t){r(t)}).catch(function(e){i(e),t.Log.error(e)})})},e}();t.ZipUtils=e}(airkit||(airkit={}));